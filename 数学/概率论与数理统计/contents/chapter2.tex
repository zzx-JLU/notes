% !TeX root = main.tex

\chapter{随机变量及其分布}

\section{随机变量及其分布函数}

\subsection{随机变量}

\begin{definition}
    \indent 设随机试验 $E$ 的样本空间为 $\varOmega=\{\omega\}$. 如果对于每一个 $\omega\in\varOmega$，都有一个实数 $X(\omega)$ 与之对应，则称 $X=X(\omega)$ 为{\heiti 随机变量}（random variable）.
\end{definition}

随机变量常用大写字母 $X,Y,Z$ 等表示.

\subsection{分布函数}

\begin{definition}
    \indent 设 $X$ 是一个随机变量，对于任意实数 $x$，令
    $$
    F(x)=P(X \leqslant x), \ x \in \mathbf{R}
    $$
    称 $F(x)$ 为随机变量 $X$ 的{\heiti 分布函数}（cumulative distribution function）.称随机变量 $X$ 服从 $F(x)$，记为 $X \sim F(x)$.
\end{definition}

随机变量 $X$ 的分布函数 $F(x)$ 是定义在 $(-\infty, +\infty)$ 上的函数，是随机事件 $\{X \leqslant x\}$ 发生的概率.分布函数值 $F(a)$ 表示 $X$ 落在区间 $(-\infty,a]$ 上的概率.

\begin{property}[][单调性]
    \indent $F(x)$ 是一个单调不减函数，即对任意的 $x_1 < x_2$，有 $F(x_1) \leqslant F(x_2)$.
\end{property}

\begin{proof}
    对于任意实数 $x_1, x_2\, (x_1 < x_2)$，有
    $$
    F(x_2) - F(x_1) = P(x_1 < X \leqslant x_2) \geqslant 0
    $$
    因此 $F(x)$ 是单调不减函数.
\end{proof}

\begin{property}[][有界性]
    \indent 对于任意实数 $x$，有 $0 \leqslant F(x) \leqslant 1$，且
    \begin{gather*}
        F(-\infty)= \lim_{x \to -\infty} F(x) = 0 \\
        F(+\infty)= \lim_{x \to +\infty} F(x) = 1
    \end{gather*}
\end{property}

\begin{proof}
    因为 $F(x) = P(X \leqslant x)$，根据概率的性质可得 $0 \leqslant F(x) \leqslant 1$.

    $F(x)$ 在 $(-\infty, +\infty)$ 内单调不减且有界，由单调有界原理可知，$\displaystyle\lim_{x \to -\infty} F(x)$ 和 $\displaystyle\lim_{x \to +\infty} F(x)$ 存在.

    记 $A_n = \{ X \leqslant n \}$，则有 $A_n \subseteq A_{n+1}$，$\displaystyle\bigcup_{i=1}^{\infty} A_i = \varOmega$.由海涅定理可得
    $$
    \lim_{x \to +\infty} F(x) = \lim_{n \to \infty} F(n) = \lim_{n \to \infty} P(A_n) = P(\lim_{n \to \infty} A_n) = P \left( \bigcup_{i=1}^{\infty} A_i \right) = 1
    $$

    记 $B_n = \{ X \leqslant -n \}$，则有 $B_n \supseteq B_{n+1}$，$\displaystyle\bigcap_{i=1}^{\infty} B_i = \text{\O}$.由海涅定理可得
    $$
    \lim_{x \to -\infty} F(x) = \lim_{n \to \infty} F(-n) = \lim_{n \to \infty} P(B_n) = P(\lim_{n \to \infty} B_n) = P \left( \bigcap_{i=1}^{\infty} B_i \right) = 0
    $$

    \vspace{-2em}
\end{proof}

\begin{property}[][右连续性]
    \indent $F(x)$ 处处右连续，即对任意实数 $x_0$，有 $F(x_0^+) = F(x_0)$.
\end{property}

\begin{proof}
    因为 $F(x)$ 是单调不减有界函数，所以对任意实数 $x_0$，右极限 $F(x_0^+)$ 一定存在.记 $A_n = \{ X \leqslant x_0 + \dfrac{1}{n} \}$，则有 $A_n \supseteq A_{n+1}$，$\displaystyle\bigcap_{i=1}^{\infty} A_i = \{ X \leqslant x_0 \}$，由海涅定理得
    $$
    \begin{aligned}
        \lim_{x \to x_0^+} F(x) &= \lim_{n \to \infty} F(x_0 + \dfrac{1}{n}) \\
        &= \lim_{n \to \infty} P(A_n) \\
        &= P(\lim_{n \to \infty} A_n) \\
        &= P \left( \bigcap_{i=1}^{\infty} A_i \right) \\
        &= P(X \leqslant x_0) \\
        &= F(x_0)
    \end{aligned}
    $$

    \vspace{-1em}
\end{proof}

单调性、有界性、右连续性是分布函数的基本性质.分布函数一定具有这些基本性质，反过来，满足这些基本性质的函数一定是某个随机变量的分布函数.因此，这三条基本性质是判定某个函数能否成为分布函数的充分必要条件.

\begin{property}
    \indent 对于任意实数 $x_1,x_2\, (x_1<x_2)$，有 $P(x_1 < X \leqslant x_2)=F(x_2)-F(x_1)$.
\end{property}

\begin{proof}
    对于任意实数 $x_1,x_2\, (x_1<x_2)$，由于
    $$
    \{x_1 < X \leqslant x_2\} = \{X \leqslant x_2\} - \{X \leqslant x_1\}
    $$
    所以有
    $$
    \begin{aligned}
        P(x_1 < X \leqslant x_2) &= P(X \leqslant x_2) - P(X \leqslant x_1) \\
        &= F(x_2)-F(x_1)
    \end{aligned}
    $$
\end{proof}

\section{离散型随机变量及其概率分布}

\begin{definition}
    \indent 如果一个随机变量 $X$ 所有可能取到的不相同的值是有限个或可列无限多个，并且以确定的概率取这些不同的值，则称 $X$ 为{\heiti 离散型随机变量}（discrete random variable）.
\end{definition}

\begin{definition}
    \indent 设离散型随机变量 $X$ 所有可能取的值为 $x_k\, (k=1,2,\cdots)$，$X$ 取各个可能值的概率，即事件 $\{X=x_k\}$ 的概率为
    \begin{equation} \label{equation:distribution}
        P(X=x_k) = p_k, \ k=1,2,\cdots
    \end{equation}
    并且 $p_k$ 满足以下两个条件：
    \begin{enumerate}
        \item 非负性：$p_k \geqslant 0$；\vspace{0.5em}
        \item 归一性：$\displaystyle\sum_{k=1}^\infty p_k = 1$，
    \end{enumerate} \vspace{0.5em}
    则称式 \eqref{equation:distribution} 为离散型随机变量 $X$ 的{\heiti 概率分布}（probability distribution）或{\heiti 分布律}.
\end{definition}

概率分布也可以用如下的表格来表示：
\begin{table*}[htbp]
    \centering

    \begin{tabular}{c | c c c c c}
        \hline
        $X$ & $x_1$ & $x_2$ & $\cdots$ & $x_k$ & $\cdots$ \\
        \hline
        $P$ & $p_1$ & $p_2$ & $\cdots$ & $p_k$ & $\cdots$ \\
        \hline
    \end{tabular}
\end{table*}

概率分布反映了离散型随机变量的统计规律性.

对于任意实数 $x$，随机事件 $\{X \leqslant x\}$ 可以表示成 $\displaystyle\bigcup_{x_k \leqslant x} \{X=x_k\}$. 由于 $x_k\, (k=1,2,\cdots)$ 互不相同，根据概率的可加性，可得离散型随机变量 $X$ 的分布函数为
$$
F(x) = P(X \leqslant x) = \sum_{x_k \leqslant x} P(X=x_k) = \sum_{x_k \leqslant x} p_k
$$
它的图像是有限级（或可列无限级）的阶梯形曲线.

如果随机变量 $X$ 只能取一个常数 $c$，即 $P(X=c) = 1$，这个分布称为\textbf{单点分布}或\textbf{退化分布}，它的分布函数是
$$
F(x) = \begin{cases}
    0, & x < c \\
    1, & x \geqslant c
\end{cases}
$$

\section{连续型随机变量及其概率密度}

\begin{definition}[][][def:f(x)]
    \indent 对于随机变量 $X$ 的分布函数 $F(x)$，如果存在非负函数 $f(x)$，使得对任意的 $x$，都有 $F(x)=\displaystyle\int_{-\infty}^x f(t)\,\text{d}t$，则称随机变量 $X$ 是{\heiti 连续型随机变量}（continuous random variable），其中函数 $f(x)$ 叫做 $X$ 的{\heiti 概率密度函数}（probability density function），简称为{\heiti 概率密度}（probability density），记作 $X \sim f(x)$.
\end{definition}

由定义 \ref{def:f(x)} 可知，连续型随机变量的分布函数处处连续.

\begin{property}[][非负性][prop:f(x)>=0]
    \indent $f(x) \geqslant 0$
\end{property}

\begin{property}[][规范性][prop:f(x):integral=1]
    \indent $\displaystyle\int_{-\infty}^{+\infty} f(x)\,\text{d}x = 1$
\end{property}

非负性和规范性是概率密度函数的基本性质.概率密度函数一定具有这两个性质，满足这两个性质的函数也一定是某随机变量的概率密度.因此，非负性和规范性是判断某个函数能否作为概率密度函数的充分必要条件.

\begin{property}
    \indent 对于任意实数 $a,b\,(a<b)$，有
    $$
    P(a < X \leqslant b) = F(b)-F(a) = \int_a^b f(x)\,\text{d}x
    $$
\end{property}

由以上性质可知，概率密度曲线总是位于 $x$ 轴上方，并且介于它和 $x$ 轴之间的面积等于 1；随机变量落在区间 $(a,b]$ 的概率 $P(a < X \leqslant b)$ 等于区间 $(a,b]$ 上曲线 $y=f(x)$ 之下的曲边梯形的面积.

\begin{property}[][][prop:F'(x)=f(x)]
    \indent 如果 $f(x)$ 在点 $x$ 处连续，则有 $F'(x)=f(x)$.
\end{property}

由性质 \ref{prop:F'(x)=f(x)} 可知，在 $f(x)$ 的连续点有
$$
\begin{aligned}
    f(x) &= \lim_{\Delta x \to 0^+} \dfrac{F(x + \Delta x)-F(x)}{\Delta x}\\
    &= \lim_{\Delta x \to 0^+} \dfrac{P(x < X \leqslant x + \Delta x)}{\Delta x}
\end{aligned}
$$
可见概率密度反映了随机变量在点 $x$ 处概率分布的密集程度.$f(x)$ 的大小能反映出随机变量 $X$ 在点 $x$ 附近取值的可能性大小，即概率的大小.因此，用概率密度描述连续型随机变量的分布比用分布函数更直观.当不考虑高阶无穷小时，有
$$
P(x < X \leqslant x + \Delta x) \approx f(x) \Delta x
$$

\begin{conclusion}
    \indent 连续型随机变量取任意指定实数的概率均为零.
\end{conclusion}

\begin{proof}
    对于 $X$ 的任意一个可取的值 $x$，设 $\Delta x > 0$，由于事件 $\{X=x\} \subseteq \{x - \Delta x < X \leqslant x\}$，因此有
    $$
    0 \leqslant P(X=x) \leqslant P(x - \Delta x < X \leqslant x) = F(x)-F(x-\Delta x)
    $$
    令 $\Delta x \to 0$，可得
    $$
    P(X=x)=0
    $$
    因此，连续型随机变量取任意指定实数的概率均为零.
\end{proof}

据此，在计算连续型随机变量在某一区间取值的概率时，可以不区分该区间是开区间或闭区间或半开半闭区间，即有
$$
P(x_1 < X < x_2) = P(x_1 \leqslant X \leqslant x_2) = P(x_1 < X \leqslant x_2) = P(x_1 \leqslant X < x_2) = \int_{x_1}^{x_2} f(x)\,\text{d}x
$$

由上述结论可知，不可能事件的概率为 $0$，但概率为 $0$ 的事件未必是不可能事件.类似地，必然事件的概率为 $1$，但概率为 $1$ 的事件未必是必然事件.

\begin{note}
    \indent 由于在若干点上改变概率密度 $f(x)$ 的值并不影响其积分的值，从而不影响其分布函数 $F(x)$ 的值，这意味着一个连续型概率分布的概率密度不唯一.例如：
    $$
    f_1(x) = \begin{cases}
        \dfrac{1}{a}, & 0 \leqslant x \leqslant a \\[0.3em]
        0, & \text{其他} \\
    \end{cases}
    \qquad
    f_2(x) = \begin{cases}
        \dfrac{1}{a}, & 0 < x < a \\[0.3em]
        0, & \text{其他}
    \end{cases} \\
    $$
    这两个概率密度只在 $x=0$ 和 $x=a$ 处的取值不同，因此
    $$
    P(f_1(x) \not= f_2(x)) = P(X=0) + P(X=a) = 0
    $$
    可见这两个函数在概率意义上没有差别，称 $f_1(x)$ 与 $f_2(x)$ “几乎处处相等”，其意义是：在概率论中可除去概率为 $0$ 的事件后讨论两个函数相等和其他随机问题.
\end{note}

\begin{note}
    \indent 除了离散型概率分布和连续型概率分布之外，还有既非离散又非连续的分布.例如：
    $$
    F(x) = \begin{cases}
        0, & x<0 \\
        \dfrac{x+1}{2}, & 0 \leqslant x < 1 \\
        1, & x \geqslant 1
    \end{cases}
    $$
    $F(x)$ 是一个分布函数，它既不是阶梯函数，也不是连续函数，所以它既不是离散型概率分布，又不是连续型概率分布.这是一种新的分布，这类分布函数通常可以分解为两个分布函数的凸组合，如上述 $F(x)$ 可分解为
    $$
    F(x) = \dfrac{1}{2} F_1(x) + \dfrac{1}{2} F_2(x)
    $$
    其中
    $$
    F_1(x) = \begin{cases}
        0, & x<0 \\
        1, & x \geqslant 0
    \end{cases}
    \qquad
    F_2(x) = \begin{cases}
        0, & x<0 \\
        x, & 0 \leqslant x < 1 \\
        1, & x \geqslant 1
    \end{cases}
    $$
    而 $F_1(x)$ 是离散型概率分布（单点分布）的分布函数，$F_2(x)$ 是连续型概率分布（均匀分布）的分布函数.
\end{note}

\section{常用的概率分布}

\subsection{(0-1)分布}

\begin{definition}
    \indent 如果离散型随机变量 $X$ 只取 $0$ 与 $1$ 两个值，其概率分布为
    $$
    P(X=0)=1-p, \; P(X=1)=p, \; 0<p<1
    $$
    或写成
    $$
    P(X=k)=p^k (1-p)^{1-k}, \; k=0,1, \; 0<p<1
    $$
    则称随机变量 $X$ 服从参数为 $p$ 的{\heiti (0-1)分布}或{\heiti 两点分布}（two-point distribution）.
\end{definition}

服从两点分布的随机变量 $X$ 的概率分布也可以写成
\begin{table*}[htbp]
    \centering

    \begin{tabular}{c | c c}
        \hline
        $X$ & 0 & 1 \\
        \hline
        $P$ & $1-p$ & $p$ \\
        \hline
    \end{tabular}
\end{table*}

\subsection{二项分布}

在 $n$ 重伯努利试验中，如果以 $X$ 表示事件 $A$ 出现的次数，则 $X$ 是一个离散型随机变量，它的所有可能取值是 $0,1,2,\cdots,n$.设 $P(A)=p\,(0<p<1)$，则由二项概率公式（式 \eqref{equation:binomial}）可得
$$
P(X=k)=C_n^k p^k (1-p)^{n-k}, \; k=0,1,\cdots,n
$$

\begin{definition}[][][def:binomial distribution]
    \indent 如果随机变量 $X$ 的概率分布为
    $$
    P(X=k)=C_n^k p^k (1-p)^{n-k}, \; k=0,1,\cdots,n
    $$
    则称随机变量 $X$ 服从参数为 $n,p$ 的{\heiti 二项分布}（binomial distribution），记作 $X \sim B(n,p)$.
\end{definition}

由定义 \ref{def:binomial distribution} 可得
\begin{gather*}
    P(X=k) \geqslant 0\\
    \sum_{k=0}^n P(X=k) = \sum_{k=0}^n C_n^k p^k (1-p)^{n-k} = [p+(1-p)]^n=1
\end{gather*}

特别地，当 $n=1$ 时，二项分布 $B(1,p)$ 的概率分布为
$$
P(X=k) = p^k (1-p)^{1-k}, \; k=0,1
$$
这就是(0-1)分布. 因此，(0-1)分布是二项分布的特例.

在 $n$ 重伯努利试验中，设第 $i$ 次试验中 $A$ 出现的次数为 $X_i$，则 $X_i$ 服从(0-1)分布.由于 $n$ 次试验相互独立，所以产生的 $n$ 个随机变量 $X_1, X_2, \cdots, X_n$ 也相互独立，将它们加起来，得到新的随机变量
$$
X = X_1 + X_2 + \cdots + X_n
$$
$X$ 就是 $n$ 重伯努利试验中 $A$ 出现的总次数，它服从二项分布 $B(n,p)$.因此，服从二项分布的随机变量总可以分解成 $n$ 个相互独立且同为(0-1)分布的随机变量之和.

\subsection{泊松分布}

\begin{definition}
    \indent 如果离散型随机变量 $X$ 的所有可能取值为 $0,1,2,\cdots$，并且
    $$
    P(X=k) = \dfrac{\lambda^k e^{-\lambda}}{k!}, \; k=0,1,2\cdots
    $$
    其中 $\lambda > 0$ 是常数，则称随机变量 $X$ 服从参数为 $\lambda$ 的{\heiti 泊松分布}（poisson distribution），记作 $X \sim P(\lambda)$ 或 $X \sim \pi(\lambda)$.
\end{definition}

由定义可知
\begin{gather*}
    \dfrac{\lambda^k e^{-\lambda}}{k!} > 0 \\
    \sum_{k=0}^\infty \dfrac{\lambda^k e^{-\lambda}}{k!} = e^{-\lambda} \sum_{k=0}^\infty \dfrac{\lambda^k}{k!} = e^{-\lambda} e^{\lambda} = 1
\end{gather*}

\begin{figure}[htbp]
    \centering

    \begin{tikzpicture}[scale=0.8]
        \begin{axis}[xlabel=$x$, ylabel=$y$,
            axis lines=center,
            tick align=inside,
            xtick distance=5, ytick distance=0.1,
            minor x tick num=4,
            xmin=0, xmax=22.9,
            ymin=0, ymax=0.45,
            every axis x label/.style={
                at={(xticklabel* cs:1)},
                anchor=north
            },
            every axis y label/.style={
                at={(yticklabel* cs:1)},
                anchor=east
            },
            legend style={
                cells={anchor=west}
            },
            extra x ticks={0},
            extra x tick label={$O$},
            extra x tick style={
                tick label style={anchor=north east}
            }
        ]
            \addplot[domain=0:20, samples=21, mark=*]{exp(-1)/(x!)};
            \addplot[domain=0:20, samples=21, mark=square, color=blue]{5^x * exp(-5) / (x!)};
            \addplot[domain=0:20, samples=21, mark=x, color=red]{10^x * exp(-10) / (x!)};

            \legend{$\lambda=1$, $\lambda=5$, $\lambda=10$}
        \end{axis}
    \end{tikzpicture}

    \caption{泊松分布}
\end{figure}

\begin{theorem}[][泊松定理]
    \indent 设 $\{ p_n \}$ 为一个实数序列，且对于任意正整数 $n$，有 $p_n \in [0,1]$.若 $n \to \infty$ 时有 $n p_n \to \lambda$（$\lambda > 0$），则对任一固定的非负整数 $k$，有
    $$
    \lim_{n\to\infty} C_n^k p_n^k (1-p_n)^{n-k} = \dfrac{\lambda^k e^{-\lambda}}{k!}
    $$
\end{theorem}

\begin{proof}
    记 $n p_n=\lambda_n$，即 $p_n=\dfrac{\lambda_n}{n}$，从而对于任意固定的非负整数 $k$，有
    $$
    \begin{aligned}
        & C_n^k p_n^k (1-p_n)^{n-k} \\
        =\ & \dfrac{n(n-1) \cdots (n-k+1)}{k!} \left( \dfrac{\lambda_n}{n} \right)^k \left( 1-\dfrac{\lambda_n}{n} \right)^{n-k} \\
        =\ & \dfrac{\lambda_n^k}{k!} \left[ \left( 1-\dfrac{1}{n} \right) \left( 1-\dfrac{2}{n} \right) \cdots \left( 1-\dfrac{k-1}{n} \right) \right] \left( 1-\dfrac{\lambda_n}{n} \right)^n \left( 1-\dfrac{\lambda_n}{n} \right)^{-k}
    \end{aligned}
    $$
    对于固定的 $k$，有
    $$
    \begin{aligned}
        & \lim_{n \to \infty} \lambda_n = \lambda \\
        & \lim_{n \to \infty} \left( 1-\dfrac{1}{n} \right) \left( 1-\dfrac{2}{n} \right) \cdots \left( 1-\dfrac{k-1}{n} \right) = 1 \\
        & \lim_{n \to \infty} \left( 1-\dfrac{\lambda_n}{n} \right)^n = e^{-\lambda} \\
        & \lim_{n \to \infty} \left( 1-\dfrac{\lambda_n}{n} \right)^{-k} = 1 \\
    \end{aligned}
    $$
    所以
    $$
    \lim_{n\to\infty} C_n^k p_n^k (1-p_n)^{n-k} = \dfrac{\lambda^k e^{-\lambda}}{k!}
    $$
\end{proof}

对于二项分布 $B(n,p)$，$np$ 为定值，当 $n$ 很大而 $p$ 很小时，$np = \lambda$ 大小适中，可以将二项分布近似为泊松分布.

\subsection{几何分布}

设试验 $E$ 只有两个对立的结果 $A$ 和 $\overline{A}$，并且 $P(A)=p, \, P(\overline{A})=1-p$，其中 $0<p<1$. 将试验 $E$ 独立地重复进行下去，直到事件 $A$ 发生为止. 如果用 $X$ 表示所需要的试验次数，则 $X$ 是一个离散型随机变量，它的所有可能取值为 $1,2,3,\cdots$，其概率分布为
$$
P(X=k) = (1-p)^{k-1} p, \; k=1,2,\cdots
$$
称随机变量 $X$ 服从参数为 $p$ 的\textbf{几何分布}（geometric distribution），记作 $X \sim Ge(p)$.

易知
\begin{gather*}
    (1-p)^{k-1} p > 0\\
    \sum_{k=1}^\infty (1-p)^{k-1} p = p \sum_{i=0}^\infty (1-p)^i = p \cdot \dfrac{1}{1-(1-p)} = 1    
\end{gather*}

\begin{theorem}[][几何分布的无记忆性][theorem:几何分布的无记忆性]
    \indent 设 $X \sim Ge(p)$，则对任意正整数 $m$ 与 $n$，有
    \begin{equation}
        P(X > m+n \mid X>m) = P(X>n)
    \end{equation}
\end{theorem}

\begin{proof}
    因为
    $$
    P(X>n) = \sum_{k=n+1}^{\infty} (1-p)^{k-1} p = \dfrac{p (1-p)^n}{1-(1-p)} = (1-p)^n
    $$
    所以对任意正整数 $m$ 与 $n$，有
    $$
    P(X > m+n \mid X>m) = \dfrac{P(X > m+n)}{P(X>m)} = \dfrac{(1-p)^{m+n}}{(1-p)^m} = (1-p)^n = P(X>n)
    $$

    \vspace{-2em}
\end{proof}

\begin{note}
    \indent 若 $X \sim Ge(p)$，则事件 $\{ X>m \}$ 表示前 $m$ 次试验中 $A$ 没有出现.假如在接下去的 $n$ 次试验中 $A$ 仍未出现，这个事件记为 $\{ X > m+n \}$.定理 \ref{theorem:几何分布的无记忆性} 表明，在前 $m$ 次试验中 $A$ 没有出现的条件下，接下去的 $n$ 次试验中 $A$ 仍未出现的概率只与 $n$ 有关，而与之前的 $m$ 次试验无关，这就是无记忆性.
\end{note}

\subsection{超几何分布}

设有 $N$ 件物品，其中有 $M$（$M \leqslant N$） 件为甲类，从中不放回地随机抽取 $n$（$n \leqslant N$） 件，记抽出甲类物品的数量为 $X$，则随机变量 $X$ 服从\textbf{超几何分布}（hypergeometric distribution），记为 $X \sim H(n,N,M)$.

当 $n \leqslant N-M$ 时，$X$ 的取值范围为 $0,1,2,\cdots,\min\{ M,n \}$；当 $n > N-M$ 时，一定能够抽出甲类物品，$X$ 的取值范围为 $n+M-N, n+M-N+1, n+M-N+2, \cdots, \min\{ M,n \}$.综合两种情况，记 $m = \max\{ 0, n+M-N \}$，$r = \min\{ M,n \}$，则超几何分布的概率分布为
$$
P(X=k) = \dfrac{C_M^k C_{N-M}^{n-k}}{C_N^n},\ k=m, m+1, m+2, \cdots, r
$$

\begin{note}
    \indent 当 $N=M$ 时，有
    $$
    P(X=n) = \dfrac{C_M^n C_{N-M}^{n-n}}{C_N^n} = C_0^0 = 1
    $$
    $C_0^0$ 本身没有意义，但为了保证组合数定义的一致性，规定 $C_0^0 = 1$.
\end{note}

当 $n \ll N$ 时，每次抽取后，甲类物品所占比例 $p = \dfrac{M}{N}$ 改变很小，此时可以将不放回抽样近似看做放回抽样，超几何分布近似为二项分布：
$$
\dfrac{C_M^k C_{N-M}^{n-k}}{C_N^n} \approx C_n^k p^k (1-p)^{n-k}
$$

\subsection{负二项分布}

设试验 $E$ 只有两个对立的结果 $A$ 和 $\overline{A}$，并且 $P(A)=p, \, P(\overline{A})=1-p$，其中 $0<p<1$. 将试验 $E$ 独立地重复进行下去，记事件 $A$ 第 $r$ 次出现时的试验次数为 $X$，则 $X$ 的可能取值为 $r, r+1, r+2, \cdots$，称随机变量 $X$ 服从\textbf{负二项分布}或\textbf{帕斯卡分布}，记作 $X \sim Nb(r,p)$.

如果 $X=k$，意味着第 $k$ 次试验时事件 $A$ 第 $r$ 次出现，而前 $k-1$ 次试验中 $A$ 出现 $r-1$ 次，由二项分布知
$$
P(X=k) = C_{k-1}^{r-1} p^{r-1} (1-p)^{k-r} \cdot p
$$
因此负二项分布的概率分布为
$$
P(X=k) = C_{k-1}^{r-1} p^r (1-p)^{k-r},\ k = r, r+1, r+2, \cdots
$$

当 $r=1$ 时，负二项分布即为几何分布.

如果将第一个 $A$ 出现的试验次数记为 $X_1$，第二个 $A$ 出现的试验次数记为 $X_2$（从第一个 $A$ 出现之后算起），$\cdots$，第 $r$ 个 $A$ 出现的试验次数记为 $X_r$（从第 $r-1$ 个 $A$ 出现之后算起），则诸 $X_i$ 独立同分布，且 $X_i \sim Ge(p)$.此时有 $X = X_1 + X_2 + \cdots + X_r \sim Nb(r,p)$，即负二项分布的随机变量可以分解成 $r$ 个独立同分布的几何分布随机变量之和.

\subsection{均匀分布}

\begin{definition}
    \indent 如果连续型随机变量 $X$ 的概率密度为
    $$
    f(x)=\begin{cases}
        \dfrac{1}{b-a}, & a<x<b \\[0.5em]
        0, & \text{其他}
    \end{cases}
    $$
    则称 $X$ 在区间 $(a,b)$ 上服从{\heiti 均匀分布}（uniform distribution），记作 $X \sim U(a,b)$.
\end{definition}

均匀分布 $U(a,b)$ 的分布函数为
$$
F(x)=\begin{cases}
    0, & x<a \\[0.5em]
    \dfrac{x-a}{b-a}, & a \leqslant x < b \\[0.5em]
    1, & x \geqslant b
\end{cases}
$$

\begin{figure}[htbp]
    \centering

    \subfigure[均匀分布的概率密度]{
        \centering
        \begin{tikzpicture}[>=Stealth]
            % 坐标轴
            \draw[->] (-1, 0)--(3, 0) node[below]{$x$};
            \draw[->] (0, -1)--(0, 2.5) node[left]{$f(x)$};
            \node at (0, 0) [below right] {$O$};
            % 定义端点
            \coordinate (m) at (-0.5, 1);
            \coordinate (n) at (2.5, 1);
            % 曲线
            \draw[line width=1.5pt] (m)--(n);
            \draw[line width=1.5pt] (-1, 0)--(-0.5, 0);
            \draw[line width=1.5pt] (2.5, 0)--(2.85,0);
            % 标记点
            \fill (-0.5, 0) node[below]{$a$} circle (2pt);
            \fill (2.5, 0) node[below]{$b$} circle (2pt);
            \node at (m) [dot] {};
            \node at (n) [dot] {};
            \node at (0, 1) [above right] {$\dfrac{1}{b-a}$};
        \end{tikzpicture}
    }
    \subfigure[均匀分布的分布函数]{
        \centering
        \begin{tikzpicture}[>=Stealth]
            % 坐标轴
            \draw[->] (-1, 0)--(4, 0) node[below]{$x$};
            \draw[->] (0, -1)--(0, 2.5) node[left]{$F(x)$};
            \node at (0, 0) [below right] {$O$};
            % 曲线
            \draw[line width=1.5pt] (-1, 0) -- (-0.5, 0) node[below]{$a$} -- (2.5, 1) -- (3.5, 1);
            % 标记点
            \node at (0, 1) [left] {$1$};
            \node at (2.5, 0) [below] {$b$};
            % 辅助线
            \draw[dashed] (0, 1)--(2.5, 1)--(2.5, 0);
        \end{tikzpicture}
    }

    \caption{均匀分布}
\end{figure}

对任意的两个数 $x_1, x_2 \in (a,b)$，如果 $x_1 < x_2$，则有
$$
P\{x_1 \leqslant X \leqslant x_2\} = \int_{x_1}^{x_2} \dfrac{\text{d}x}{b-a} = \dfrac{x_2-x_1}{b-a}
$$
这说明随机变量 $X$ 位于区间 $(a,b)$ 的任一子区间 $[x_1,x_2]$ 内的概率，只依赖于子区间 $[x_1,x_2]$ 的长度，而与子区间的位置无关.

\subsection{指数分布}

\begin{definition}
    \indent 如果连续型随机变量 $X$ 的概率密度为
    $$
    f(x)=\begin{cases}
        \lambda e^{-\lambda x} & x>0 \\
        0 & x \leqslant 0
    \end{cases}
    $$
    其中 $\lambda>0$ 是常数，则称 $X$ 服从参数为 $\lambda$ 的{\heiti 指数分布}（exponential distribution），记作 $X \sim Exp(\lambda)$.
\end{definition}

指数分布 $Exp(\lambda)$ 的分布函数为
$$
F(x)=\begin{cases}
    0, & x \leqslant 0 \\
    1 - e^{-\lambda x}, & x>0
\end{cases}
$$

\begin{figure}[htbp]
    \centering

    \subfigure[指数分布的概率密度]{
        \centering
        \begin{tikzpicture}[>=Stealth]
            % 坐标轴
            \draw[->] (-1, 0)--(3.5, 0) node[below]{$x$};
            \draw[->] (0, -1)--(0, 2) node[left]{$f(x)$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[domain=0:3, line width=1.5pt] plot (\x, {exp(-1 * \x)});
            \draw[line width=1.5pt] (-1, 0)--(0, 0);
            % 标记点
            \node at (0, 1) [dot, label={left: $\lambda$}] {};
            \fill (0, 0) circle (2pt);
        \end{tikzpicture}
    }
    \hspace{3em}
    \subfigure[指数分布的分布函数]{
        \centering
        \begin{tikzpicture}[>=Stealth]
            % 坐标轴
            \draw[->] (-1, 0)--(3.5, 0) node[below]{$x$};
            \draw[->] (0, -1)--(0, 2) node[left]{$F(x)$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[domain=0:3, line width=1.5pt] plot (\x, {1 - exp(-1 * \x)});
            \draw[line width=1.5pt] (-1, 0)--(0, 0);
            % 辅助线
            \draw[dashed] (0, 1) node[left]{$1$} -- (3.2, 1);
        \end{tikzpicture}
    }

    \vspace{-1em}
    \caption{指数分布}
\end{figure}

\begin{theorem}[][指数分布的无记忆性][theorem:指数分布的无记忆性]
    \indent 如果随机变量 $X \sim Exp(\lambda)$，则对任意实数 $s>0, t>0$，有
    \begin{equation}
        P(X > s+t \mid X>s) = P(X>t)
    \end{equation}
\end{theorem}

\begin{proof}
    因为 $X \sim Exp(\lambda)$，所以对任意实数 $s>0$，有
    $$
    P(X>s) = 1 - P(X \leqslant s) = 1 - (1 - e^{-\lambda s}) = e^{-\lambda s}
    $$
    又因为 $\{ X > s+t \} \subseteq \{ X>s \}$，所以 $\{ X > s+t \} \cap \{ X>s \} = \{ X > s+t \}$.于是
    $$
    P(X > s+t \mid X>s) = \dfrac{P(X > s+t)}{P(X>s)} = \dfrac{e^{-\lambda (s+t)}}{e^{-\lambda s}} = e^{-\lambda t} = P(X > t)
    $$

    \vspace{-2em}
\end{proof}

定理 \ref{theorem:指数分布的无记忆性} 的含义为：记 $X$ 是某种产品的使用寿命，若 $X$ 服从指数分布，那么已知此产品使用了 $s$ 小时没发生故障，则能再使用 $t$ 小时而不发生故障的概率与已使用的 $s$ 小时无关，只相当于重新开始使用 $t$ 小时的概率.

\begin{conclusion}[][泊松分布与指数分布的关系]
    \indent 如果在 $[0,t]$ 时间段内随机事件 $A$ 发生的次数 $N(t)$ 服从参数为 $\lambda t$ 的泊松分布，则 $A$ 相邻两次发生的时间间隔 $T$ 服从参数为 $\lambda$ 的指数分布.
\end{conclusion}

\begin{proof}
    由于 $N(t) \sim P(\lambda t)$，即
    $$
    P(N(t) = k) = \dfrac{(\lambda t)^k e^{- \lambda t}}{k!},\ k=0,1,2,\cdots
    $$

    事件 $\{ T \geqslant t \}$ 说明此设备在 $[0,t]$ 内没有发生故障，即 $\{ T \geqslant t \} = \{ N(t) = 0 \}$，由此可得：
    \begin{itemize}
        \item 当 $t<0$ 时，有 $F_T(t) = P(T \leqslant t) = 0$；
        \item 当 $t \geqslant 0$ 时，有
        $$
        F_T(t) = P(T \leqslant t) = 1 - P(T>t) = 1 - P(N(t) = 0) = 1 - e^{-\lambda t}
        $$
    \end{itemize}
    所以 $T \sim Exp(\lambda)$.
\end{proof}

\subsection{正态分布}

\subsubsection{正态分布及其性质}

\begin{definition}
    \indent 如果连续型随机变量 $X$ 的概率密度为
    $$
    f(x) = \dfrac{1}{\sqrt{2\pi} \sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}, \; -\infty < x < +\infty
    $$
    其中 $\mu,\sigma \, (\sigma>0)$ 为常数，则称 $X$ 服从参数为 $\mu,\sigma$ 的{\heiti 正态分布}（normal distribution），记作 $X \sim N(\mu,\sigma^2)$.
\end{definition}

概率密度 $f(x)$ 的图像如图 \ref{fig:正态分布的概率密度} 所示，它是一条钟形曲线，关于直线 $x=\mu$ 对称，并在 $x=\mu$ 处取得最大值 $\dfrac{1}{\sqrt{2\pi}\sigma}$，在 $x=\mu\pm\sigma$ 处有拐点，以 $x$ 轴为水平渐近线.

正态分布 $N(\mu,\sigma^2)$ 的分布函数为
$$
F(x) = \dfrac{1}{\sqrt{2\pi} \sigma} \int_{-\infty}^x e^{-\frac{(t-\mu)^2}{2\sigma^2}} \, \text{d}t, \; -\infty < x < +\infty
$$
它是一条光滑上升的 S 形曲线，如图 \ref{fig:正态分布的分布函数} 所示.

\begin{figure}[htbp]
    \centering

    \subfigure[正态分布的概率密度]{
        \centering
        \begin{tikzpicture}[>=Stealth, yscale=4, xscale=0.8]
            % 定义变量
            \def\Mu{2}
            \def\Sigma{1}
            % 坐标轴
            \draw[->] (\Mu-3*\Sigma-0.5, 0)--(\Mu+3*\Sigma+0.5, 0) node[below]{$x$};
            \draw[->] (0, -0.2)--(0, 0.6) node[right]{$f(x)$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[domain=\Mu-3*\Sigma:\Mu+3*\Sigma, line width=1.5pt, smooth] plot (\x, {exp(-1 * pow(\x-\Mu, 2) / (2*\Sigma*\Sigma)) / (sqrt(2*pi)*\Sigma)});
            % 辅助线
            \draw[dashed] (0, {1/(sqrt(2*pi)*\Sigma)}) node[left]{$\dfrac{1}{\sqrt{2 \pi} \sigma}$} -- (\Mu, {1/(sqrt(2*pi)*\Sigma)}) -- (\Mu, 0) node[below]{$\mu$};
            \draw[dashed] (\Mu-\Sigma, 0) node[below]{$\mu-\sigma$} -- (\Mu-\Sigma, {exp(-0.5) / (sqrt(2*pi)*\Sigma)});
            \draw[dashed] (\Mu+\Sigma, 0) node[below]{$\mu+\sigma$} -- (\Mu+\Sigma, {exp(-0.5) / (sqrt(2*pi)*\Sigma)});
        \end{tikzpicture}
        \label{fig:正态分布的概率密度}
    }
    \hspace{3em}
    \subfigure[正态分布的分布函数]{
        \centering
        \begin{tikzpicture}[>=Stealth, yscale=1.6, xscale=0.8]
            % 定义变量
            \def\Mu{2}
            \def\Sigma{1}
            % 坐标轴
            \draw[->] (-1, 0)--(5, 0) node[below]{$x$};
            \draw[->] (0, -0.5)--(0, 1.5) node[left]{$F(x)$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[domain=-0.5:4.5, line width=1.5pt, smooth] plot (\x, {1 / (1+exp(-1.70174454109 * (\x-\Mu)))});
            % 辅助线
            \draw[dashed] (0, 1) node[left]{$1$} -- (4.7, 1);
            \draw[dashed] (0, 0.5) node[left]{$0.5$} -- (\Mu, 0.5) -- (\Mu, 0) node[below]{$\mu$};
        \end{tikzpicture}
        \label{fig:正态分布的分布函数}
    }

    \vspace{-1em}
    \caption{正态分布}
\end{figure}

如果固定 $\sigma$，改变 $\mu$ 的值，则概率密度曲线沿着 $x$ 轴平移，但形状不变，如图 \ref{fig:mu} 所示.由此可见，正态密度函数的位置由参数 $\mu$ 确定，因此称 $\mu$ 为\textbf{位置参数}.

如果固定 $\mu$，改变 $\sigma$ 的值，则由 $y_{\text{max}}=\dfrac{1}{\sqrt{2\pi}\sigma}$ 可知：$\sigma$ 越小，概率密度曲线在 $x=\mu$ 附近越陡峭，形状高而瘦，分布较为集中，$X$ 落在 $x=\mu$ 附近的概率较大；$\sigma$ 越大，概率密度曲线越平坦，形状矮而胖，分布较为分散.如图 \ref{fig:sigma} 所示.可见正态密度函数的尺度由参数 $\sigma$ 确定，因此称 $\sigma$ 为\textbf{尺度参数}.

\begin{figure}[htbp]
    \centering

    \subfigure[固定 $\sigma$，改变 $\mu$]{
        \centering

        \begin{tikzpicture}[>=Stealth, xscale=0.9, yscale=3.5]
            % 定义变量
            \def\Mu{2}
            \def\Sigma{0.7}
            \def\xMu{4.5}
            % 坐标轴
            \draw[->] (\Mu-3*\Sigma-0.5, 0)--(\xMu+3*\Sigma+0.5, 0) node[below]{$x$};
            \draw[->] (0, -0.2)--(0, 0.9) node[right]{$f(x)$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[domain=\Mu-3*\Sigma:\Mu+3*\Sigma, line width=1.5pt, smooth] plot (\x, {exp(-1 * pow(\x-\Mu, 2) / (2*\Sigma*\Sigma)) / (sqrt(2*pi)*\Sigma)});
            \draw[domain=\xMu-3*\Sigma:\xMu+3*\Sigma, line width=1.5pt, smooth] plot (\x, {exp(-1 * pow(\x-\xMu, 2) / (2*\Sigma*\Sigma)) / (sqrt(2*pi)*\Sigma)});
            % 辅助线
            \draw[dashed] (\Mu, {1/(sqrt(2*pi)*\Sigma)}) -- (\Mu, 0) node[below]{$\mu_1$};
            \draw[dashed] (\xMu, {1/(sqrt(2*pi)*\Sigma)}) -- (\xMu, 0) node[below]{$\mu_2$};
        \end{tikzpicture}

        \label{fig:mu}
    }
    \subfigure[固定 $\mu$，改变 $\sigma$]{
        \centering

        \begin{tikzpicture}[>=Stealth, xscale=0.9, yscale=3.5]
            % 定义变量
            \def\Mu{2}
            \def\Sigma{1}
            \def\sSigma{0.5}
            \def\tSigma{2}
            % 坐标轴
            \draw[->] (\Mu-2*\tSigma-0.5, 0)--(\Mu+2*\tSigma+0.5, 0) node[below]{$x$};
            \draw[->] (0, -0.2)--(0, 0.9) node[right]{$f(x)$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[domain=\Mu-3*\Sigma:\Mu+3*\Sigma, line width=1.5pt, smooth] plot (\x, {exp(-1 * pow(\x-\Mu, 2) / (2*\Sigma*\Sigma)) / (sqrt(2*pi)*\Sigma)});
            \draw[domain=\Mu-3*\sSigma:\Mu+3*\sSigma, line width=1.5pt, draw=red, smooth] plot (\x, {exp(-1 * pow(\x-\Mu, 2) / (2*\sSigma*\sSigma)) / (sqrt(2*pi)*\sSigma)});
            \draw[domain=\Mu-2*\tSigma:\Mu+2*\tSigma, line width=1.5pt, draw=blue, smooth] plot (\x, {exp(-1 * pow(\x-\Mu, 2) / (2*\tSigma*\tSigma)) / (sqrt(2*pi)*\tSigma)});
            % 辅助线
            \draw[dashed] (\Mu, {1/(sqrt(2*pi)*\sSigma)}) -- (\Mu, 0) node[below]{$\mu$};
            % 图例
            \draw (4, 0.9) rectangle (7, 0.5);
            \draw[line width=1.5pt, draw=red] (4.25, 0.8) -- (5, 0.8) node[right]{$\sigma=0.5$};
            \draw[line width=1.5pt] (4.25, 0.7) -- (5, 0.7) node[right]{$\sigma=1$};
            \draw[line width=1.5pt, draw=blue] (4.25, 0.6) -- (5, 0.6) node[right]{$\sigma=2$};
        \end{tikzpicture}

        \label{fig:sigma}
    }

    \vspace{-1em}
    \caption{}
\end{figure}

\subsubsection{标准正态分布}

\begin{definition}
    \indent 设 $X \sim N(\mu,\sigma^2)$，如果 $\mu=0,\sigma=1$，则称 $X$ 服从{\heiti 标准正态分布}（standard normal distribution），记作 $X \sim N(0,1)$.
\end{definition}

服从标准正态分布的随机变量 $X$ 的概率密度记作 $\varphi(x)$，分布函数记作 $\varPhi(x)$，即
$$
\begin{aligned}
    & \varphi(x) = \dfrac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}, \; -\infty < x < +\infty \\
    & \varPhi(x) = \dfrac{1}{\sqrt{2\pi}} \int_{-\infty}^x e^{-\frac{t^2}{2}}\,\text{d}t, \; -\infty < x < +\infty
\end{aligned}
$$

\begin{figure}[htbp]
    \centering

    \subfigure[标准正态分布的概率密度]{
        \centering
        \begin{tikzpicture}[>=Stealth, yscale=4, xscale=0.8]
            % 定义变量
            \def\Mu{0}
            \def\Sigma{1}
            % 坐标轴
            \draw[->] (\Mu-3*\Sigma-0.5, 0)--(\Mu+3*\Sigma+0.5, 0) node[below]{$x$};
            \draw[->] (0, -0.2)--(0, 0.6) node[right]{$\varphi(x)$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[domain=\Mu-3*\Sigma:\Mu+3*\Sigma, line width=1.5pt, smooth] plot (\x, {exp(-1 * pow(\x-\Mu, 2) / (2*\Sigma*\Sigma)) / (sqrt(2*pi)*\Sigma)});
        \end{tikzpicture}
    }
    \hspace{2em}
    \subfigure[标准正态分布的分布函数]{
        \centering
        \begin{tikzpicture}[>=Stealth, yscale=1.6, xscale=0.8]
            % 定义变量
            \def\Mu{0}
            \def\Sigma{1}
            % 坐标轴
            \draw[->] (\Mu-3*\Sigma-0.5, 0)--(\Mu+3*\Sigma+0.5, 0) node[below]{$x$};
            \draw[->] (0, -0.5)--(0, 1.5) node[right]{$\varPhi(x)$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[domain=\Mu-3*\Sigma:\Mu+3*\Sigma, line width=1.5pt, smooth] plot (\x, {1 / (1+exp(-1.70174454109 * (\x-\Mu)))});
            % 辅助线
            \draw[dashed] (\Mu-3*\Sigma-0.2, 1) -- (\Mu+3*\Sigma+0.2, 1);
            % 特殊点
            \node at (0, 0.5) [left] {$0.5$};
            \node at (0, 1) [above left] {$1$};
            % 刻度
            \draw (-3pt, 0.5)--(3pt, 0.5);
        \end{tikzpicture}
    }

    \vspace{-1em}
    \caption{标准正态分布}
\end{figure}

\begin{property}
    \begin{equation} \label{equation:Phi(-x)}
        \varPhi(-x) = 1-\varPhi(x)
    \end{equation}
\end{property}

\begin{proof}
    由于 $\varphi(x)$ 是偶函数，所以 $\varphi(-x)=\varphi(x)$，则
    $$
    \begin{aligned}
        \varPhi(-x) &= \int_{-\infty}^{-x} \varphi(t) \,\text{d}t \\
        &= \int_{-\infty}^{+\infty} \varphi(t) \,\text{d}t - \int_{-x}^{+\infty} \varphi(t) \,\text{d}t \\
        &= 1 - \int_{-x}^{+\infty} \varphi(t) \,\text{d}t
    \end{aligned}
    $$
    令 $u=-t$，得
    $$
    \begin{aligned}
        \varPhi(-x) &= 1 - \int_{x}^{-\infty} \varphi(-u) \,\text{d}(-u) \\
        &= 1 - \int_{-\infty}^{x} \varphi(u) \,\text{d}u \\
        &= 1-\varPhi(x)
    \end{aligned}
    $$

    \vspace{-1.5em}
\end{proof}

\begin{property}
    \indent 若 $X \sim N(0,1)$，则对于任意正的实数 $a$，有
    \begin{equation} \label{equation:P(X>a)}
        P(|X|>a) = 2[1 - \varPhi(a)]
    \end{equation}
    \begin{equation} \label{equation:P(X<=a)}
        P(|X| \leqslant a) = 2 \varPhi(a) - 1
    \end{equation}
\end{property}

\begin{proof}
    $$
    P(|X|>a) = 2 P(X>a) = 2[1 - P(X \leqslant a)] = 2[1-\varPhi(a)]
    $$
    $$
    P(|X| \leqslant a) = 1 - P(|X|>a) = 1-2[1-\varPhi(a)] = 2\varPhi(a)-1
    $$

    \vspace{-2em}
\end{proof}

\begin{property}[][正态分布的标准化][prop:standard]
    \indent 若 $X \sim N(\mu,\sigma^2)$，则 $\dfrac{X - \mu}{\sigma} \sim N(0,1)$.
\end{property}

\begin{proof}
    设 $X$ 的分布函数为 $F_X(x)$.令 $U = \dfrac{X - \mu}{\sigma}$，则其分布函数为
    $$
    F_U(u) = P(U \leqslant u) = P(\dfrac{X - \mu}{\sigma} \leqslant u) = P(X \leqslant \mu + \sigma u) = F_X(\mu + \sigma u)
    $$
    设 $X$ 与 $U$ 的概率密度分别为 $f_X(x)$ 和 $f_U(u)$，则有
    $$
    f_U(u) = \dfrac{\text{d}}{\text{d}u} F_U(u) = \dfrac{\text{d}}{\text{d}u} F_X(\mu + \sigma u) = f_X(\mu + \sigma u) \cdot \sigma = \sigma \dfrac{1}{\sqrt{2\pi} \sigma} e^{-\frac{(\mu + \sigma u - \mu)^2}{2 \sigma^2}} = \dfrac{1}{\sqrt{2\pi}} e^{-\frac{u^2}{2}}
    $$
    因此 $U = \dfrac{X - \mu}{\sigma} \sim N(0,1)$.
\end{proof}

\begin{corollary}
    \indent 如果 $X \sim N(\mu,\sigma^2)$，则
    \begin{equation} \label{equation:standard}
        P(X \leqslant x) = F(x) = \varPhi(\dfrac{x - \mu}{\sigma})
    \end{equation}
\end{corollary}

\begin{corollary}
    \indent 如果 $X \sim N(\mu,\sigma^2)$，则对于任意实数 $x_1,x_2\,(x_1 < x_2)$，有
    \begin{equation} \label{equation:正态随机变量的标准化}
        P(x_1 < X < x_2) = F(x_2)-F(x_1) = \varPhi(\dfrac{x_2-\mu}{\sigma}) - \varPhi(\dfrac{x_1-\mu}{\sigma})
    \end{equation}
\end{corollary}

\begin{conclusion}[][$3\sigma$ 规则]
    \indent 若随机变量 $X \sim N(\mu, \sigma^2)$，则
    $$
    \begin{aligned}
        & P(|X - \mu| < \sigma) = 2\varPhi(1) - 1 = 0.6826 \\
        & P(|X - \mu| < 2\sigma) = 2\varPhi(2) - 1 = 0.9544 \\
        & P(|X - \mu| < 3\sigma) = 2\varPhi(3) - 1 = 0.9974
    \end{aligned}
    $$
\end{conclusion}

\begin{proof}
    由式 \eqref{equation:正态随机变量的标准化} 和式 \eqref{equation:Phi(-x)} 有
    $$
    \begin{aligned}
        P(|X-\mu| < k \sigma) &= P(\mu - k \sigma < X < \mu + k \sigma) \\
        &= \varPhi(\dfrac{\mu + k \sigma - \mu}{\sigma}) - \varPhi(\dfrac{\mu - k \sigma - \mu}{\sigma}) \\
        &= \varPhi(k) - \varPhi(-k) \\
        &= \varPhi(k) - [1 - \varPhi(k)] \\
        &= 2\varPhi(k) - 1
    \end{aligned}
    $$
    所以
    $$
    \begin{aligned}
        & P(|X - \mu| < \sigma) = 2\varPhi(1) - 1 = 0.6826 \\
        & P(|X - \mu| < 2\sigma) = 2\varPhi(2) - 1 = 0.9544 \\
        & P(|X - \mu| < 3\sigma) = 2\varPhi(3) - 1 = 0.9974
    \end{aligned}
    $$
\end{proof}

$3\sigma$ 规则表明，正态随机变量 $X$ 以 99.74\% 的概率落在 $(\mu - 3\sigma, \mu + 3\sigma)$ 区间内，而落在该区间以外的概率小于千分之三. 在一次试验中，$X$ 落在 $(\mu - 3\sigma, \mu + 3\sigma)$ 区间以外这个事件几乎不会发生.

如果某随机变量近似满足 $3\sigma$ 规则，则可认为该随机变量近似服从正态分布；反之，如果随机变量与 $3\sigma$ 规则相差较大，则可认为该随机变量不服从正态分布.

\subsubsection{标准正态分布的上 \texorpdfstring{$\alpha$}{} 分位点}

\begin{definition}
    \indent 设 $X \sim N(0,1)$. 对于给定的 $\alpha \, (0 < \alpha < 1)$，如果 $u_{\alpha}$ 满足条件
    $$
    P(X \geqslant u_{\alpha}) = \dfrac{1}{\sqrt{2\pi}} \int_{u_{\alpha}}^{+\infty} e^{-\frac{x^2}{2}} \, \text{d}x = \alpha
    $$
    则称点 $u_{\alpha}$ 为标准正态分布的{\heiti 上} $\alpha$ {\heiti 分位点}.
\end{definition}

\begin{figure}[htbp]
    \centering

    \begin{tikzpicture}[>=Stealth, yscale=4, xscale=0.8]
        % 定义变量
        \def\Mu{0}
        \def\Sigma{1}
        \def\uAlpha{1.7}
        % 坐标轴
        \draw[->] (\Mu-3*\Sigma-0.5, 0)--(\Mu+3*\Sigma+0.5, 0) node[below]{$x$};
        \draw[->] (0, -0.2)--(0, 0.6) node[right]{$\varphi(x)$};
        \node at (0, 0) [below left] {$O$};
        % 曲线
        \draw[domain=\Mu-3*\Sigma:\Mu+3*\Sigma, line width=1.5pt, smooth] plot (\x, {exp(-1 * pow(\x-\Mu, 2) / (2*\Sigma*\Sigma)) / (sqrt(2*pi)*\Sigma)});
        % 分割线
        \draw (\uAlpha, 0) node[below]{$u_{\alpha}$} -- (\uAlpha, {exp(-1 * pow(\uAlpha-\Mu, 2) / (2*\Sigma*\Sigma)) / (sqrt(2*pi)*\Sigma)});
        % 填充
        \fill[pattern color=gray, pattern=north east lines] (\uAlpha, 0) -- (\uAlpha, {exp(-1 * pow(\uAlpha-\Mu, 2) / (2*\Sigma*\Sigma)) / (sqrt(2*pi)*\Sigma)}) -- plot[domain=\uAlpha:\Mu+3*\Sigma, smooth] (\x, {exp(-1 * pow(\x-\Mu, 2) / (2*\Sigma*\Sigma)) / (sqrt(2*pi)*\Sigma)}) -- (\Mu+3*\Sigma, 0);
        % 指示线
        \draw (2, 0.02) -- (2.5, 0.2) node[above]{$\alpha$};
    \end{tikzpicture}

    \vspace{-1em}

    \caption{标准正态分布的上 $\alpha$ 分位点}
    \label{fig:alpha}
\end{figure}

\begin{property}
    \begin{equation}
        \varPhi(u_{\alpha}) = 1 - \alpha
    \end{equation}
\end{property}

\begin{proof}
    $$
    \varPhi(u_{\alpha}) = P(X \leqslant u_{\alpha}) = 1 - P(X > u_{\alpha}) = 1 - \alpha
    $$
\end{proof}

\begin{property}
    \indent 标准正态分布的上 $1-\alpha$ 分位点 $u_{1-\alpha}$ 与上 $\alpha$ 分位点 $u_{\alpha}$ 关于原点对称，即
    \begin{equation}
        u_{1-\alpha} = -u_{\alpha}
    \end{equation}
\end{property}

\begin{proof}
    $$
    \begin{aligned}
        P(X \geqslant -u_{\alpha}) &= 1 - P(X < -u_{\alpha}) \\
        &= 1 - \varPhi(-u_{\alpha}) \\
        &= 1 - [1 - \varPhi(u_{\alpha})] \\
        &= \varPhi(u_{\alpha}) \\
        &= 1 - \alpha \\
        &= P(X \geqslant u_{1-\alpha})
    \end{aligned}
    $$
    因此 $u_{1-\alpha} = -u_{\alpha}$.
\end{proof}

\subsection{伽马分布}

\begin{definition}
    \indent 函数
    \begin{equation}
        \Gamma(\alpha) = \int_{0}^{+\infty} x^{\alpha - 1} e^{-x} \text{d}x
    \end{equation}
    称为{\heiti 伽马函数}，其中 $\alpha > 0$.
\end{definition}

\begin{property}[][伽马函数的性质]
    \begin{enumerate}
        \item $\Gamma(1) = 1$
        \item $\Gamma(\dfrac{1}{2}) = \sqrt{\pi}$
        \item $\Gamma(\alpha + 1) = \alpha \Gamma(\alpha)$
        \item 对于自然数 $n$，有 $\Gamma(n+1) = n \Gamma(n) = n!$
    \end{enumerate}
\end{property}

\begin{proof}
    （1）
    $$
    \Gamma(1) = \int_{0}^{+\infty} e^{-x} \text{d}x = -e^{-x} \Big|_0^{+\infty} = 1
    $$

    （2）
    $$
    \left[ \Gamma(\dfrac{1}{2}) \right]^2 = \int_{0}^{+\infty} x^{-\frac{1}{2}} e^{-x} \text{d}x \int_{0}^{+\infty} y^{-\frac{1}{2}} e^{-y} \text{d}y = \int_{0}^{+\infty} 2 e^{-x} \text{d} \sqrt{x} \int_{0}^{+\infty} 2 e^{-y} \text{d} \sqrt{y} \\
    $$
    令 $u = \sqrt{x}, v = \sqrt{y}$，则
    $$
    \left[ \Gamma(\dfrac{1}{2}) \right]^2 = \int_{0}^{+\infty} 2 e^{-u^2} \text{d}u \int_{0}^{+\infty} 2 e^{-v^2} \text{d}v = 4 \int_{0}^{+\infty} \int_{0}^{+\infty} e^{-(u^2 + v^2)} \text{d}u \text{d}v
    $$
    令 $u = t \cos\theta, v = t \sin\theta$，则
    $$
    \begin{aligned}
        \left[ \Gamma(\dfrac{1}{2}) \right]^2 &= 4 \int_{0}^{\frac{\pi}{2}} \int_{0}^{+\infty} r e^{-r^2} \text{d}r \text{d} \theta \\
        &= 4 \int_{0}^{\frac{\pi}{2}} \text{d} \theta \int_{0}^{+\infty} r e^{-r^2} \text{d}r \\
        &= 4 \times \dfrac{\pi}{2} \int_{0}^{+\infty} \dfrac{1}{2} e^{-r^2} \text{d}r^2 \\
        &= \pi
    \end{aligned}
    $$
    因此 $\Gamma(\dfrac{1}{2}) = \sqrt{\pi}$.

    （3）
    $$
    \begin{aligned}
        \Gamma(\alpha + 1) &= \int_{0}^{+\infty} x^{\alpha} e^{-x} \text{d}x \\
        &= -\int_{0}^{+\infty} x^{\alpha} \text{d} e^{-x} \\
        &= -\left( x^{\alpha} e^{-x} \Big|_0^{+\infty} - \int_{0}^{+\infty} e^{-x} \text{d} x^{\alpha} \right) \\
        &= \alpha \int_{0}^{+\infty} x^{\alpha - 1} e^{-x} \text{d}x \\
        &= \alpha \Gamma(\alpha)
    \end{aligned}
    $$

    \vspace{-2em}
\end{proof}

\begin{definition}
    \indent 若随机变量 $X$ 的概率密度为
    $$
    f(x) = \begin{cases}
        \dfrac{\lambda^\alpha}{\Gamma(\alpha)} x^{\alpha - 1} e^{-\lambda x}, & x \geqslant 0 \\[0.5em]
        0, & x<0
    \end{cases}
    $$
    则称 $X$ 服从{\heiti 伽马分布}，记作 $X \sim Ga(\alpha,\lambda)$，其中 $\alpha > 0$ 为{\heiti 形状参数}，$\lambda > 0$ 为{\heiti 尺度参数}.
\end{definition}

\begin{figure}[htbp]
    \centering
    % TODO

    \subfigure[$0 < \alpha < 1$]{
        \centering

        \begin{tikzpicture}[>=Stealth, xscale=1.5]
            % 坐标轴
            \draw[->] (0, 0)--(2, 0) node[below]{$x$};
            \draw[->] (0, 0)--(0, 3) node[right]{$y$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[line width=1.5pt] (0.043647748063217556,2.585164399456985)
            -- (0.08891270106368077,1.731126746031798)
            -- (0.13417765406414398,1.3468286668836136)
            -- (0.17944260706460718,1.1130927253418936)
            -- (0.2247075600650704,0.9506638248715757)
            -- (0.2699725130655336,0.8289297304473909)
            -- (0.3152374660659968,0.7331625240598619)
            -- (0.36050241906645997,0.6552495942514335)
            -- (0.40576737206692315,0.5902880236091448)
            -- (0.45103232506738633,0.5351066885741369)
            -- (0.4962972780678495,0.48754527036619194)
            -- (0.5415622310683127,0.44607038470897)
            -- (0.5868271840687759,0.4095568026590982)
            -- (0.6320921370692391,0.37715575805641366)
            -- (0.6773570900697022,0.3482120345139834)
            -- (0.7226220430701654,0.3222097628087382)
            -- (0.7678869960706286,0.2987358352055257)
            -- (0.8131519490710918,0.27745452082103766)
            -- (0.858416902071555,0.25808942485017483)
            -- (0.9036818550720181,0.24041039360744623)
            -- (0.9489468080724813,0.2242238300427505)
            -- (0.9942117610729445,0.20936541089868707)
            -- (1.0394767140734078,0.1956945271482098)
            -- (1.084741667073871,0.18308998203315546)
            -- (1.1300066200743342,0.17144662100826333)
            -- (1.1752715730747973,0.16067266191770202)
            -- (1.2205365260752605,0.15068755805521658)
            -- (1.2658014790757237,0.14142027150983144)
            -- (1.311066432076187,0.13280786581446496)
            -- (1.35633138507665,0.12479434956798206)
            -- (1.4015963380771133,0.11732971914553801)
            -- (1.4468612910775764,0.11036916069407109)
            -- (1.4921262440780396,0.10387238058662555)
            -- (1.5373911970785028,0.09780304024874521)
            -- (1.582656150078966,0.09212827637950409)
            -- (1.6279211030794292,0.08681829149857793)
            -- (1.6731860560798923,0.08184600276679815)
            -- (1.7184510090803555,0.07718673937352241)
            -- (1.7637159620808187,0.07281798062263198)
            -- (1.808980915081282,0.06871912830007729)
            -- (1.854245868081745,0.06487130805898907)
            -- (1.8995108210822083,0.06125719548051215);
        \end{tikzpicture}
    
        \vspace{-1em}
    }
    \subfigure[$\alpha = 1$]{
        \centering

        \begin{tikzpicture}[>=Stealth, yscale=2]
            % 坐标轴
            \draw[->] (0, 0)--(3, 0) node[below]{$x$};
            \draw[->] (0, 0)--(0, 1.5) node[right]{$y$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[domain=0:2.8, line width=1.5pt] plot (\x, {exp(-1 * \x)});
        \end{tikzpicture}
    
        \vspace{-1em}
    }
    \subfigure[$1 < \alpha \leqslant 2$]{
        \centering

        \begin{tikzpicture}[>=Stealth, xscale=0.5, yscale=3]
            % 坐标轴
            \draw[->] (0, 0)--(6, 0) node[below]{$x$};
            \draw[->] (0, 0)--(0, 1) node[right]{$y$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[line width=1.5pt] (0,0)
            -- (0.0388430882475306,0.21391566852215352)
            -- (0.08410804124799379,0.30084732938851516)
            -- (0.12937299424845697,0.3566078480328057)
            -- (0.17463794724892015,0.39598621849579607)
            -- (0.21990290024938333,0.42468597781303014)
            -- (0.26516785324984654,0.4457122394924387)
            -- (0.3104328062503097,0.4609136924506795)
            -- (0.3556977592507729,0.4715394687928919)
            -- (0.4009627122512361,0.4784881199596494)
            -- (0.44622766525169927,0.48243531656862143)
            -- (0.49149261825216245,0.48390602236862956)
            -- (0.5367575712526257,0.48331836488828284)
            -- (0.5820225242530889,0.48101186015919395)
            -- (0.627287477253552,0.47726641923505264)
            -- (0.6725524302540152,0.4723156361235502)
            -- (0.7178173832544784,0.4663563734682503)
            -- (0.7630823362549416,0.4595558636217946)
            -- (0.8083472892554048,0.45205709023105584)
            -- (0.853612242255868,0.4439829477688432)
            -- (0.8988771952563311,0.43543951211897924)
            -- (0.9441421482567943,0.42651865113880383)
            -- (0.9894071012572575,0.41730013617502326)
            -- (1.0346720542577208,0.40785337006714184)
            -- (1.079937007258184,0.398238816094395)
            -- (1.1252019602586472,0.38850919063497436)
            -- (1.1704669132591103,0.3787104668947015)
            -- (1.2157318662595735,0.3688827259276259)
            -- (1.2609968192600367,0.3590608830039568)
            -- (1.3062617722604999,0.34927531130682954)
            -- (1.351526725260963,0.3395523803641982)
            -- (1.3967916782614263,0.329914923135012)
            -- (1.4420566312618894,0.32038264298181446)
            -- (1.4873215842623526,0.31097246967028747)
            -- (1.5325865372628158,0.30169887189263983)
            -- (1.577851490263279,0.29257413250868514)
            -- (1.6231164432637422,0.2836085916568135)
            -- (1.6683813962642053,0.2748108620479036)
            -- (1.7136463492646685,0.26618802007422976)
            -- (1.7589113022651317,0.2577457758089798)
            -- (1.8041762552655949,0.24948862451437262)
            -- (1.849441208266058,0.24141998189770636)
            -- (1.8947061612665212,0.2335423050395286)
            -- (1.9399711142669844,0.22585720065441814)
            -- (1.9852360672674476,0.21836552212306015)
            -- (2.030501020267911,0.21106745654681552)
            -- (2.0757659732683744,0.20396260291678114)
            -- (2.121030926268838,0.1970500423535516)
            -- (2.1662958792693012,0.19032840125759787)
            -- (2.2115608322697646,0.18379590811017738)
            -- (2.256825785270228,0.17745044457838416)
            -- (2.3020907382706914,0.17128959150318854)
            -- (2.347355691271155,0.16531067028434565)
            -- (2.3926206442716182,0.15951078011940126)
            -- (2.4378855972720817,0.15388683150448296)
            -- (2.483150550272545,0.14843557636110982)
            -- (2.5284155032730085,0.14315363511503745)
            -- (2.573680456273472,0.13803752101945455)
            -- (2.6189454092739353,0.13308366198505694)
            -- (2.6642103622743987,0.1282884201531297)
            -- (2.709475315274862,0.12364810942432564)
            -- (2.7547402682753255,0.11915901113496938)
            -- (2.800005221275789,0.11481738805411393)
            -- (2.8452701742762523,0.11061949685795817)
            -- (2.8905351272767157,0.10656159922335971)
            -- (2.935800080277179,0.10263997166884237)
            -- (2.9810650332776425,0.09885091425952258)
            -- (3.026329986278106,0.09519075828160885)
            -- (3.0715949392785693,0.09165587298242797)
            -- (3.1168598922790327,0.08824267146318353)
            -- (3.162124845279496,0.0849476158037505)
            -- (3.2073897982799595,0.08176722149166654)
            -- (3.252654751280423,0.0786980612210138)
            -- (3.2979197042808863,0.075736768121024)
            -- (3.3431846572813497,0.07288003846892475)
            -- (3.388449610281813,0.07012463393671726)
            -- (3.4337145632822765,0.06746738341718855)
            -- (3.47897951628274,0.06490518447047164)
            -- (3.5242444692832033,0.06243500442883419)
            -- (3.5695094222836667,0.06005388119406715)
            -- (3.61477437528413,0.05775892375882814)
            -- (3.6600393282845936,0.05554731248054298)
            -- (3.705304281285057,0.05341629913395652)
            -- (3.7505692342855204,0.05136320676613061)
            -- (3.7958341872859838,0.04938542937559131)
            -- (3.841099140286447,0.04748043143541136)
            -- (3.8863640932869106,0.045645747278262545)
            -- (3.931629046287374,0.043878980359869355)
            -- (3.9768939992878374,0.04217780241582912)
            -- (4.022158952288301,0.04053995252542105)
            -- (4.067423905288764,0.038963236094797335)
            -- (4.112688858289227,0.037445523770823747)
            -- (4.15795381128969,0.03598475029580613)
            -- (4.203218764290153,0.034578913312394384)
            -- (4.248483717290616,0.03322607212709008)
            -- (4.2937486702910785,0.03192434643999129)
            -- (4.3390136232915415,0.030671915047681363)
            -- (4.3842785762920045,0.029467014525502974)
            -- (4.429543529292467,0.02830793789484916)
            -- (4.47480848229293,0.027193033280544173)
            -- (4.520073435293393,0.026120702562875905)
            -- (4.565338388293856,0.025089400028372757)
            -- (4.610603341294319,0.02409763102298948)
            -- (4.655868294294782,0.023143950610973713)
            -- (4.701133247295245,0.0222269622423262)
            -- (4.746398200295708,0.02134531643143922)
            -- (4.791663153296171,0.020497709449197706)
            -- (4.836928106296634,0.01968288203055343)
            -- (4.882193059297097,0.01889961809933215)
            -- (4.92745801229756,0.018146743511805372)
            -- (4.972722965298023,0.01742312482035004)
            -- (5.017987918298486,0.016727668058329686)
            -- (5.063252871298949,0.016059317547157895)
            -- (5.108517824299412,0.015417054726347884)
            -- (5.153782777299875,0.014799897007209292)
            -- (5.199047730300338,0.0142068966507238)
            -- (5.244312683300801,0.013637139670013976)
            -- (5.289577636301264,0.013089744757713571)
            -- (5.334842589301727,0.012563862238451568)
            -- (5.38010754230219,0.012058673046575987)
            -- (5.4253724953026525,0.01157338772916553)
            -- (5.4706374483031155,0.01110724547430734)
            -- (5.5159024013035785,0.010659513164556657)
            -- (5.561167354304041,0.010229484455438163)
            -- (5.606432307304504,0.009816478878799197);
            % 辅助线
            \draw[dashed] (0.49149261825216245,0.48390602236862956) -- (0.49149261825216245,0);
        \end{tikzpicture}
    
        \vspace{-1em}
    }
    \subfigure[$\alpha > 2$]{
        \centering

        \begin{tikzpicture}[>=Stealth, xscale=0.4, yscale=1]
            % 坐标轴
            \draw[->] (0, 0)--(8, 0) node[below]{$x$};
            \draw[->] (0, 0)--(0, 3) node[right]{$y$};
            \node at (0, 0) [below left] {$O$};
            % 曲线
            \draw[line width=1.5pt] (0,0)
            -- (0.0388430882475306,0.005539430126623676)
            -- (0.08410804124799379,0.016869119726372006)
            -- (0.12937299424845697,0.03075695004833519)
            -- (0.17463794724892015,0.04610281355797881)
            -- (0.21990290024938333,0.06225978547755374)
            -- (0.26516785324984654,0.07879237180892762)
            -- (0.3104328062503097,0.09538848732443776)
            -- (0.3556977592507729,0.11181702163195427)
            -- (0.4009627122512361,0.12790392957267724)
            -- (0.44622766525169927,0.1435173232982536)
            -- (0.49149261825216245,0.15855749194796478)
            -- (0.5367575712526257,0.17294986111948335)
            -- (0.5820225242530889,0.1866398246970186)
            -- (0.627287477253552,0.19958883206652825)
            -- (0.6725524302540152,0.21177135261457655)
            -- (0.7178173832544784,0.22317247444468516)
            -- (0.7630823362549416,0.2337859747014509)
            -- (0.8083472892554048,0.24361274898463992)
            -- (0.853612242255868,0.2526595197122214)
            -- (0.8988771952563311,0.26093776490486215)
            -- (0.9441421482567943,0.26846282370518704)
            -- (0.9894071012572575,0.27525314539145906)
            -- (1.0346720542577208,0.28132965616220273)
            -- (1.079937007258184,0.28671522348468215)
            -- (1.1252019602586472,0.29143420192064906)
            -- (1.1704669132591103,0.2955120474701052)
            -- (1.2157318662595735,0.29897498988194093)
            -- (1.2609968192600367,0.3018497542591264)
            -- (1.3062617722604999,0.3041633247696646)
            -- (1.351526725260963,0.30594274445879316)
            -- (1.3967916782614263,0.30721494611282857)
            -- (1.4420566312618894,0.3080066099020907)
            -- (1.4873215842623526,0.30834404416799227)
            -- (1.5325865372628158,0.30825308624669256)
            -- (1.577851490263279,0.3077590206608766)
            -- (1.6231164432637422,0.30688651237936415)
            -- (1.6683813962642053,0.3056595531547009)
            -- (1.7136463492646685,0.3041014192121294)
            -- (1.7589113022651317,0.30223463878767287)
            -- (1.8041762552655949,0.3000809682051366)
            -- (1.849441208266058,0.29766137534697595)
            -- (1.8947061612665212,0.29499602951652015)
            -- (1.9399711142669844,0.2921042968125156)
            -- (1.9852360672674476,0.2890047402442579)
            -- (2.030501020267911,0.2857151239091079)
            -- (2.0757659732683744,0.2822524206359354)
            -- (2.121030926268838,0.27863282256964483)
            -- (2.1662958792693012,0.27487175423483223)
            -- (2.2115608322697646,0.2709838876719474)
            -- (2.256825785270228,0.2669831592881086)
            -- (2.3020907382706914,0.26288278810777366)
            -- (2.347355691271155,0.2586952951465388)
            -- (2.3926206442716182,0.25443252366503355)
            -- (2.4378855972720817,0.2501056600897431)
            -- (2.483150550272545,0.24572525541407483)
            -- (2.5284155032730085,0.24130124691649868)
            -- (2.573680456273472,0.23684298005347248)
            -- (2.6189454092739353,0.23235923040341938)
            -- (2.6642103622743987,0.22785822555451996)
            -- (2.709475315274862,0.22334766684374355)
            -- (2.7547402682753255,0.2188347508675787)
            -- (2.800005221275789,0.21432619069651165)
            -- (2.8452701742762523,0.209828236735596)
            -- (2.8905351272767157,0.20534669718260298)
            -- (2.935800080277179,0.20088695804335652)
            -- (2.9810650332776425,0.19645400267105934)
            -- (3.026329986278106,0.19205243080278925)
            -- (3.0715949392785693,0.18768647707199007)
            -- (3.1168598922790327,0.1833600289807682)
            -- (3.162124845279496,0.1790766443201977)
            -- (3.2073897982799595,0.17483956803071277)
            -- (3.252654751280423,0.17065174849805875)
            -- (3.2979197042808863,0.1665158532832517)
            -- (3.3431846572813497,0.16243428428758921)
            -- (3.388449610281813,0.15840919235601628)
            -- (3.4337145632822765,0.15444249132409965)
            -- (3.47897951628274,0.15053587151554895)
            -- (3.5242444692832033,0.1466908126986608)
            -- (3.5695094222836667,0.1429085965112844)
            -- (3.61477437528413,0.13919031836493445)
            -- (3.6600393282845936,0.135536898839534)
            -- (3.705304281285057,0.13194909458096823)
            -- (3.7505692342855204,0.12842750871419692)
            -- (3.7958341872859838,0.12497260078511133)
            -- (3.841099140286447,0.12158469624465877)
            -- (3.8863640932869106,0.11826399548899219)
            -- (3.931629046287374,0.11501058246955706)
            -- (3.9768939992878374,0.11182443288710595)
            -- (4.022158952288301,0.10870542198364336)
            -- (4.067423905288764,0.10565333194625916)
            -- (4.112688858289227,0.10266785893671414)
            -- (4.15795381128969,0.09974861976050327)
            -- (4.203218764290153,0.09689515818894577)
            -- (4.248483717290616,0.09410695094764385)
            -- (4.2937486702910785,0.09138341338441623)
            -- (4.3390136232915415,0.08872390482955352)
            -- (4.3842785762920045,0.08612773366096532)
            -- (4.429543529292467,0.08359416208649474)
            -- (4.47480848229293,0.08112241065536868)
            -- (4.520073435293393,0.07871166251043696)
            -- (4.565338388293856,0.07636106739252742)
            -- (4.610603341294319,0.0740697454079153)
            -- (4.655868294294782,0.07183679056957123)
            -- (4.701133247295245,0.06966127412251717)
            -- (4.746398200295708,0.06754224766328368)
            -- (4.791663153296171,0.06547874606312759)
            -- (4.836928106296634,0.06346979020433656)
            -- (4.882193059297097,0.061514389538616814)
            -- (4.92745801229756,0.059611544476236095)
            -- (4.972722965298023,0.05776024861427243)
            -- (5.017987918298486,0.05595949081200391)
            -- (5.063252871298949,0.054208257121165865)
            -- (5.108517824299412,0.052505532578498444)
            -- (5.153782777299875,0.05085030286771147)
            -- (5.199047730300338,0.04924155585770469)
            -- (5.244312683300801,0.0476782830235992)
            -- (5.289577636301264,0.04615948075686228)
            -- (5.334842589301727,0.044684151570540766)
            -- (5.38010754230219,0.04325130520535973)
            -- (5.4253724953026525,0.04185995964219193)
            -- (5.4706374483031155,0.0405091420261607)
            -- (5.5159024013035785,0.03919788950740345)
            -- (5.561167354304041,0.03792525000329558)
            -- (5.606432307304504,0.03669028288671474)
            -- (5.651697260304967,0.03549205960471344)
            -- (5.69696221330543,0.034329664231763334)
            -- (5.742227166305893,0.03320219396153743)
            -- (5.787492119306356,0.03210875954100667)
            -- (5.832757072306819,0.031048485650444612)
            -- (5.878022025307282,0.03002051123275855)
            -- (5.923286978307745,0.029023989775396126)
            -- (5.968551931308208,0.028058089547915045)
            -- (6.013816884308671,0.027121993798147434)
            -- (6.059081837309134,0.026214900909741268)
            -- (6.104346790309597,0.025336024523718456)
            -- (6.14961174331006,0.024484593626551778)
            -- (6.194876696310523,0.023659852607131847)
            -- (6.240141649310986,0.022861061284869626)
            -- (6.285406602311449,0.022087494911059654)
            -- (6.330671555311912,0.021338444145514567)
            -- (6.375936508312375,0.020613215010371402)
            -- (6.421201461312838,0.019911128822865505)
            -- (6.466466414313301,0.019231522108767655)
            -- (6.511731367313764,0.018573746498084465)
            -- (6.5569963203142265,0.017937168604531102)
            -- (6.6022612733146895,0.01732116989019835)
            -- (6.647526226315152,0.0167251465167534)
            -- (6.692791179315615,0.016148509184434855)
            -- (6.738056132316078,0.015590682960027375)
            -- (6.783321085316541,0.015051107094929945)
            -- (6.828586038317004,0.014529234834363951)
            -- (6.873850991317467,0.01402453321870244)
            -- (6.91911594431793,0.013536482877840827)
            -- (6.964380897318393,0.013064577819470794)
            -- (7.009645850318856,0.01260832521206396)
            -- (7.054910803319319,0.012167245163319292)
            -- (7.100175756319782,0.011740870494778443)
            -- (7.145440709320245,0.011328746513265982)
            -- (7.190705662320708,0.01093043077976678)
            -- (7.235970615321171,0.010545492876310325)
            -- (7.281235568321634,0.010173514171391769)
            -- (7.326500521322097,0.00981408758442142);
            % 辅助线
            \draw[dashed] (1.4873215842623526,0.30834404416799227) -- (1.4873215842623526,0);
        \end{tikzpicture}
    
        \vspace{-1em}
    }

    \caption{伽马分布的概率密度}
    \label{fig:伽马分布}
\end{figure}

\begin{figure}[htbp]
    \centering

    \begin{tikzpicture}
        \centering

        \begin{axis}[
            title={$0 < \alpha < 1$},
            axis lines=center,
            xmin=0, xmax=2.3,
            ymin=0, ymax=2.8,
            xlabel=$x$, ylabel=$y$,
            no markers,
            every axis x label/.style={
                at={(xticklabel* cs:1)},
                anchor=north
            },
            every axis y label/.style={
                at={(yticklabel* cs:1)},
                anchor=east
            },
            tick align=inside,
            every axis plot/.append style={line width=1.5pt},
            extra x ticks={0},
            extra x tick labels={$O$},
            extra x tick style={
                tick label style={anchor=north east}
            }
        ]
            \addplot[smooth, black] table [header=false] {./data/gamma(0.5,1).dat};
            \addplot[smooth, blue] table [header=false] {./data/gamma(0.5,2).dat};
            \addplot[smooth, red] table [header=false] {./data/gamma(0.5,3).dat};
            \legend{{$\alpha=0.5,\lambda=1$}, {$\alpha=0.5,\lambda=2$}, {$\alpha=0.5,\lambda=3$}}
        \end{axis}
    \end{tikzpicture}
    \begin{tikzpicture}
        \centering

        \begin{axis}[
            title={$\alpha = 1$},
            axis lines=center,
            xmin=0, xmax=2.8,
            ymin=0, ymax=3.3,
            xlabel=$x$, ylabel=$y$,
            no markers,
            every axis x label/.style={
                at={(xticklabel* cs:1)},
                anchor=north
            },
            every axis y label/.style={
                at={(yticklabel* cs:1)},
                anchor=east
            },
            tick align=inside,
            every axis plot/.append style={line width=1.5pt},
            extra x ticks={0},
            extra x tick labels={$O$},
            extra x tick style={
                tick label style={anchor=north east}
            }
        ]
            \addplot+[smooth, domain=0:2.6, black] {exp{-x}};
            \addplot+[smooth, domain=0:2.6, blue] {2*exp{-x*2}};
            \addplot+[smooth, domain=0:2.6, red] {3*exp{-x*3}};
            \legend{$\lambda=1$, $\lambda=2$, $\lambda=3$}
        \end{axis}
    \end{tikzpicture}
    \begin{tikzpicture}
        \centering

        \begin{axis}[
            title={$1 < \alpha \leqslant 2$},
            axis lines=center,
            xmin=0, xmax=13.6,
            ymin=0, ymax=0.55,
            xlabel=$x$, ylabel=$y$,
            no markers,
            every axis x label/.style={
                at={(xticklabel* cs:1)},
                anchor=north
            },
            every axis y label/.style={
                at={(yticklabel* cs:1)},
                anchor=east
            },
            tick align=inside,
            every axis plot/.append style={line width=1.5pt},
            extra x ticks={0},
            extra x tick labels={$O$},
            extra x tick style={
                tick label style={anchor=north east}
            }
        ]
            \addplot[smooth, black] table [header=false] {./data/gamma(1.5,1).dat};
            \addplot+[smooth, blue] table [header=false] {./data/gamma(1.5,2).dat};
            \addplot+[smooth, red] table [header=false] {./data/gamma(1.5,3).dat};
            \legend{{$\alpha=1.5,\lambda=1$}, {$\alpha=1.5,\lambda=2$}, {$\alpha=1.5,\lambda=3$}}
        \end{axis}
    \end{tikzpicture}

    \caption{伽马分布的概率密度}
\end{figure}

从图 \ref{fig:伽马分布} 可以看出：
\begin{itemize}
    \item 当 $0 < \alpha < 1$ 时，$f(x)$ 是严格单调下降函数，且在 $x=0$ 处有奇点.
    \item 当 $\alpha = 1$ 时，$f(x)$ 是严格单调下降函数，且 $f(0) = \lambda$.
    \item 当 $1 < \alpha \leqslant 2$ 时，$f(x)$ 是单峰函数，先上凸、后下凸，在 $x = \dfrac{\alpha - 1}{\lambda}$ 处取得最大值.
    \item 当 $\alpha > 2$ 时，$f(x)$ 是单峰函数，先下凸、中间上凸、后下凸，在 $x = \dfrac{\alpha - 1}{\lambda}$ 处取得最大值.
    \item $\alpha$ 越大，$f(x)$ 越近似于正态分布；$\alpha$ 越小，曲线的偏斜程度越严重.
\end{itemize}

\begin{theorem}[][伽马分布的可加性]
    \indent 如果随机变量 $X$ 和 $Y$ 相互独立，且 $X \sim Ga(\alpha_1, \lambda)$，$Y \sim Ga(\alpha_2, \lambda)$，则 $X+Y \sim Ga(\alpha_1 + \alpha_2, \lambda)$.
\end{theorem}

伽马分布的特例：
\begin{enumerate}
    \item 当 $\alpha = 1$ 时，伽马分布 $Ga(1, \lambda)$ 就是指数分布 $Exp(\lambda)$.
    \item 当 $\alpha = \dfrac{n}{2}, \lambda = \dfrac{1}{2}$ 时，伽马分布 $Ga(\dfrac{n}{2}, \dfrac{1}{2})$ 是自由度为 $n$ 的卡方分布 $\chi^2(n)$.
\end{enumerate}

\begin{conclusion}[][泊松分布与伽马分布的关系]
    \indent 若在 $(0,t)$ 时间段内随机事件 $A$ 发生的次数 $N(t)$ 服从参数为 $\lambda t$ 的泊松分布，则 $A$ 第 $n$ 次发生的时间 $S_n$ 服从伽马分布 $Ga(n, \lambda)$.
\end{conclusion}

\begin{proof}
    事件 $\{ S_n \leqslant t \}$ 表示事件 $A$ 第 $n$ 次发生的时间小于等于 $t$，这意味着 $(0,t)$ 时间段内事件 $A$ 发生的次数 $N(t) \geqslant n$，因此 $\{ S_n \leqslant t \} = \{ N(t) \geqslant n \}$.于是 $S_n$ 的分布函数为
    $$
    F(t) = P(S_n \leqslant t) = P(N(t) \geqslant n) = \sum_{k=n}^{\infty} \dfrac{(\lambda t)^k e^{-\lambda t}}{k!}
    $$
    %TODO
\end{proof}

% \section{随机变量的函数的分布}

% \subsection{离散型随机变量的函数的分布}

% 设离散型随机变量 $X$ 的概率分布为
% $$
% P\{X=x_k\}=p_k, \; k=1,2,\cdots
% $$
% $y=g(x)$ 是连续函数，则对于 $X$ 的函数 $Y=g(X)$，有
% $$
% P\{Y=g(x_k)\}=p_k, \; k=1,2,\cdots
% $$
% 如果数值 $g(x_k)(k=1,2,\cdots)$ 中有相等的，就把 $Y$ 取这些相等的数值的概率相加，作为 $Y=g(X)$ 取该值的概率，便可得到 $Y=g(X)$ 的概率分布.

% \begin{example}
%     设随机变量 $X$ 的概率密度为
%     \begin{table}[htbp]
%         \centering

%         \begin{tabular}{c | c c c c c}
%             \hline
%             $X$ & -2 & -1 & 0 & 1 & 2 \\
%             \hline
%             $P$ & 0.2 & 0.1 & 0.3 & 0.2 & 0.2 \\
%             \hline
%         \end{tabular}
%     \end{table}
%     求 $Y=(X+1)^2$ 的概率分布.
% \end{example}

% \begin{solution}
%     随机变量 $Y=(X+1)^2$ 的所有可能取值为 0,1,4,9，且 $Y$ 取每个值的概率为
%     \begin{align*}
%         & P\{Y=0\} = P\{(X+1)^2 = 0\} = P\{X=-1\} = 0.1\\
%         & P\{Y=1\} = P\{(X+1)^2 = 1\} = P\{X=0\} + P\{X=-2\} = 0.5\\
%         & P\{Y=4\} = P\{(X+1)^2 = 4\} = P\{X=1\} = 0.2\\
%         & P\{Y=9\} = P\{(X+1)^2 = 9\} = P\{X=2\} = 0.2
%     \end{align*}
    
%     所以 $Y=(X+1)^2$ 的概率分布为\newline
    
%     \centering
%     \begin{tabular}{c | c c c c}
%         \hline
%         $Y$ & 0 & 1 & 4 & 9 \\
%         \hline
%         $P$ & 0.1 & 0.5 & 0.2 & 0.2 \\
%         \hline
%     \end{tabular}
% \end{solution}

% \subsection{连续型随机变量的函数的分布}

% 求随机变量 $Y=g(X)$ 的分布函数的关键一步是从 $g(X) \leqslant y$ 中解出 $X$ 应满足的不等式.

% \begin{example}
%     设随机变量 $X$ 在区间 $(-1,3)$ 上服从均匀分布，记
%     $$
%     Y=\begin{cases}
%         -1 & X<0 \\
%         0 & X=0 \\
%         1 & X>0
%     \end{cases}
%     $$
%     求随机变量 $Y$ 的概率分布.
% \end{example}

% \begin{solution}
%     $X$ 的概率密度为
%     $$
%     f(x)=\begin{cases}
%         \dfrac{1}{4} & -1 < x < 3\\
%         0 & \text{其他}
%     \end{cases}
%     $$

%     $Y$ 是一个离散型随机变量，可取值为 -1,0,1，且
%     \begin{align*}
%         & P\{Y=-1\} = P\{X<0\} = \int_{-1}^0 \dfrac{1}{4}\text{d}x = \dfrac{1}{4} \\
%         & P\{Y=0\} = P\{X=0\} = 0 \\
%         & P\{Y=1\} = P\{X>0\} = \int_0^3 \dfrac{1}{4}\text{d}x = \dfrac{3}{4}
%     \end{align*}
%     因此，$Y$ 的概率分布为\newline

%     \centering
%     \begin{tabular}{c | c c c}
%         \hline
%         $Y$ & -1 & 0 & 1 \\
%         \hline
%         \rule{0pt}{20pt}$P$ & $\dfrac{1}{4}$ & 0 & $\dfrac{3}{4}$ \\[4pt]
%         \hline
%     \end{tabular}
% \end{solution}

% \begin{example}
%     设随机变量 $X$ 服从标准柯西分布，即 $X$ 的概率密度为
%     $$
%     f_{X}(x) = \dfrac{1}{\pi (1+x^2)}, \; -\infty < x < +\infty
%     $$
%     求随机变量 $Y=\arctan X$ 的概率密度.
% \end{example}

% \begin{solution}
%     $Y$ 的分布函数为
%     $$
%     F_{Y}(y) = P\{Y \leqslant y\} = P\{\arctan X \leqslant y\}
%     $$

%     当 $|y|<\dfrac{\pi}{2}$ 时，$\{\arctan X \leqslant y\}=\{X \leqslant \tan y\}$，于是得 $Y$ 的分布函数 $F_{Y}(y)$ 与 $X$ 的分布函数 $F_{X}(x)$ 之间的关系如下：
%     $$
%     F_{Y}(y) = P\{\arctan X \leqslant y\} = P\{X \leqslant \tan y\} = F_{X}(\tan y)
%     $$
%     因此 $Y$ 的概率密度为
%     $$
%     \begin{aligned}
%         f_{Y}(y) &= \dfrac{\text{d}}{\text{d}y} F_{Y}(y) \\
%         &= \dfrac{\text{d}}{\text{d}y} F_{X}(\tan y) \\
%         &= f_{X}(\tan y) \cdot \sec^2 y \\
%         &= \dfrac{\sec^2 y}{\pi (1+\tan^2 y)} \\
%         &= \dfrac{1}{\pi}
%     \end{aligned}
%     $$

%     当 $y \geqslant \dfrac{\pi}{2}$ 时，事件 $\{\arctan X \leqslant y\}$ 是必然事件，所以 $F_{Y}(y)=1$，从而 $f_{Y}(y)=0$.
%     \vspace{0.5em}

%     当 $y \leqslant -\dfrac{\pi}{2}$ 时，事件 $\{\arctan X \leqslant y\}$ 是不可能事件，所以 $F_{Y}(y)=0$，从而 $f_{Y}(y)=0$. \vspace{0.5em}

%     综上所述，$Y$ 的概率密度为
%     $$
%     f_{Y}(y)=\begin{cases}
%         \dfrac{1}{\pi} & |y| < \dfrac{\pi}{2} \\[0.5em]
%         0 & |y| \geqslant \dfrac{\pi}{2}
%     \end{cases}
%     $$
% \end{solution}

% \begin{theorem} \label{theorem:f(y)}
%     设随机变量 $X$ 的概率密度为 $f_{X}(x), \, -\infty < x < +\infty$，函数 $g(x)$ 是处处可导的严格单调函数，则随机变量 $Y=g(X)$ 的概率密度为
%     $$
%     f_{Y}(y)=\begin{cases}
%         f_{X}(h(y))|h'(y)| & \alpha < y < \beta \\[-0.6em]
%         0 & \text{其他}
%     \end{cases}
%     $$
%     其中 $\alpha = \min(g(-\infty),g(+\infty)), \, \beta = \max(g(-\infty),g(+\infty))$，$h(y)$ 是 $g(x)$ 的反函数.
% \end{theorem}

% \begin{proof}
%     当 $g(x)$ 处处可导且严格单调增加时，它的反函数 $h(y)$ 在区间 $(\alpha,\beta)$ 内也处处可导且严格单调增加，所以当 $y \leqslant \alpha$ 时，$F_{Y}(y)=0$；当 $y \geqslant \beta$ 时，$F_{Y}(y)=1$；当 $\alpha < y < \beta$ 时，有
%     $$
%     F_{Y}(y) = P\{Y \leqslant y\} = P\{g(X) \leqslant y\} = P\{X \leqslant h(y)\} = F_{X}(h(y))
%     $$
%     于是 $Y=g(X)$ 的概率密度为
%     $$
%     f_{Y}(y)=F_{Y}'(y)=\begin{cases}
%         f_{X}(h(y)) h'(y) & \alpha < y < \beta \\
%         0 & \text{其他}
%     \end{cases}
%     $$

%     当 $g(x)$ 处处可导且严格单调减少时，它的反函数 $h(y)$ 在区间 $(\alpha,\beta)$ 内也处处可导且严格单调减少，所以当 $y \leqslant \alpha$ 时，$F_{Y}(y)=0$；当 $y \geqslant \beta$ 时，$F_{Y}(y)=1$；当 $\alpha < y < \beta$ 时，有
%     $$
%     \begin{aligned}
%         F_{Y}(y) &= P\{Y \leqslant y\} \\
%         &= P\{g(X) \leqslant y\} \\
%         &= P\{X \geqslant h(y)\} \\
%         &= 1-P\{X < h(y)\}\\
%         &= 1-F_{X}(h(y))
%     \end{aligned}
%     $$
%     于是 $Y=g(X)$ 的概率密度为
%     $$
%     f_{Y}(y)=F_{Y}'(y)=\begin{cases}
%         -f_{X}(h(y)) h'(y) & \alpha < y < \beta \\
%         0 & \text{其他}
%     \end{cases}
%     $$

%     综上所述，$Y=g(X)$ 的概率密度为
%     $$
%     f_{Y}(y)=\begin{cases}
%         f_{X}(h(y))|h'(y)| & \alpha < y < \beta \\
%         0 & \text{其他}
%     \end{cases}
%     $$
% \end{proof}

% \begin{conclusion}
%     设 $X \sim N(\mu,\sigma^2)$，$Y=aX+b \, (a \not= 0)$，则 $Y \sim N(a \mu + b, a^2 \sigma^2)$.
% \end{conclusion}

% \begin{proof}
%     因为 $X \sim N(\mu,\sigma^2)$，所以 $X$ 的概率密度为
%     $$
%     f_{X}(x) = \dfrac{1}{\sqrt{2\pi} \sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}, \; -\infty < x < +\infty
%     $$

%     由 $y=ax+b$ 解得
%     \begin{gather*}
%         x = h(y) = \dfrac{y-b}{a} \\
%         h'(y) = \dfrac{1}{a}
%     \end{gather*}
%     由定理 \ref{theorem:f(y)} 得 $Y=aX+b$ 的概率密度为
%     $$
%     \begin{aligned}
%         f_{Y}(y) &= \dfrac{1}{|a|} f_{X}(\dfrac{y-b}{a}) \\
%         &= \dfrac{1}{|a|} \dfrac{1}{\sqrt{2\pi}\sigma} e^{-\frac{\left( \frac{y-b}{a}-\mu \right)^2}{2\sigma^2}}\\
%         &= \dfrac{1}{\sqrt{2\pi}|a|\sigma} e^{-\frac{[y-(a\mu+b)]^2}{2 a^2 \sigma^2}}
%     \end{aligned}
%     $$
%     即 $Y \sim N(a \mu + b, a^2 \sigma^2)$.
% \end{proof}

% 特别地，当 $a = \dfrac{1}{\sigma}, b=-\dfrac{\mu}{\sigma}$ 时，有 $Y=\dfrac{X-\mu}{\sigma} \sim N(0,1)$.