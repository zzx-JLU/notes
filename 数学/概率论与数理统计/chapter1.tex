% !TeX root = main.tex

\chapter{随机事件及其概率}

\section{随机试验}

在一定条件下必然出现的现象叫做\textbf{必然现象}.在相同的条件下，可能出现不同的结果，而在试验或观测之前不能预知确切结果的现象叫做\textbf{随机现象}.

随机现象具有随机性和统计规律性.

\begin{itemize}
    \item 随机性：对随机现象进行观测时，不能预先确定其结果.
    \item 统计规律性：对随机现象进行大量重复观测后，其结果往往会表现出某种规律性.
\end{itemize}

为了研究和揭示随机现象的统计规律性，需要对随机现象进行大量重复的观察、测量或试验，统称为试验.

如果试验具有以下特点：
\begin{enumerate}
    \item 可重复性：试验可以在相同条件下重复进行多次，甚至进行无限次；
    \item 可观测性：每次试验的所有可能结果都是明确的、可以观测的，并且试验的可能结果有两个或两个以上；
    \item 随机性：每次试验出现的结果是不确定的，在试验之前无法预先确定究竟会出现哪一个结果，
\end{enumerate}
则称之为\textbf{随机试验}，简称为\textbf{试验}.

通常用字母 $E$ 表示一个随机试验. 随机试验 $E$ 的基本结果称为\textbf{样本点}，用 $\omega$ 表示.随机试验 $E$ 的所有基本结果的集合称为\textbf{样本空间}，用 $\varOmega = \{ \omega \}$ 表示.

\section{随机事件}

\subsection{随机事件的概念}

随机试验 $E$ 的样本空间 $\varOmega = \{ \omega \}$ 的子集称为随机试验 $E$ 的\textbf{随机事件}（random event），简称为\textbf{事件}（event），用大写字母 $A,B,C$ 等表示.

设 $A \subseteq \varOmega$，如果试验结果 $\omega \in A$，则称在这次试验中事件 $A$ 发生；如果 $\omega \notin A$，则称事件 $A$ 不发生.

由一个样本点 $\omega$ 组成的事件称为\textbf{基本事件}.

样本空间 $\varOmega$ 本身也是 $\varOmega$ 的子集，它包含 $\varOmega$ 的所有样本点，在每次试验中 $\varOmega$ 必然发生，称为\textbf{必然事件}.

空集 $\text{\O}$ 也是 $\varOmega$ 的子集，它不包含任何样本点，在每次试验中都不可能发生，称为\textbf{不可能事件}.

在一个样本空间中，如果只有有限个样本点，则称它为\textbf{有限样本空间}；如果有无限个样本点，则称它为\textbf{无限样本空间}.

\subsection{随机事件的关系}

\subsubsection{事件的包含}

如果当事件 $A$ 发生时事件 $B$ 一定发生，则称事件 $B$ \textbf{包含}事件 $A$，记作 $A \subseteq B$.

对于任意事件 $A$，有 $\text{\O} \subseteq A \subseteq \varOmega$.

如果 $A \subseteq B,B \subseteq C$，则 $A\subseteq C$.

\subsubsection{事件的相等}

如果事件 $A$ 和事件 $B$ 相互包含，即 $A \subseteq B$ 且 $B \subseteq A$，则称事件 $A$ 与事件 $B$ \textbf{相等}，记作 $A=B$.

\subsubsection{事件的互不相容}

如果事件 $A$ 和事件 $B$ 在同一次试验中不能同时发生，则称事件 $A$ 与事件 $B$ 是\textbf{互不相容}的，或称事件 $A$ 与事件 $B$ 是\textbf{互斥}的.

任意两个基本事件一定互斥.

\subsubsection{事件的互逆}

如果在每一次试验中事件 $A$ 和事件 $B$ 必有一个且仅有一个发生，则称事件 $A$ 与事件 $B$ 是\textbf{互逆}的或\textbf{对立}的，称其中的一个事件是另一个事件的\textbf{逆事件}，记作 $\overline{A}=B$，或 $\overline{B}=A$.

对于任意事件 $A$，有 $\overline{\overline{A}}=A$.

如果事件 $A$ 与事件 $B$ 互逆，则事件 $A$ 与事件 $B$ 一定互斥. 反之，如果事件 $A$ 与事件 $B$ 互斥，事件 $A$ 与事件 $B$ 不一定互逆.

\subsection{随机事件的运算}

\subsubsection{事件的并}

如果事件 $A$ 和事件 $B$ 至少有一个发生，则这样的一个事件称为事件 $A$ 与事件 $B$ 的\textbf{并事件}或\textbf{和事件}，记作 $A \cup B$.
$$
A \cup B = \{ \omega \mid \omega \in A \;\text{或}\; \omega \in B \}
$$

事件 $A$ 和事件 $B$ 作为样本空间 $\varOmega$ 的子集，并事件 $A \cup B$ 就是子集 $A$ 与 $B$ 的并集.

对于任何事件 $A$ 与 $B$，事件的并运算有如下性质：
\begin{enumerate}
    \item $A \cup A = A$
    \item $A \cup \text{\O} = A$
    \item $A \cup B = B \cup A$
    \item $A \cup \overline{A} = \varOmega$
    \item $A \subseteq A \cup B$
    \item $B \subseteq A \cup B$
    \item 如果 $A \subseteq B$，则有 $A \cup B=B$.
\end{enumerate}

事件的并可以推广到多个事件的情形：
\begin{gather*}
    \bigcup_{i=1}^n A_i = \{ \text{事件} A_1,A_2,\cdots,A_n \text{中至少有一个发生} \} \\
    \bigcup_{i=1}^\infty A_i = \{ \text{事件} A_1,A_2,\cdots,A_n,\cdots \text{中至少有一个发生} \}
\end{gather*}

\subsubsection{事件的交}

如果事件 $A$ 和事件 $B$ 同时发生，则这样的一个事件称为事件 $A$ 与事件 $B$ 的\textbf{交事件}或\textbf{积事件}，记作 $A \cap B$ 或 $AB$.
$$
A \cap B = \{ \omega \mid \omega \in A \;\text{且}\; \omega \in B \}
$$

事件 $A$ 和事件 $B$ 作为样本空间 $\varOmega$ 的子集，交事件 $A \cap B$ 就是子集 $A$ 与 $B$ 的交集.

对于任何事件 $A$ 与 $B$，事件的交运算有如下性质：
\begin{enumerate}
    \item $A \cap A = A$
    \item $A \cap \text{\O} = \text{\O}$
    \item $A \cap B = B \cap A$
    \item $A \cap \overline{A} = \text{\O}$
    \item $A \cap B \subseteq A$
    \item $A \cap B \subseteq B$
    \item 如果 $A \subseteq B$，则有 $A \cap B = A$.
    \item 如果 $A$ 与 $B$ 互不相容，则有 $A \cap B = \text{\O}$.
\end{enumerate}

事件的交可以推广到多个事件的情形：
\begin{gather*}
    \bigcap_{i=1}^n A_i = \{ \text{事件} A_1,A_2,\cdots,A_n \text{同时发生} \}\\
    \bigcap_{i=1}^\infty A_i = \{ \text{事件} A_1,A_2,\cdots,A_n,\cdots \text{同时发生} \}
\end{gather*}

事件 $A$ 与 $B$ 互为对立事件的充要条件是：$A \cap B = \text{\O}$，且 $A \cup B = \varOmega$.

\subsubsection{事件的差}

如果事件 $A$ 发生而事件 $B$ 不发生，则这样的一个事件称为事件 $A$ 与事件 $B$ 的\textbf{差事件}，记作 $A-B$.
$$
A - B = \{ \omega \mid \omega \in A \;\text{且}\; \omega \notin B \}
$$

对于任何事件 $A$ 与 $B$，事件的差运算有如下性质：
\begin{enumerate}
    \item $A - A = \text{\O}$
    \item $A - \text{\O} = A$
    \item $A - B = A - AB = A \overline{B}$
    \item $\varOmega - A = \overline{A}$
    \item $A - \varOmega = \text{\O}$
    \item $(A-B) \cup B = (B-A) \cup A = A \cup B$
    \item $A \cup B = A \cup (B-AB) = B \cup (A-AB)$
    \item $A-B,AB,B-A$ 两两互斥，且 \\
    （1）$A \cup B = (A-B) \cup AB \cup (B-A)$\\
    （2）$A = (A-B) \cup AB$\\
    （3）$B = (B-A) \cup AB$
\end{enumerate}

\subsubsection{随机事件的运算规律}

\begin{enumerate}
    \item 交换律：$A \cup B = B \cup A$，$AB=BA$.
    \item 结合律：$(A \cup B) \cup C = A \cup (B \cup C)$，$(AB)C=A(BC)$.
    \item 分配律：$A(B \cup C)=(AB) \cup (AC)$，$A \cup (BC)=(A \cup B)(A \cup C)$.
    \item 对偶律：$\overline{A \cup B}=\overline{A} \cap \overline{B}$，$\overline{A \cap B}=\overline{A} \cup \overline{B}$.
\end{enumerate}

对于多个随机事件，以上的运算规律也成立.

\subsection{事件域}

\begin{definition}
    设 $\varOmega$ 为样本空间，$\mathcal{F}$ 为 $\varOmega$ 的某些子集组成的集合类.如果 $\mathcal{F}$ 满足：
    \begin{enumerate}
        \item $\varOmega \in \mathcal{F}$；
        \item 若 $A \in \mathcal{F}$，则 $\overline{A} \in \mathcal{F}$；
        \item 若 $A_i \in \mathcal{F}, \, i=1,2,\cdots$，则 $\displaystyle\bigcup_{i=1}^\infty A_i \in \mathcal{F}$，
    \end{enumerate}
    则称 $\mathcal{F}$ 为一个\textbf{事件域}，也称为 $\sigma$ \textbf{域}或 $\sigma$ \textbf{代数}.将 $(\varOmega, \mathcal{F})$ 称为\textbf{可测空间}.
\end{definition}

在可测空间上才可定义概率，这时 $\mathcal{F}$ 中都是有概率可言的事件.

如果样本空间为全体实数，即 $\varOmega = \mathbf{R}$，此时事件域 $\mathcal{F}$ 中的元素无法一一列出，而是由一个基本集合类逐步扩展形成，具体操作如下：
\begin{enumerate}
    \item 取基本集合类 $\mathcal{P}$ 为“全体半直线组成的类”，即
    $$
    \mathcal{P} = \{ (-\infty, x) \mid -\infty < x < +\infty \}
    $$
    \item 把有限的左闭右开区间扩展进来
    $$
    [a,b) = (-\infty,b) - (-\infty,a), \, a,b \in \mathbf{R}
    $$
    \item 把闭区间、单点集、左开右闭区间、开区间扩展进来
    $$
    \begin{aligned}
        & [a,b] = \bigcap_{i=1}^{\infty} \Big[ a, b + \dfrac{1}{i} \Big) \\
        & \{ b \} = [a,b] - [a,b) \\
        & (a,b] = [a,b] - \{ a \} \\
        & (a,b) = [a,b) - \{ a \}
    \end{aligned}
    $$
    \item 最后用（有限个或可列个）并运算和交运算把实数集中一切有限集、可列集、开集、闭集都扩展进来.
\end{enumerate}

经过上述几步扩展所得集合的全体就是事件域 $\mathcal{F}$，这样的事件域 $\mathcal{F}$ 又称为\textbf{博雷尔事件域}，域中的每个元素称为\textbf{博雷尔集}，或称为\textbf{可测集}，这种可测集都是有概率可言的事件.

可测空间 $(\varOmega, \mathcal{F})$ 的性质：
\begin{enumerate}
    \item $\text{\O} \in \mathcal{F}$
    \item 若 $A_i \in \mathcal{F}, \, i=1,2,\cdots$，则 $\displaystyle\bigcap_{i=1}^{\infty} A_i \in \mathcal{F}$.
    \item 若 $A_i \in \mathcal{F}, \, i=1,2,\cdots,n$，则 $\displaystyle\bigcap_{i=1}^n A_i \in \mathcal{F}$.
    \item 若 $A,B \in \mathcal{F}$，则 $A-B \in \mathcal{F}$.
\end{enumerate}

\section{随机事件的概率}

\subsection{频率}

\begin{definition}
    设在相同的条件下进行的 $n$ 次试验中，事件 $A$ 发生了 $n_A$ 次，则称 $n_A$ 为事件 $A$ 发生的\textbf{频数}，称比值 $\dfrac{n_A}{n}$ 为事件 $A$ 发生的\textbf{频率}，记作 $f_n(A)$，即
    $$
    f_n(A)=\dfrac{n_A}{n}
    $$
\end{definition}

事件 $A$ 发生的频率反映了事件 $A$ 在 $n$ 次试验中发生的频繁程度.频率越大，表明事件 $A$ 的发生越频繁，从而可知事件 $A$ 在一次试验中发生的可能性越大.

\setcounter{propertyname}{0}

\begin{property}[（非负性）]
    对于任意事件 $A$，有 $f_n(A) \geqslant 0$.
\end{property}

\begin{property}[（规范性）]
    对于必然事件 $\varOmega$，有 $f_n(\varOmega)=1$.
\end{property}

\begin{property}[（有限可加性）]
    对于两两互不相容的事件 $A_1,A_2,\cdots,A_m$（即当 $i\not=j$ 时，有 $A_i A_j = \text{\O}$，$i,j=1,2,\cdots,m$），有
    $$
    f_n(\bigcup_{i=1}^m A_i) = \sum_{i=1}^m f_n(A_i)
    $$
\end{property}

在相同的条件下重复进行 $n$ 次试验，当 $n$ 增大时，事件 $A$ 发生的频率 $f_n(A)$ 呈现出稳定性，逐渐稳定于某一常数 $p$.用这一常数表示事件 $A$ 发生的可能性大小，称为事件 $A$ 的概率，记为 $P(A)$，即 $P(A)=p$.

当 $n$ 很大时，可以用频率 $f_n(A)$ 作为概率 $P(A)$ 的近似值.

\subsection{概率}

\begin{definition} \label{def:probability}
    设 $\varOmega$ 为一个样本空间，$\mathcal{F}$ 为 $\varOmega$ 的某些子集组成的事件域.如果对于任一事件 $A \in \mathcal{F}$，定义在 $\mathcal{F}$ 上的一个实值函数 $P(A)$ 满足：
    \begin{enumerate}
        \item 非负性：对于任意事件 $A \in \mathcal{F}$，有 $P(A) \geqslant 0$；
        \item 规范性：对于必然事件 $\varOmega$，有 $P(\varOmega)=1$；
        \item 可列可加性：对于两两互不相容的事件 $A_1,A_2,\cdots$，有
        $$
        P(\bigcup_{i=1}^\infty A_i) = \sum_{i=1}^\infty P(A_i)
        $$
    \end{enumerate}
    则称集合函数 $P$ 为可测空间 $(\varOmega, \mathcal{F})$ 上的\textbf{概率}（probability），$P(A)$ 为事件 $A$ 的\textbf{概率}，$(\varOmega, \mathcal{F}, P)$ 为\textbf{概率空间}.
\end{definition}

\setcounter{propertyname}{0}

\begin{property} \label{prop:probability:0}
    对于不可能事件 $\text{\O}$，有 $P(\text{\O})=0$.
\end{property}

\begin{myproof}
    因为 $\text{\O} = \text{\O} \cup \text{\O} \cup \cdots$，根据概率的可列可加性，有
    $$
    P(\text{\O}) = P(\text{\O}) + P(\text{\O}) + \cdots
    $$

    由概率的非负性知 $P(\text{\O}) \geqslant 0$，因此 $P(\text{\O})=0$.
\end{myproof}

\begin{property}[（有限可加性）] \label{prop:probability:sum}
    对于两两互不相容的事件 $A_1,A_2,\cdots,A_n$，有
    \[
    P(\bigcup_{i=1}^n A_i) = \sum_{i=1}^n P(A_i)
    \]
\end{property}

\begin{myproof}
    令 $A_i = \text{\O} \;(i=n+1,n+2,\cdots)$，根据概率的可列可加性及性质\ref*{prop:probability:0}，有
    \[
    P(\bigcup_{i=1}^n A_i) = P(\bigcup_{i=1}^\infty A_i) = \sum_{i=1}^\infty P(A_i) = \sum_{i=1}^n P(A_i)
    \]
\end{myproof}

\begin{property} \label{prop:probability:converse}
    对于任一事件 $A$，有 $P(\overline{A})=1-P(A)$.
\end{property}

\begin{myproof}
    因为 $A \cup \overline{A} = \varOmega$，且 $A \overline{A} = \text{\O}$，由性质 \ref*{prop:probability:sum} 及概率的规范性，得
    $$
    P(\varOmega) = P(A \cup \overline{A}) = P(A) + P(\overline{A}) = 1
    $$
    即
    \[
    P(\overline{A})=1-P(A)
    \]
\end{myproof}

\begin{property} \label{prop:probability:subset}
    如果 $A \subseteq B$，则有 $P(B-A)=P(B)-P(A)$，$P(A) \leqslant P(B)$.
\end{property}

\begin{myproof}
    因为 $A \subseteq B$，从而有 $B = A \cup (B-A)$，且 $A(B-A)=\text{\O}$，由性质 \ref*{prop:probability:sum} 可得
    $$
    P(B) = P(A \cup (B-A)) = P(A) + P(B-A)
    $$
    所以
    $$
    P(B-A)=P(B)-P(A)
    $$
    由于 $P(B-A) \geqslant 0$，因此 $P(A) \leqslant P(B)$.
\end{myproof}

\begin{property} \label{prop:probability:<=1}
    对于任一事件 $A$，有 $P(A) \leqslant 1$.
\end{property}

\begin{myproof}
    因为 $A \subseteq \varOmega$，由性质 \ref*{prop:probability:subset} 及概率的规范性，可得
    \[
    P(A) \leqslant P(\varOmega) = 1
    \]
\end{myproof}

\begin{property}[（概率的减法公式）] \label{prop:probability:subtraction}
    对于任意两个事件 $A$ 与 $B$，有
    \begin{equation}
        P(B-A)=P(B)-P(AB)
    \end{equation}
\end{property}

\begin{myproof}
    由于 $B-A=B-AB$，而 $AB \subseteq B$，根据性质 \ref*{prop:probability:subset} 可得
    \[
    P(B-A)=P(B-AB)=P(B)-P(AB)
    \]
\end{myproof}

\begin{property}[（概率的加法公式）] \label{prop:probability:add}
    对于任意两个事件 $A$ 与 $B$，有
    \begin{gather} \label{equation:add}
        P(A \cup B) = P(A) + P(B) - P(AB) \\
        P(A \cup B) \leqslant P(A) + P(B) \nonumber
    \end{gather}
\end{property}

\begin{myproof}
    因为 $A \cup B = A \cup (B-AB)$，且 $A(B-AB)=\text{\O},\, AB \subseteq B$，由性质 \ref*{prop:probability:sum} 及性质 \ref*{prop:probability:subset} 可得
    $$
    \begin{aligned}
        P(A \cup B) &= P(A \cup (B-AB))\\
        &= P(A) + P(B-AB)\\
        &= P(A) + P(B) - P(AB)
    \end{aligned}
    $$

    由于 $P(AB)\geqslant 0$，因此 $P(A \cup B) \leqslant P(A) + P(B)$.
\end{myproof}

\begin{property}[（概率的一般加法公式）]
    设 $A_1,A_2,\cdots,A_n$ 是 $n$ 个随机事件，则有
    \begin{align} \label{equation:normal add}
        \begin{split}
            P(\bigcup_{i=1}^n A_i) = & \sum_{i=1}^n P(A_i) - \sum_{1 \leqslant i<j \leqslant n} P(A_i A_j) + \sum_{1 \leqslant i<j<k \leqslant n} P(A_i A_j A_k) + \cdots \\
            & + (-1)^{n-1} P(A_1 A_2 \cdots A_n)
        \end{split}
    \end{align}
\end{property}

\begin{myproof}
    使用数学归纳法.当 $n=2$ 时，式 \eqref{equation:normal add} 即为式 \eqref{equation:add}.

    设式 \eqref{equation:normal add} 对 $n-1$ 成立，则对于 $n$，先对两个事件 $A_1 \cup A_2 \cup \cdots \cup A_{n-1}$ 与 $A_n$ 应用式 \eqref{equation:add}：
    $$
    \begin{aligned}
        & P(A_1 \cup A_2 \cup \cdots \cup A_n) \\
        =\ & P(A_1 \cup A_2 \cup \cdots \cup A_{n-1}) + P(A_n) - P((A_1 \cup A_2 \cup \cdots \cup A_{n-1}) A_n) \\
        =\ & P(A_1 \cup A_2 \cup \cdots \cup A_{n-1}) + P(A_n) - P((A_1 A_n) \cup (A_2 A_n) \cup \cdots \cup (A_{n-1} A_n))
    \end{aligned}
    $$
    由归纳假设，将 $P(A_1 \cup A_2 \cup \cdots \cup A_{n-1})$ 和 $P((A_1 A_n) \cup (A_2 A_n) \cup \cdots \cup (A_{n-1} A_n))$ 展开，得
    $$
    \begin{aligned}
        \begin{split}
            & P(A_1 \cup A_2 \cup \cdots \cup A_n) \\
            =\ & \left[ \sum_{i=1}^{n-1} P(A_i) - \sum_{1 \leqslant i<j \leqslant n-1} P(A_i A_j) + \sum_{1 \leqslant i<j<k \leqslant n-1} P(A_i A_j A_k) + \cdots + (-1)^{n-2} P(A_1 A_2 \cdots A_{n-1}) \right] \\
            & + P(A_n) - \Bigg[ \sum_{i=1}^{n-1} P(A_i A_n) - \sum_{1 \leqslant i<j \leqslant n-1} P((A_i A_n) (A_j A_n)) \\
            & + \sum_{1 \leqslant i<j<k \leqslant n-1} P((A_i A_n) (A_j A_n) (A_k A_n)) + \cdots + (-1)^{n-2} P((A_1 A_n) (A_2 A_n) \cdots (A_{n-1} A_n)) \Bigg] \\
            =\ & \sum_{i=1}^{n} P(A_i) - \sum_{1 \leqslant i<j \leqslant n-1} P(A_i A_j) + \sum_{1 \leqslant i<j<k \leqslant n-1} P(A_i A_j A_k) + \cdots + (-1)^{n-2} P(A_1 A_2 \cdots A_{n-1}) \\
            & - \sum_{i=1}^{n-1} P(A_i A_n) + \sum_{1 \leqslant i<j \leqslant n-1} P(A_i A_j A_n) - \sum_{1 \leqslant i<j<k \leqslant n-1} P(A_i A_j A_k A_n) + \cdots \\
            & + (-1)^{n-1} P(A_1 A_2 \cdots A_n) \\
            =\ & \sum_{i=1}^n P(A_i) - \sum_{1 \leqslant i<j \leqslant n} P(A_i A_j) + \sum_{1 \leqslant i<j<k \leqslant n} P(A_i A_j A_k) + \cdots + (-1)^{n-1} P(A_1 A_2 \cdots A_n)
        \end{split}
    \end{aligned}
    $$
    因此式 \eqref{equation:normal add} 对 $n$ 也成立，归纳法完成.
\end{myproof}

\begin{corollary}[（半可加性）]
    设 $A_1,A_2,\cdots,A_n$ 是 $n$ 个随机事件，则有
    $$
    P(\bigcup_{i=1}^n A_i) \leqslant \sum_{i=1}^n P(A_i)
    $$
\end{corollary}

\begin{problem}
    设 $A$ 和 $B$ 是同一试验 $E$ 的两个随机事件，证明
    $$
    1 - P(\overline{A}) - P(\overline{B}) \leqslant P(AB) \leqslant P(A \cup B)
    $$
\end{problem}

\begin{myproof}
    因为 $AB \subseteq A \subseteq (A \cup B)$，所以
    $$
    P(AB) \leqslant P(A \cup B)
    $$
    由概率的性质 \ref*{prop:probability:add}、性质 \ref*{prop:probability:converse} 及事件的对偶律，可得
    $$
    P(\overline{A}) + P(\overline{B}) \geqslant P(\overline{A} \cup \overline{B}) = P(\overline{AB}) = 1 - P(AB)
    $$
    因此
    $$
    1 - P(\overline{A}) - P(\overline{B}) \leqslant P(AB)
    $$
\end{myproof}

\subsection{古典概型}

如果随机试验具有以下两个特点：
\begin{enumerate}
    \item 试验的样本空间只包含有限个样本点；
    \item 在试验中每个基本事件发生的可能性相同，
\end{enumerate}
则称这种试验为\textbf{等可能概型}或\textbf{古典概型}（classic probability model）.

设试验 $E$ 是古典概型，样本空间为 $\varOmega=\{\omega_1,\omega_2,\cdots,\omega_n\}$，则基本事件 $\{\omega_1\},\{\omega_2\},\cdots,\{\omega_n\}$ 两两互不相容，且
$$
\varOmega = \{\omega_1\} \cup \{\omega_2\} \cup \cdots \cup \{\omega_n\}
$$
由于 $P(\varOmega)=1$ 及 $P(\{\omega_1\})=P(\{\omega_2\})=\cdots=P(\{\omega_n\})$，因此
$$
P(\{\omega_1\})=P(\{\omega_2\})=\cdots=P(\{\omega_n\})=\dfrac{1}{n}
$$

如果事件 $A$ 包含 $k$ 个基本事件，$A=\{\omega_{i_1}\} \cup \{\omega_{i_2}\} \cup \cdots \cup \{\omega_{i_k}\}$，其中 $i_1,i_2,\cdots,i_k$ 是 $1,2,\cdots,n$ 中某 $k$ 个不同的数，则有
$$
P(A) = P(\{\omega_{i_1}\}) + P(\{\omega_{i_2}\}) + \cdots + P(\{\omega_{i_k}\}) = \dfrac{k}{n}
$$
即
$$
P(A)=\dfrac{A\,\text{包含的基本事件个数}}{\varOmega\,\text{包含的基本事件总数}}
$$

\subsection{几何概型}

如果随机试验是将一个点随机地投到某一区域 $\varOmega$ 内，而这个随机点落在 $\varOmega$ 中任意两个度量相等的子区域内的可能性是一样的，则称这样的试验属于\textbf{几何概型}（geometric probability model）.

\begin{note}
    $\varOmega$ 可以是直线上的某一区间，也可以是平面或空间内的某一区域.区域的度量是指直线上区间的长度，或者平面内区域的面积，或者空间内区域的体积.
\end{note}

对于任何有度量的子区域 $A \subseteq \varOmega$，定义事件 $A = \text{“随机点落在区域}\, A \,\text{内”}$ 的概率为
$$
P(A)=\dfrac{A\,\text{的度量}}{\varOmega\,\text{的度量}}
$$

\begin{problem}[(蒲丰投针问题)]
    在平面上画有等距离的平行线，平行线间的距离为 $2a \, (a>0)$.向该平面任意投掷一枚长为 $2l \, (l<a)$ 的圆柱形的针，求此针与任一平行线相交的概率.
\end{problem}

\begin{solution}
    \begin{wrapfigure}[5]{r}{0.4\textwidth}
        \centering
        \vspace{-1em}
        \setlength{\abovecaptionskip}{0cm}

        \begin{tikzpicture}[>=Stealth]
            \def\xscale{0.5}
            \def\yscale{0.4}
            % 两条平行线
            \draw (0, 0)--(10*\xscale, 0);
            \draw (0, 6*\yscale)--(10*\xscale, 6*\yscale);
            % 平行线间距
            \draw[<->] (1*\xscale, 0) --node[left]{$2a$} (1*\xscale, 6*\yscale);
            % 定义针的中点
            \coordinate (m) at (5.5*\xscale, 2*\yscale);
            \fill (m) circle (2pt);
            % 定义交点
            \coordinate (a) at (3.5*\xscale, 0);
            \coordinate (b) at (10*\xscale, 0);
            % 针
            \draw (3*\xscale, -0.5*\yscale) --node[left]{$l$}
                (m) node[left]{$M$}
                --node[left]{$l$}
                (8*\xscale, 4.5*\yscale);
            % 针的中点到平行线的距离
            \draw (m) --node[right]{$x$} (5.5*\xscale, 0);
            % 角度标注
            \pic["$\varphi$", draw=black, -, angle eccentricity=1.6, angle radius=0.4cm]
                {angle=b--a--m};
        \end{tikzpicture}
        
        \caption{}
        \label{fig:pufeng:1}
    \end{wrapfigure}
    针投在该平面上，设 $x$ 为针的中点 $M$ 到最近的一条平行线的距离，$\varphi$ 为针与此直线的交角，如图 \ref{fig:pufeng:1} 所示，则有 $0 \leqslant x \leqslant a, \; 0 \leqslant \varphi \leqslant \pi$.因此样本空间为
    $$
    \varOmega = \{(\varphi,x) \mid 0 \leqslant \varphi \leqslant \pi, \, 0 \leqslant x \leqslant a\}
    $$

    \begin{wrapfigure}[6]{r}{0.5\textwidth}
        \centering
        \vspace{-1.5em}
        \setlength{\abovecaptionskip}{0cm}

        \begin{tikzpicture}[xscale=1.5, >=Stealth]
            % 坐标轴
            \draw[->] (-0.3, 0)--(4, 0) node[below]{$\varphi$};
            \draw[->] (0, -0.5)--(0, 3) node[left]{$x$};
            \node at (0, 0) [below left] {$O$};
            % 定义特殊点
            \coordinate (a) at (0, 2);
            \coordinate (p) at (pi, 0);
            % 矩形
            \draw  (a) node[left]{$a$} rectangle (p) node[below]{$\pi$};
            % 矩形右上角
            \node at (pi, 2) [below left] {$\varOmega$};
            % 曲线
            \draw[domain=0:pi, fill=lightgray] plot (\x, {sin(\x r)});
            \node at (pi/2, 1) [above] {$x=l \sin \varphi$};
            \node at (pi/2, 1/2) {$A$};
        \end{tikzpicture}
        
        \caption{}
        \label{fig:pufeng:2}
    \end{wrapfigure}

    针与最近的一条平行线相交的充分必要条件是 $x \leqslant l \sin \varphi$.设事件 $A=$ “针与最近的一条平行线相交”，则
    $$
    A = \{(\varphi,x) \mid 0 \leqslant \varphi \leqslant \pi, \, 0 \leqslant x \leqslant l \sin \varphi\}
    $$

    所求概率为
    \begin{equation} \label{equation:pufeng}
        p = \dfrac{A\, \text{的面积}}{\varOmega \, \text{的面积}} = \dfrac{\displaystyle\int_0^{\pi} l \sin\varphi \, \text{d} \varphi}{\pi a} = \dfrac{2l}{\pi a}
    \end{equation}
\end{solution}

蒲丰投针问题可以用来计算 $\pi$ 的近似值.如果投针 $N$ 次，其中针与平行线相交 $n$ 次，当 $N$ 很大时，以频率 $\dfrac{n}{N}$ 作为概率 $p$ 的近似值，代入式 \eqref{equation:pufeng} 可得
$$
\pi \approx \dfrac{2lN}{an}
$$

\section{条件概率}

\subsection{条件概率与乘法公式}

\begin{definition}
    设 $A$ 和 $B$ 是试验 $E$ 的两个事件，且 $P(A)>0$，称 $\dfrac{P(AB)}{P(A)}$ 为在事件 $A$ 已经发生的条件下，事件 $B$ 发生的\textbf{条件概率}（conditional probability），记为 $P(B \mid A)$，即
    $$
    P(B \mid A)=\dfrac{P(AB)}{P(A)}
    $$
\end{definition}

概率的\textbf{乘法公式}：对于任意两个事件 $A$ 和 $B$，如果 $P(A)>0$，则有
\begin{align} \label{equation:multiply}
    P(AB)=P(A) \, P(B \mid A)
\end{align}

同样可以在 $P(B)>0$ 时，定义在事件 $B$ 已经发生的条件下，事件 $A$ 发生的条件概率为
$$
P(A \mid B)=\dfrac{P(AB)}{P(B)}
$$

在 $P(A)>0,P(B)>0$ 的条件下，有
$$
P(AB) = P(A) \, P(B \mid A) = P(B) \, P(A \mid B)
$$

条件概率具有如下性质：

\setcounter{propertyname}{0}

\begin{property}[（非负性）]
    对任意事件 $B$，有 $P(B \mid A) \geqslant 0$.
\end{property}

\begin{property}[（规范性）]
    对于必然事件 $\varOmega$，有 $P(\varOmega \mid A)=1$.
\end{property}

\begin{property}[（可列可加性）]
    对于两两互不相容的事件 $B_1,B_2,\cdots$，有
    $$
    P(\left( \bigcup_{i=1}^\infty B_i \right) \mid A)=\sum_{i=1}^\infty P(B_i \mid A)
    $$
\end{property}

可由条件概率的三个基本性质推导出其他性质，例如：
\begin{enumerate}
    \item $P(\text{\O} \mid A) = 0$
    \item $P(\overline{B} \mid A) = 1 - P(B \mid A)$
    \item $P((B_1 \cup B_2) \mid A) = P(B_1 \mid A) + P(B_2 \mid A) - P(B_1 B_2 \mid A)$
\end{enumerate}

可以把乘法公式推广到有限个事件的交的情况：设 $A_1,A_2,\cdots,A_n$ 是同一试验的事件，且 $P(A_1 A_2 \cdots A_{n-1})>0$，则有
\begin{gather} \label{equation:normal multiply}
    P(A_1 A_2 \cdots A_n) = P(A_1) \, P(A_2 \mid A_1) \, P(A_3 \mid A_1 A_2) \cdots P(A_n \mid A_1 A_2 \cdots A_{n-1})
\end{gather}

\subsection{全概率公式}

设试验 $E$ 的样本空间为 $\varOmega$，事件 $A_1,A_2,\cdots,A_n$ 两两互不相容，且 $\displaystyle\bigcup_{i=1}^n A_i=\varOmega$，则称 $A_1,A_2,\cdots,A_n$ 为样本空间 $\varOmega$ 的一个\textbf{分割}或\textbf{完全事件组}.

\begin{theorem}[（全概率公式）]
    若事件 $A_1,A_2,\cdots,A_n$ 构成一个完全事件组，且 $P(A_i)>0 \ (i=1,2,\cdots,n)$，则对任意事件 $B$，有
    \begin{gather} \label{equation:total}
        P(B) = \sum_{i=1}^n P(A_i) \, P(B \mid A_i)
    \end{gather}
\end{theorem}

\begin{myproof}
    $$
    B = B \varOmega = B \left( \bigcup_{i=1}^n A_i \right) = \bigcup_{i=1}^n(A_i B)
    $$
    这里 $(A_i B) \cap (A_j B) = \text{\O} \ (i\not=j,\; i,j=1,2,\cdots,n)$，由概率的有限可加性得
    $$
    P(B) = P(\bigcup_{i=1}^n (A_i B)) = \sum_{i=1}^n P(A_i B)
    $$
    由乘法公式得
    $$
    P(B) = \sum_{i=1}^n P(A_i) \, P(B \mid A_i)
    $$
\end{myproof}

\subsection{贝叶斯公式}

如果事件 $B$ 是由于在两两互不相容的事件 $A_1,A_2,\cdots,A_n$ 中某一个发生的情况下而发生的，并且知道各个事件 $A_i$ 发生的概率 $P(A_i)$ 以及在事件 $A_i$ 发生的条件下事件 $B$ 发生的条件概率 $P(B \mid A_i)$，则由全概率公式可得事件 $B$ 发生的概率 $P(B)$.我们把事件 $A_1,A_2,\cdots,A_n$ 看做是导致事件 $B$ 发生的原因，$P(A_i)$ 称为\textbf{先验概率}，它反映出各种原因发生的可能性大小.如果在试验中发生了事件 $B$，这一信息有助于探讨事件 $B$ 发生的原因.条件概率 $P(A_i \mid B)$ 称为\textbf{后验概率}，它使得我们在试验之后对各种原因发生的可能性大小有进一步的了解.

\begin{theorem}[（贝叶斯公式）]
    对于任意事件 $A,B$，如果 $P(A)>0, P(B)>0$，则
    \begin{equation}
        P(A \mid B)=\dfrac{P(A) \, P(B \mid A)}{P(B)}
    \end{equation}

    如果事件 $A_1,A_2,\cdots,A_n$ 构成一个完全事件组，且 $P(A_i)>0 \ (i=1,2,\cdots,n)$，则对于任一事件 $B$，如果 $P(B)>0$，有
    \begin{equation} \label{equation:bayes}
        P(A_i \mid B) = \dfrac{P(A_i) \, P(B \mid A_i)}{\displaystyle\sum_{j=1}^n P(A_j) \, P(B \mid A_j)}
    \end{equation}
\end{theorem}

\begin{myproof}
    如果 $P(A)>0, P(B)>0$，由乘法公式可得
    $$
    P(AB) = P(B) \, P(A \mid B) = P(A) \, P(B \mid A)
    $$
    由此得
    $$
    P(A \mid B)=\dfrac{P(A) \, P(B \mid A)}{P(B)}
    $$

    对于完全事件组中的任一事件 $A_i$，有
    $$
    P(A_i \mid B)=\dfrac{P(A_i) \, P(B \mid A_i)}{P(B)}
    $$
    利用全概率公式，得
    $$
    P(A_i \mid B) = \dfrac{P(A_i) \, P(B \mid A_i)}{\displaystyle\sum_{j=1}^n P(A_j) \, P(B \mid A_j)}
    $$
\end{myproof}

\section{事件的独立性}

\begin{definition} \label{def:event-independence}
    设 $A$ 与 $B$ 是同一试验 $E$ 的两个事件，如果 $P(AB)=P(A)\,P(B)$，则称事件 $A$ 与事件 $B$ 是\textbf{相互独立}的.
\end{definition}

对于同一试验 $E$ 的两个事件 $A$ 与 $B$，如果 $P(A)>0$，则 $A$ 与 $B$ 相互独立的充分必要条件是 $P(B \mid A)=P(B)$；如果 $P(B)>0$，则 $A$ 与 $B$ 相互独立的充分必要条件是 $P(A \mid B)=P(A)$.

\begin{conclusion}
    如果事件 $A$ 与事件 $B$ 相互独立，则事件 $A$ 与事件 $\overline{B}$ 相互独立.
\end{conclusion}

\begin{myproof}
    $A = A (B \cup \overline{B}) = (AB) \cup (A \overline{B})$，而 $(AB)(A \overline{B})=\text{\O}$，所以
    $$
    P(A) = P((AB) \cup (A \overline{B})) = P(AB) + P(A \overline{B})
    $$
    如果 $A$ 与 $B$ 相互独立，则 $P(AB)=P(A)\,P(B)$，代入上式可得
    $$
    P(A) = P(A) \, P(B) + P(A \overline{B})
    $$
    由此得
    $$
    \begin{aligned}
        P(A \overline{B}) &= P(A) - P(A) \, P(B)\\
        &= P(A)[1-P(B)]\\
        &= P(A) \, P(\overline{B})
    \end{aligned}
    $$
    因此事件 $A$ 与事件 $\overline{B}$ 是相互独立的.
\end{myproof}

同理，如果事件 $A$ 与事件 $B$ 相互独立，则事件 $\overline{A}$ 与事件 $B$ 相互独立，事件 $\overline{A}$ 与事件 $\overline{B}$ 相互独立.

\begin{definition} \label{def:independent-of-each-other-3}
    对于同一试验 $E$ 的三个事件 $A,B,C$，如果满足
    \begin{gather*}
        P(AB)=P(A)\,P(B)\\
        P(BC)=P(B)\,P(C)\\
        P(AC)=P(A)\,P(C)
    \end{gather*}
    则称三个事件 $A,B,C$ 是\textbf{两两相互独立}的.
\end{definition}

\begin{definition} \label{def:independent-3}
    如果三个事件 $A,B,C$ 是两两相互独立的，并且有 $P(ABC)=P(A)\,P(B)\,P(C)$，则称三个事件 $A,B,C$ 是\textbf{相互独立}的.
\end{definition}

\begin{definition} \label{def:independent-more}
    设 $A_1,A_2,\cdots,A_n$ 是同一试验 $E$ 的 $n$ 个事件，如果对于任意正整数 $k$ 及这 $n$ 个事件中的任意 $k\,(2\leqslant k\leqslant n)$ 个事件 $A_{i_1},A_{i_2},\cdots,A_{i_k}$，都有等式
    $$
    P(A_{i_1} A_{i_2} \cdots A_{i_k}) = P(A_{i_1}) \, P(A_{i_2}) \cdots P(A_{i_k})
    $$
    则称这 $n$ 个事件 $A_1,A_2,\cdots,A_n$ 是\textbf{相互独立}的.
\end{definition}

若 $n\, (n \geqslant 2)$ 个事件相互独立，则其中任意 $k\, (2 \leqslant k \leqslant n)$ 个事件相互独立.

\section{伯努利概型}

如果将试验 $E$ 重复执行 $n$ 次，在每一次试验中，事件 $A$ 或者发生，或者不发生.假设每次试验的结果互不影响，即在每次试验中事件 $A$ 发生的概率保持不变，不受其他各次试验结果的影响，则称这 $n$ 次试验相互独立.

如果试验 $E$ 只有两个可能的对立结果 $A$ 和 $\overline{A}$，并且 $P(A)=p$，$P(\overline{A})=1-p$，其中 $0<p<1$.将试验 $E$ 独立地重复进行 $n$ 次所构成的一个试验叫做 $n$ \textbf{重伯努利试验}，简称为\textbf{伯努利试验}（Bernoulli experiment）或\textbf{伯努利概型}（Bernoulli probability model）.

$n$ 重伯努利试验的基本事件可记为 $\omega=\omega_1 \omega_2 \cdots \omega_n$，其中 $\omega_i\,(1\leqslant i\leqslant n)$ 为 $A$ 或者为 $\overline{A}$，即 $\omega$ 是从 $A$ 及 $\overline{A}$ 中每次取 1 个，独立地重复取 $n$ 次的一种排列，共有 $2^n$ 个基本事件.

如果 $\omega$ 中有 $k$ 个 $A$，则必有 $n-k$ 个 $\overline{A}$，由独立性可得这一基本事件的概率为 $p^k (1-p)^{n-k}$.

由于在 $2^n$ 个基本事件中共有 $C_n^k$ 个含 $k$ 个 $A$ 及 $n-k$ 个 $\overline{A}$，因此在 $n$ 次独立重复试验中，事件 $A$ 恰好发生 $k$ 次的概率 $P_n(k)$ 为
\begin{gather} \label{equation:binomial}
    P_n(k)=C_n^k p^k (1-p)^{n-k} \quad k=0,1,2,\cdots,n
\end{gather}

由二项式定理可得
$$
\sum_{k=0}^n P_n(k) = \sum_{k=0}^n C_n^k p^k (1-p)^{n-k} = [p+(1-p)]^n = 1
$$
由此可见，$C_n^k p^k (1-p)^{n-k}$ 是二项展开式中的一项，因此式 \eqref{equation:binomial} 又称为\textbf{二项概率公式}.