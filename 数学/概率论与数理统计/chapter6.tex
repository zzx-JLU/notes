\chapter{样本及样本函数的分布}

\section{总体与样本}

\subsection{总体}

在数理统计中，所研究对象的全体称为\textbf{总体}，总体中的每个元素称为\textbf{个体}.

总体中所包含的个体总数叫做\textbf{总体容量}.如果一个总体的容量是有限的，则叫做\textbf{有限总体}，否则叫做\textbf{无限总体}.

在具体问题中，人们关心的往往不是总体的一切方面，而是它的某一项数量指标 $X$ 以及它在总体中的分布情况.如果 $X$ 在总体中的分布情况可以用一个概率分布来表示，那么 $X$ 就可以看成是服从这一概率分布的随机变量.将表示总体的这项数量指标的随机变量 $X$ 可能取的值的全体作为总体，称作总体 $X$，而 $X$ 可能取的每一个数值 $x$ 都是一个个体.

总体 $X$ 的分布函数 $F(x)$ 叫做\textbf{总体的分布函数}，总体 $X$ 的数字特征叫做\textbf{总体的数字特征}.

如果 $X$ 是离散型随机变量，则其概率分布叫做\textbf{离散型总体} $X$ \textbf{的概率分布}；如果 $X$ 是连续型随机变量，则其概率密度叫做\textbf{连续型总体} $X$ \textbf{的概率密度}；并将它们和总体 $X$ 的分布函数统称为\textbf{总体的分布}.

\subsection{简单随机样本}

从总体中抽取若干个个体的过程称为\textbf{抽样}，抽样结果得到总体 $X$ 的一组试验数据（或观测值）称为\textbf{样本}，样本中所含个体的数量称为\textbf{样本容量}.

为了使得样本能很好地反映总体的情况，抽样必须满足以下两个条件：
\begin{enumerate}
    \item 随机性：为了使样本具有充分的代表性，抽样必须是随机的，总体的每一个个体都有同等的机会被抽取到.
    \item 独立性：各次抽取必须是相互独立的，每次抽样的结果既不影响其他各次抽样的结果，也不受其他各次抽样结果的影响.
\end{enumerate}

满足随机性和独立性的抽样方法称为\textbf{简单随机抽样}，由此得到的样本称为\textbf{简单随机样本}.

\begin{itemize}
    \item 从总体中进行放回抽样是简单随机抽样.
    \item 从无限总体中抽取一个个体后不会影响总体的分布，因此从无限总体中进行不放回抽样是简单随机抽样.
    \item 从有限总体中进行不放回抽样，当总体容量 $N$ 很大而样本容量 $n$ 较小时，可以近似看做放回抽样，即可以近似看做简单随机抽样.
\end{itemize}

从总体中抽取容量为 $n$ 的样本，就是对表示总体的随机变量 $X$ 随机地、独立地进行 $n$ 次试验，第 $i$ 次试验的结果可以看做一个随机变量 $X_i \, (i=1,2,\cdots,n)$，$n$ 次试验的结果就是 $n$ 个随机变量 $X_1,X_2,\cdots,X_n$，这些随机变量相互独立，并且与总体 $X$ 服从相同的分布.

\begin{definition}
    设总体 $X$ 是具有某一概率分布的随机变量，如果随机变量 $X_1,X_2,\cdots,X_n$ 相互独立，且都与 $X$ 具有相同的概率分布，则称 $X_1,X_2,\cdots,X_n$ 为来自总体 $X$ 的\textbf{简单随机样本}，简称为\textbf{样本}，$n$ 称为\textbf{样本容量}.在对总体 $X$ 进行一次具体的抽样并做观测后，得到样本 $X_1,X_2,\cdots,X_n$ 的确切数值 $x_1,x_2,\cdots,x_n$，称为\textbf{样本观察值}（或\textbf{观测值}），简称为\textbf{样本值}.
\end{definition}

如果从总体 $X$ 中抽取到样本观测值 $x_1,x_2,\cdots,x_n$，则可以认为是 $n$ 个相互独立的事件 $\{X_1=x_1\}, \{X_2=x_2\}, \cdots, \{X_n=x_n\}$ 同时发生了.

如果把样本容量为 $n$ 的样本看成是 $n$ 维随机变量 $(X_1,X_2,\cdots,X_n)$，则 $(X_1,X_2,\cdots,X_n)$ 所有可能取值的全体是 $n$ 维空间或它的一个子集，样本观测值是其中的一个点 $(x_1,x_2,\cdots,x_n)$.

如果总体 $X$ 的分布函数为 $F_X(t)$，则样本 $X_1,X_2,\cdots,X_n$ 的联合分布函数为
$$
F(t_1,t_2,\cdots,t_n) = F_X(t_1) \, F_X(t_2) \cdots F_X(t_n) = \prod_{i=1}^{n} F_X(t_i)
$$

如果总体 $X$ 是离散型随机变量，其概率分布为 $P \{ X=t \} = p_X(t)$，则样本 $X_1,X_2,\cdots,X_n$ 的联合概率分布为
$$
P \{ X_1=t_1, X_2=t_2, \cdots, X_n=t_n \} = p_X(t_1) \, p_X(t_2) \cdots p_X(t_n) = \prod_{i=1}^n p_X(t_i)
$$

如果总体 $X$ 是连续型随机变量，其概率密度为 $f_X(t)$，则样本 $X_1,X_2,\cdots,X_n$ 的联合概率密度为
$$
f(t_1,t_2,\cdots,t_n) = f_X(t_1) \, f_X(t_2) \cdots f_X(t_n) = \prod_{i=1}^n f_X(t_i)
$$

\section{直方图}

根据总体 $X$ 的样本观测值 $x_1,x_2,\cdots,x_n$ 作直方图的一般步骤为：

\begin{enumerate}
    \item 找出 $x_1,x_2,\cdots,x_n$ 中的最小值 $x_{(1)}$ 和最大值 $x_{(n)}$，选取略小于 $x_{(1)}$ 的数 $a$ 和略大于 $x_{(n)}$ 的数 $b$；

    \item 根据样本容量确定组数 $k$；

    \item 选取分点
    $$
    a = t_0 < t_1 < \cdots < t_{i-1} < t_i < \cdots < t_k = b
    $$
    把区间 $(a,b)$ 分为 $k$ 个子区间
    $$
    (a, t_1], (t_1, t_2], \cdots, (t_{i-1}, t_i], \cdots, (t_{k-1}, b]
    $$
    第 $i$ 个子区间 $(t_{i-1}, t_i]$ 的长度为
    $$
    \Delta t_i = t_i - t_{i-1}, \, i=1,2,\cdots,k
    $$
    各子区间的长度可以相等，也可以不相等.如果取各子区间的长度相等，则有
    $$
    \Delta t_i = \dfrac{b-a}{k}, \, i=1,2,\cdots,k
    $$
    记 $\Delta t = \dfrac{b-a}{k}$，并把 $\Delta t$ 叫做\textbf{组距}.此时分点为
    $$
    t_i = a + i \Delta t, \, i=1,2,\cdots,k
    $$
    为了方便起见，分点 $t_i$ 应比样本观测值 $x_i$ 多取一位有效数字；

    \item 数出 $x_1,x_2,\cdots,x_n$ 落在每个子区间 $(t_{i-1}, t_i]$ 内的频数 $n_i$，再算出频率
    $$
    f_i = \dfrac{n_i}{n}, \, i=1,2,\cdots,k
    $$

    \item 在 $Ox$ 轴上画出各个分点 $t_i(i=0,1,2,\cdots,k)$，并以各子区间 $(t_{i-1}, t_i]$ 为底，以 $y_i = \dfrac{f_i}{\Delta t_i} (i=0,1,2,\cdots,k)$ 为高作小矩形，这样作出的所有小矩形就构成了直方图.
\end{enumerate}

\vspace{0.5em}

第 $i$ 个矩形的面积为
$$
\Delta S_i = \Delta t_i \cdot \dfrac{f_i}{\Delta t_i} = f_i
$$
即第 $i$ 个小矩形的面积等于样本观测值落在该子区间内的频率，因此有
$$
\sum_{i=1}^k \Delta S_i = \sum_{i=1}^k f_i = 1
$$
即所有小矩形的面积的和等于 1.

当样本容量 $n$ 充分大时，随机变量 $X$ 落在第 $i$ 个小区间 $(t_{i-1}, t_i]$ 内的频率近似等于其概率，所以直方图大致反映了总体 $X$ 的概率分布.

\section{样本分布函数}

设总体 $X$ 的分布函数为 $F(x)$，从总体中抽取容量为 $n$ 的样本，样本观测值为 $x_1,x_2,\cdots,x_n$，其中相同的观测值可能重复出现若干次.假设在 $n$ 个样本观测值 $x_1,x_2,\cdots,x_n$ 中有 $k$ 个不相同的值，按由小到大的顺序依次记为 $x_{(1)} < x_{(2)} < \cdots < x_{(k)} \; (k \leqslant n)$，并假设各个 $x_{(i)}$ 出现的频数为 $n_i$，则各个 $x_{(i)}$ 出现的频率为
$$
f_i = \dfrac{n_i}{n}, \, i=1,2,\cdots,k, \, k \leqslant n
$$
显然有
$$
\sum_{i=1}^k n_i = n, \quad \sum_{i=1}^k f_i = 1
$$

设函数
$$
F_n(x) = \begin{cases}
    0 & x < x_{(1)} \\
    \displaystyle\sum_{j=1}^i f_j & x_{(i)} \leqslant x < x_{(i+1)} (i=1,2,\cdots,k-1) \\
    1 & x \geqslant x_{(k)}
\end{cases}
$$
把 $F_n(x)$ 叫做\textbf{样本分布函数}. $F_n(x)$ 的图像如图 \ref{fig:样本分布函数} 所示.

\begin{figure}[htbp]
    \centering

    \begin{tikzpicture}[>=Stealth, scale=4.2]
        % 坐标轴
        \draw[->] (-0.4, 0)--(1.2, 0) node[below]{$x$};
        \draw[->] (0, -0.2)--(0, 1.2) node[right]{$F_n(x)$};
        \node at (0, 0) [above left] {$O$};
        % 辅助线
        \draw[dashed] (-0.3, 0.125) -- (-0.3, 0) node[below]{$\scriptstyle{x_{(1)}}$};
        \draw[dashed] (-0.15, 0.25) -- (-0.15, 0) node[below]{$\scriptstyle{x_{(2)}}$};
        \draw[dashed] (0.1, 0.375) -- (0.1, 0) node[below]{$\scriptstyle{x_{(i)}}$};
        \draw[dashed] (0.3, 0.5) -- (0.3, 0) node[below]{$\scriptstyle{x_{(i+1)}}$};
        \draw[dashed] (0.45, 0.625) -- (0.45, 0);
        \draw[dashed] (0.6, 0.75) -- (0.6, 0);
        \draw[dashed] (0.75, 0.875) -- (0.75, 0);
        \draw[dashed] (0.9, 1) -- (0.9, 0) node[below]{$\scriptstyle{x_{(k)}}$};
        % 曲线
        \draw (-0.3, 0.125) -- (-0.15, 0.125) node[dot]{};
        \draw (-0.15, 0.25) -- (0.1, 0.25) node[dot]{};
        \draw (0.1, 0.375) -- (0.3, 0.375) node[dot]{};
        \draw (0.3, 0.5) -- (0.45, 0.5) node[dot]{};
        \draw (0.45, 0.625) -- (0.6, 0.625) node[dot]{};
        \draw (0.6, 0.75) -- (0.75, 0.75) node[dot]{};
        \draw (0.75, 0.875) -- (0.9, 0.875) node[dot]{};
        \draw (0.9, 1) -- (1.05, 1);
        % 刻度
        \draw (0, 1) node[left]{1} -- (0.05, 1);
    \end{tikzpicture}

    \caption{样本分布函数}
    \label{fig:样本分布函数}
\end{figure}

样本分布函数 $F_n(x)$ 的性质：

\begin{enumerate}
    \item $0 \leqslant F_n(x) \leqslant 1$.
    \item $F_n(x)$ 是单调不减函数.
    \item $F_n(-\infty) = 0$，$F_n(+\infty) = 1$.
    \item $F_n(x)$ 在每个观测值 $x_{(i)}$ 处是右连续的，点 $x_{(i)}$ 是 $F_n(x)$ 的跳跃间断点，$F_n(x)$ 在该点的跃度就是频率 $f_i \, (i=1,2,\cdots,k)$.
\end{enumerate}

对于给定的实数 $x$，当给出总体 $X$ 的不同的样本观测值时，相应的样本分布函数 $F_n(x)$ 的值有可能是不同的，因此 $F_n(x)$ 是一个随机变量.当给定样本观测值 $x_1,x_2,\cdots,x_n$ 时，$F_n(x)$ 是在 $n$ 次独立重复试验中事件 $\{ X \leqslant x \}$ 发生的频率.由于总体 $X$ 的分布函数是事件 $\{ X \leqslant x \}$ 发生的概率，根据伯努利定理可知，当 $n \to \infty$ 时，对于任意给定的正数 $\varepsilon$，有
$$
\lim_{n \to \infty} P \{ |F_n(x) - F(x)| < \varepsilon \} = 1
$$

\begin{theorem}[（格利文科定理）]
    当 $n \to \infty$ 时，样本分布函数 $F_n(x)$ 依概率1关于 $x$ 一致收敛于总体分布函数 $F(x)$，即
    $$
    P \{ \lim_{n \to \infty} \sup_{-\infty < x < +\infty} |F_n(x) - F(x)| = 0 \} = 1
    $$
\end{theorem}

\section{样本函数及其概率分布}

\begin{definition}
    设 $X_1,X_2,\cdots,X_n$ 是来自总体 $X$ 的样本，$x_1,x_2,\cdots,x_n$ 是样本观测值.如果 $g(t_1,t_2,\cdots,t_n)$ 为已知的 $n$ 元函数，则称 $g(X_1,X_2,\cdots,X_n)$ 为\textbf{样本函数}，它是一个随机变量，称 $g(x_1,x_2,\cdots,x_n)$ 为\textbf{样本函数的观测值}.如果样本函数 $g(X_1,X_2,\cdots,X_n)$ 中不含有未知参数，则称这种样本函数为\textbf{统计量}.
\end{definition}

常用的统计量：

\begin{enumerate}
    \item \textbf{样本均值}：$\overline{X} = \dfrac{1}{n} \displaystyle\sum_{i=1}^n X_i$ \\[0.5em]
    观测值：$\overline{x} = \dfrac{1}{n} \displaystyle\sum_{i=1}^n x_i$\\[0.5em]
    设总体 $X$ 具有数学期望 $E(X) = \mu$ 和方差 $D(X) = \sigma^2 (\sigma > 0)$，则 $E(X_i) = \mu$，$D(X_i) = \sigma^2 \, (i=1,2,\cdots,n)$，从而有
    $$
    \begin{aligned}
        & E(\overline{X}) = E(\dfrac{1}{n} \sum_{i=1}^n X_i) = \dfrac{1}{n} \sum_{i=1}^n E(X_i) = \mu \\
        & D(\overline{X}) = D(\dfrac{1}{n} \sum_{i=1}^n X_i) = \dfrac{1}{n^2} \sum_{i=1}^n D(X_i) = \dfrac{\sigma^2}{n}
    \end{aligned}
    $$

    \item 
\end{enumerate}