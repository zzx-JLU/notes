---
title: 概率论与数理统计
chrome:
    format: "A4"
    headerTemplate: '<div></div>'
    footerTemplate: '<div style="width:100%; text-align:center; border-top: 1pt solid #eeeeee; margin: 10px 10px 10px; font-size: 8pt;">
    <span class=pageNumber></span> / <span class=totalPages></span></div>'
    displayHeaderFooter: true
    margin:
        top: '40px'
        bottom: '65px'
        left: '40px'
        right: '40px'
---

<h1>概率论与数理统计</h1>

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [1 随机事件及其概率](#1-随机事件及其概率)
  - [1.1 随机试验](#11-随机试验)
  - [1.2 随机事件](#12-随机事件)
    - [1.2.1 随机事件的概念](#121-随机事件的概念)
    - [1.2.2 随机事件的关系](#122-随机事件的关系)
    - [1.2.3 随机事件的运算](#123-随机事件的运算)
      - [1.2.3.1 事件的并](#1231-事件的并)
      - [1.2.3.2 事件的交](#1232-事件的交)
      - [1.2.3.3 事件的差](#1233-事件的差)
  - [1.3 随机事件的概率](#13-随机事件的概率)
    - [1.3.1 频率](#131-频率)
    - [1.3.2 概率](#132-概率)
    - [1.3.3 古典概型](#133-古典概型)
    - [1.3.4 几何概型](#134-几何概型)
  - [1.4 条件概率](#14-条件概率)
    - [1.4.1 条件概率与乘法公式](#141-条件概率与乘法公式)
    - [1.4.2 全概率公式](#142-全概率公式)
    - [1.4.3 贝叶斯公式](#143-贝叶斯公式)
  - [1.5 事件的独立性](#15-事件的独立性)
  - [1.6 伯努利概型](#16-伯努利概型)
- [2 随机变量及其分布](#2-随机变量及其分布)
  - [2.1 随机变量的分布函数](#21-随机变量的分布函数)
    - [2.1.1 随机变量](#211-随机变量)
    - [2.1.2 分布函数及其性质](#212-分布函数及其性质)
  - [2.2 离散型随机变量及其概率分布](#22-离散型随机变量及其概率分布)
  - [2.3 连续型随机变量及其概率密度](#23-连续型随机变量及其概率密度)
  - [2.4 几种常用的分布](#24-几种常用的分布)
    - [2.4.1 几种常用的离散型随机变量](#241-几种常用的离散型随机变量)
      - [2.4.1.1 （0-1）分布](#2411-0-1分布)
      - [2.4.1.2 二项分布](#2412-二项分布)
      - [2.4.1.3 泊松分布](#2413-泊松分布)
      - [2.4.1.4 几何分布](#2414-几何分布)
    - [2.4.2 均匀分布](#242-均匀分布)
    - [2.4.3 指数分布](#243-指数分布)
    - [2.4.4 正态分布](#244-正态分布)
      - [2.4.4.1 正态分布及其性质](#2441-正态分布及其性质)
      - [2.4.4.2 标准正态分布](#2442-标准正态分布)
      - [2.4.4.3 标准正态分布的上 $\alpha$ 分位点](#2443-标准正态分布的上-alpha-分位点)
  - [2.5 随机变量的函数的分布](#25-随机变量的函数的分布)
    - [2.5.1 离散型随机变量的函数的分布](#251-离散型随机变量的函数的分布)
    - [2.5.2 连续型随机变量的函数的分布](#252-连续型随机变量的函数的分布)
- [3 二维随机变量及其分布](#3-二维随机变量及其分布)
  - [3.1 二维随机变量](#31-二维随机变量)
    - [3.1.1 二维随机变量及其分布函数](#311-二维随机变量及其分布函数)
    - [3.1.2 边缘分布](#312-边缘分布)
    - [3.1.3 随机变量的独立性](#313-随机变量的独立性)
  - [3.2 二维离散型随机变量](#32-二维离散型随机变量)
    - [3.2.1 二维离散型随机变量及其概率分布](#321-二维离散型随机变量及其概率分布)
    - [3.2.2 边缘概率分布](#322-边缘概率分布)
    - [3.2.3 随机变量的独立性](#323-随机变量的独立性)
  - [3.3 二维连续型随机变量](#33-二维连续型随机变量)
    - [3.3.1 二维连续型随机变量及其概率密度](#331-二维连续型随机变量及其概率密度)
    - [3.3.2 边缘概率密度](#332-边缘概率密度)
    - [3.3.3 随机变量的独立性](#333-随机变量的独立性)
    - [3.3.4 二维均匀分布](#334-二维均匀分布)
    - [3.3.5 二维正态分布](#335-二维正态分布)
  - [3.4 条件分布](#34-条件分布)
    - [3.4.1 离散型随机变量的条件分布](#341-离散型随机变量的条件分布)
    - [3.4.2 连续型随机变量的条件分布](#342-连续型随机变量的条件分布)
  - [3.5 二维随机变量的函数的分布](#35-二维随机变量的函数的分布)

<!-- /code_chunk_output -->

# 1 随机事件及其概率

## 1.1 随机试验

如果试验具有以下特点：

1. 可重复性：试验可以在相同条件下重复进行多次，甚至进行无限次；
2. 可观测性：每次试验的所有可能结果都是明确的、可以观测的，并且试验的可能结果有两个或两个以上；
3. 随机性：每次试验出现的结果是不确定的，在试验之前无法预先确定究竟会出现哪一个结果，

则称之为**随机试验**，简称为**试验**.

通常用字母 $E$ 表示一个随机试验. 随机试验 $E$ 的基本结果称为**样本点**，用 $\omega$ 表示. 称随机试验 $E$ 的所有基本结果的集合为**样本空间**，用 $\varOmega=\{\omega\}$ 表示.

## 1.2 随机事件

### 1.2.1 随机事件的概念

随机试验 $E$ 的样本空间 $\varOmega=\{\omega\}$ 的子集称为随机试验 $E$ 的**随机事件**，简称为**事件**，用大写字母 $A,B,C$ 等表示.

设 $A\subseteq\varOmega$，如果试验结果 $\omega\in A$，则称在这次试验中事件 $A$ 发生；如果 $\omega\not\in A$，则称事件 $A$ 不发生.

由一个样本点 $\omega$ 组成的事件称为**基本事件**.

样本空间 $\varOmega$ 本身也是 $\varOmega$ 的子集，它包含 $\varOmega$ 的所有样本点，在每次试验中 $\varOmega$ 必然发生，称为**必然事件**.

空集 $\text{\O}$ 也是 $\varOmega$ 的子集，它不包含任何样本点，在每次试验中都不可能发生，称为**不可能事件**.

在一个样本空间中，如果只有有限个样本点，则称它为**有限样本空间**；如果有无限个样本点，则称它为**无限样本空间**.

### 1.2.2 随机事件的关系

如果当事件 $A$ 发生时事件 $B$ 一定发生，则称事件 $B$ **包含**事件 $A$，记作 $A\subseteq B$.

对于任意事件 $A$，有 $\text{\O}\subseteq A\subseteq\varOmega$.

如果 $A\subseteq B$，$B\subseteq C$，则 $A\subseteq C$.

如果事件 $A$ 和事件 $B$ 相互包含，即 $A\subseteq B$ 且 $B\subseteq A$，则称事件 $A$ 与事件 $B$ **相等**，记作 $A=B$.

如果事件 $A$ 和事件 $B$ 在同一次试验中不能同时发生，则称事件 $A$ 与事件 $B$ 是**互不相容**的，或称事件 $A$ 与事件 $B$ 是**互斥**的.

如果在每一次试验中事件 $A$ 和事件 $B$ 必有一个且仅有一个发生，则称事件 $A$ 与事件 $B$ 是**互逆**的或**对立**的，称其中的一个事件是另一个事件的**逆事件**，记作 $\overline{A}=B$，或 $\overline{B}=A$.

$\overline{\overline{A}}=A$.

### 1.2.3 随机事件的运算

#### 1.2.3.1 事件的并

如果事件 $A$ 和事件 $B$ 至少有一个发生，则这样的一个事件称为事件 $A$ 与事件 $B$ 的**并事件**或**和事件**，记作 $A\cup B$.

$$
A\cup B=\{\omega\,|\,\omega\in A\;或\;\omega\in B\}
$$

事件 $A$ 和事件 $B$ 作为样本空间 $\varOmega$ 的子集，并事件 $A\cup B$ 就是子集 $A$ 与 $B$ 的并集.

对于任何事件 $A$ 与 $B$，有

$$
A\cup A=A\\
A\cup\text{\O}=A\\
A\cup B=B\cup A\\
A\cup\overline{A}=\varOmega\\
A\subseteq A\cup B\\
B\subseteq A\cup B
$$

如果 $A\subseteq B$，则有 $A\cup B=B$.

事件的并可以推广到多个事件的情形：

$$
\bigcup_{i=1}^n A_i=\{事件\;A_1,A_2,\cdots,A_n\;中至少有一个发生\}\\
\bigcup_{i=1}^\infty A_i=\{事件\;A_1,A_2,\cdots,A_n,\cdots 中至少有一个发生\}
$$

#### 1.2.3.2 事件的交

如果事件 $A$ 和事件 $B$ 同时发生，则这样的一个事件称为事件 $A$ 与事件 $B$ 的**交事件**或**积事件**，记作 $A\cap B$ 或 $AB$.

$$
A\cap B=\{\omega\,|\,\omega\in A\;且\;\omega\in B\}
$$

事件 $A$ 和事件 $B$ 作为样本空间 $\varOmega$ 的子集，交事件 $A\cap B$ 就是子集 $A$ 与 $B$ 的交集.

对于任何事件 $A$ 与 $B$，有

$$
A\cap A=A\\
A\cap\text{\O}=\text{\O}\\
A\cap B=B\cap A\\
A\cap\overline{A}=\text{\O}\\
A\cap B\subseteq A\\
A\cap B\subseteq B
$$

如果 $A\subseteq B$，则有 $A\cap B=A$. 如果 $A$ 与 $B$ 互不相容，则有 $A\cap B=\text{\O}$.

事件的交可以推广到多个事件的情形：

$$
\bigcap_{i=1}^n A_i=\{事件\;A_1,A_2,\cdots,A_n\;同时发生\}\\
\bigcap_{i=1}^\infty A_i=\{事件\;A_1,A_2,\cdots,A_n,\cdots 同时发生\}
$$

#### 1.2.3.3 事件的差

如果事件 $A$ 发生而事件 $B$ 不发生，则这样的一个事件称为事件 $A$ 与事件 $B$ 的差事件，记作 $A-B$.

$$
A-B=\{\omega\,|\,\omega\in A\;且\;\omega\not\in B\}
$$

对于任何事件 $A$ 与 $B$，有

$$
A-A=\text{\O}\\
A-\text{\O}=A\\
A-B=A-AB=A\overline{B}\\
\varOmega-A=\overline{A}\\
A-\varOmega=\text{\O}\\
(A-B)\cup B=A\cup B
$$

事件的运算有如下的运算规律：

1. 交换律：$A\cup B=B\cup A$，$AB=BA$.
2. 结合律：$(A\cup B)\cup C=A\cup(B\cup C)$，$(AB)C=A(BC)$.
3. 分配律：$A(B\cup C)=(AB)\cup(AC)$，$A\cup(BC)=(A\cup B)(A\cup C)$.
4. 对偶律：$\overline{A\cup B}=\overline{A}\,\overline{B}$，$\overline{AB}=\overline{A}\cup\overline{B}$.

对于多个随机事件，以上的运算规律也是成立的.

## 1.3 随机事件的概率

### 1.3.1 频率

**定义 1.1**&nbsp;&nbsp;&nbsp;&nbsp;设在相同的条件下进行的 $n$ 次试验中，事件 $A$ 发生了 $n_A$ 次，则称 $n_A$ 为事件 $A$ 发生的**频数**，称比值 $\dfrac{n_A}{n}$ 为事件 $A$ 发生的**频率**，记作 $f_n(A)$，即

$$
f_n(A)=\dfrac{n_A}{n}
$$

事件 $A$ 发生的频率反映了事件 $A$ 在 $n$ 次试验中发生的频繁程度. 频率越大，表明事件 $A$ 的发生越频繁，从而可知事件 $A$ 在一次试验中发生的可能性越大.

频率的基本性质：

1. 非负性：对于任意事件 $A$，有 $f_n(A)\geqslant 0$；
2. 规范性：对于必然事件 $\varOmega$，有 $f_n(\varOmega)=1$；
3. 有限可加性：对于两两互不相容的事件 $A_1,A_2,\cdots,A_m$（即当 $i\not=j$ 时，有 $A_iA_j=\text{\O}$，$i,j=1,2,\cdots,m$），有

$$
f_n(\bigcup_{i=1}^m A_i)=\sum_{i=1}^m f_n(A_i)
$$

在相同的条件下重复进行 $n$ 次试验，当 $n$ 增大时，事件 $A$ 发生的频率 $f_n(A)=\dfrac{n_A}{n}$ 呈现出稳定性，逐渐稳定与某一常数 $p$. 用这一常数表示事件 $A$ 发生的可能性大小，称为事件 $A$ 的概率，记为 $P(A)$，即 $P(A)=p$.

当 $n$ 很大时，可以用频率 $f_n(A)$ 作为概率 $P(A)$ 的近似值.

### 1.3.2 概率

**定义 1.2**&nbsp;&nbsp;&nbsp;&nbsp;设随机试验 $E$ 的样本空间为 $\varOmega$，如果对于 $E$ 的每一个事件 $A$，有唯一的实数 $P(A)$ 和它对应，并且这个事件的函数 $P(A)$ 满足以下条件：

1. 非负性：对于任意事件 $A$，有 $P(A)\geqslant 0$；
2. 规范性：对于必然事件 $\varOmega$，有 $P(\varOmega)=1$；
3. 可列可加性：对于两两互不相容的事件 $A_1,A_2,\cdots$（即当 $i\not=j$ 时，有 $A_iA_j=\text{\O}$，$i,j=1,2,\cdots$），有

$$
P(\bigcup_{i=1}^\infty A_i)=\sum_{i=1}^\infty P(A_i)
$$

则称 $P(A)$ 为事件 $A$ 的**概率**.

**性质 1**&nbsp;&nbsp;&nbsp;&nbsp;对于不可能事件 $\text{\O}$，有 $P(\text{\O})=0$.

> **证明：** 因为 $\text{\O}=\text{\O}\cup\text{\O}\cup\cdots$，根据概率的可列可加性，有
>
> $$
> P(\text{\O})=P(\text{\O})+P(\text{\O})+\cdots
> $$
>
> 由概率的非负性知 $P(\text{\O})\geqslant 0$，因此 $P(\text{\O})=0$.

**性质 2**&nbsp;&nbsp;&nbsp;&nbsp;概率的**有限可加性**：对于两两互不相容的事件 $A_1,A_2,\cdots,A_n$，有

$$
P(\bigcup_{i=1}^n A_i)=\sum_{i=1}^n P(A_i)
$$

> **证明：** 令 $A_i=\text{\O}\,(i=n+1,n+2,\cdots)$，根据概率的可列可加性及性质 1，有
>
> $$
> P(\bigcup_{i=1}^n A_i)=P(\bigcup_{i=1}^\infty A_i)=\sum_{i=1}^\infty P(A_i)=\sum_{i=1}^n P(A_i)
> $$

**性质 3**&nbsp;&nbsp;&nbsp;&nbsp;对于任一事件 $A$，有 $P(\overline{A})=1-P(A)$.

> **证明：** 因为 $A\cup\overline{A}=\varOmega$，且 $A\overline{A}=\text{\O}$，由性质 2 及概率的规范性，得
>
> $$
> P(\varOmega)=P(A\cup\overline{A})=P(A)+P(\overline{A})=1
> $$
>
> 即
>
> $$
> P(\overline{A})=1-P(A)
> $$

**性质 4**&nbsp;&nbsp;&nbsp;&nbsp;如果 $A\subseteq B$，则有 $P(B-A)=P(B)-P(A)$，$P(A)\leqslant P(B)$.

> **证明：** 因为 $A\subseteq B$，从而有 $B=A\cup(B-A)$，且 $A(B-A)=\text{\O}$，由性质 2 可得
>
> $$
> P(B)=P(A\cup(B-A))=P(A)+P(B-A)
> $$
>
> 所以
>
> $$
> P(B-A)=P(B)-P(A)
> $$
>
> 由于 $P(B-A)\geqslant 0$，因此
>
> $$
> P(A)\leqslant P(B)
> $$

**性质 5**&nbsp;&nbsp;&nbsp;&nbsp;对于任一事件 $A$，有 $P(A)\leqslant 1$.

> **证明：** 因为 $A\subseteq\varOmega$，由性质 4 及概率的规范性，可得
>
> $$
> P(A)\leqslant P(\varOmega)=1
> $$

**性质 6**&nbsp;&nbsp;&nbsp;&nbsp;概率的**减法公式**：对于任意两个事件 $A$ 与 $B$，有 $P(B-A)=P(B)-P(AB)$.

> **证明：** 由于 $B-A=B-AB$，而 $AB\subseteq B$，根据性质 4 可得
>
> $$
> P(B-A)=P(B-AB)=P(B)-P(AB)
> $$

**性质 7**&nbsp;&nbsp;&nbsp;&nbsp;对于任意两个事件 $A$ 与 $B$，有

$$
P(A\cup B)=P(A)+P(B)-P(AB)\\
P(A\cup B)\leqslant P(A)+P(B)
$$

> **证明：** 因为 $A\cup B=A\cup(B-AB)$，且 $A(B-AB)=\text{\O},\,AB\subseteq B$，由性质 2 及性质 4 可得
>
> $$
> \begin{aligned}
>     P(A\cup B)&=P(A\cup(B-AB))\\
>     &=P(A)+P(B-AB)\\
>     &=P(A)+P(B)-P(AB)
\end{aligned}
> $$
>
> 由于 $P(AB)\geqslant 0$，因此
>
> $$
> P(A\cup B)\leqslant P(A)+P(B)
> $$

$P(A\cup B)=P(A)+P(B)-P(AB)$ 称为概率的**加法公式**。加法公式可以推广到任意有限个事件的情形：设 $A_1,A_2,\cdots,A_n$ 是 $n$ 个随机事件，则有

$$
\tag{1-1}
\begin{aligned}
    P(\bigcup_{i=1}^n A_i)=&\sum_{i=1}^n P(A_i)-\sum_{1\leqslant i<j\leqslant n}P(A_i A_j)\\
    &+\sum_{1\leqslant i<j<k\leqslant n}P(A_i A_j A_k)+\cdots\\
    &+(-1)^{n-1}P(A_1 A_2\cdots A_n)
\end{aligned}
$$

式 $(1\text{-}1)$ 称为概率的**一般加法公式**.

### 1.3.3 古典概型

如果随机试验具有以下两个特点：

1. 试验的样本空间只包含有限个样本点；
2. 在试验中每个基本事件发生的可能性相同，

则称这种试验为**等可能概型**或**古典概型**.

设试验 $E$ 是古典概型，样本空间为 $\varOmega=\{\omega_1,\omega_2,\cdots,\omega_n\}$，则基本事件 $\{\omega_1\},\{\omega_2\},\cdots,\{\omega_n\}$ 两两互不相容，且

$$
\varOmega=\{\omega_1\}\cup\{\omega_2\}\cup\cdots\cup\{\omega_n\}
$$

由于 $P(\varOmega)=1$ 及 $P(\{\omega_1\})=P(\{\omega_2\})=\cdots=P(\{\omega_n\})$，因此

$$
P(\{\omega_1\})=P(\{\omega_2\})=\cdots=P(\{\omega_n\})=\dfrac{1}{n}
$$

如果事件 $A$ 包含 $k$ 个基本事件，$A=\{\omega_{i_1}\}\cup\{\omega_{i_2}\}\cup\cdots\cup\{\omega_{i_k}\}$，其中 $i_1,i_2,\cdots,i_k$ 是 $1,2,\cdots,n$ 中某 $k$ 个不同的数，则有

$$
P(A)=P(\{\omega_{i_1}\})+P(\{\omega_{i_2}\})+\cdots+P(\{\omega_{i_k}\})=\dfrac{k}{n}
$$

即

$$
P(A)=\dfrac{A\;包含的基本事件个数}{\varOmega\;包含的基本事件总数}
$$

### 1.3.4 几何概型

如果随机试验是将一个点随机地投到某一区域 $\varOmega$ 内，而这个随机点落在 $\varOmega$ 中任意两个度量相等的子区域内的可能性是一样的，则称这样的试验属于**几何概型**.

注：$\varOmega$ 可以是直线上的某一区间，也可以是平面或空间内的某一区域. 区域的度量是指直线上区间的长度，或者平面内区域的面积，或者空间内区域的体积.

对于任何有度量的子区域 $A\subseteq\varOmega$，定义事件 $A=“随机点落在区域\,A\,内”$ 的概率为

$$
P(A)=\dfrac{A\,的度量}{\varOmega\,的度量}
$$

## 1.4 条件概率

### 1.4.1 条件概率与乘法公式

**定义 1.3**&nbsp;&nbsp;&nbsp;&nbsp;设 $A$ 和 $B$ 是试验 $E$ 的两个事件，且 $P(A)>0$，称 $\dfrac{P(AB)}{P(A)}$ 为在事件 $A$ 已经发生的条件下，事件 $B$ 发生的**条件概率**，记为 $P(B|A)$，即

$$
P(B|A)=\dfrac{P(AB)}{P(A)}
$$

对于任意两个事件 $A$ 和 $B$，如果 $P(A)>0$，则有

$$
\tag{1-2}
P(AB)=P(A)\,P(B|A)
$$

式 $(1\text{-}2)$ 称为概率的**乘法公式**.

同样可以在 $P(B)>0$ 时，定义在事件 $B$ 已经发生的条件下，事件 $A$ 发生的条件概率为

$$
P(A|B)=\dfrac{P(AB)}{P(B)}
$$

在 $P(A)>0,P(B)>0$ 的条件下，有

$$
P(AB)=P(A)\,P(B|A)=P(B)\,P(A|B)
$$

条件概率具有如下性质：

1. 非负性：对任意事件 $B$，有 $P(B|A)\geqslant 0$；
2. 规范性：对于必然事件 $\varOmega$，有 $P(\varOmega|A)=1$；
3. 可列可加性：对于两两互不相容的事件 $B_1,B_2,\cdots$，有

$$
P(\Bigg(\bigcup_{i=1}^\infty B_i\Bigg)|A)=\sum_{i=1}^\infty P(B_i|A)
$$

可由条件概率的三个基本性质推导出其他性质，例如

$$
P(\text{\O}|A)=0\\
P(\overline{B}|A)=1-P(B|A)\\
P((B_1\cup B_2)|A)=P(B_1|A)+P(B_2|A)-P(B_1 B_2|A)
$$

可以把乘法公式推广到有限个事件的交的情况：设 $A_1,A_2,\cdots,A_n$ 是同一试验的事件，且 $P(A_1 A_2\cdots A_{n-1})>0$，则有

$$
P(A_1 A_2\cdots A_n)=P(A_1)\,P(A_2|A_1)\,P(A_3|A_1 A_2)\cdots P(A_n|A_1 A_2\cdots A_{n-1})
$$

### 1.4.2 全概率公式

设试验 $E$ 的样本空间为 $\varOmega$，事件 $A_1,A_2,\cdots,A_n$ 两两互不相容，且 $\displaystyle\bigcup_{i=1}^n A_i=\varOmega$，则称 $A_1,A_2,\cdots,A_n$ 为样本空间 $\varOmega$ 的一个**分割**或**完全事件组**.

如果 $P(A_i)>0\,(i=1,2,\cdots,n)$，则对任意事件 $B$，有

$$
B=B\varOmega=B\Bigg(\bigcup_{i=1}^n A_i\Bigg)=\bigcup_{i=1}^n(A_i B)
$$

这里 $(A_i B)\cap(A_j B)=\text{\O}\,(i\not=j,\,i,j=1,2,\cdots,n)$，由概率的有限可加性得

$$
P(B)=P(\bigcup_{i=1}^n(A_i B))=\sum_{i=1}^n P(A_i B)
$$

由乘法公式得

$$
\tag{1-3}
P(B)=\sum_{i=1}^n P(A_i)\,P(B|A_i)
$$

式 $(1\text{-}3)$ 称为**全概率公式**.

### 1.4.3 贝叶斯公式

设试验 $E$ 的样本空间为 $\varOmega$，事件 $A_1,A_2,\cdots,A_n$ 是 $\varOmega$ 的一个分割，且 $P(A_i)>0\,(i=1,2,\cdots,n)$. 对于任一事件 $B$，如果 $P(B)>0$，由乘法公式可得

$$
P(A_i B)=P(B)\,P(A_i|B)=P(A_i)\,P(B|A_i)
$$

由此得

$$
P(A_i|B)=\dfrac{P(A_i)\,P(B|A_i)}{P(B)}
$$

利用全概率公式，得

$$
\tag{1-4}
P(A_i|B)=\dfrac{P(A_i)\,P(B|A_i)}{\displaystyle\sum_{j=1}^n P(A_j)\,P(B|A_j)}
$$

式 $(1\text{-}4)$ 称为**贝叶斯公式**.

## 1.5 事件的独立性

**定义 1.4**&nbsp;&nbsp;&nbsp;&nbsp;设 $A$ 与 $B$ 是同一试验 $E$ 的两个事件，如果 $P(AB)=P(A)\,P(B)$，则称事件 $A$ 与事件 $B$ 是**相互独立**的.

对于同一试验 $E$ 的两个事件 $A$ 与 $B$，如果 $P(A)>0$，则 $A$ 与 $B$ 相互独立的充分必要条件是 $P(B|A)=P(B)$；如果 $P(B)>0$，则 $A$ 与 $B$ 相互独立的充分必要条件是 $P(A|B)=P(A)$.

结论：如果事件 $A$ 与事件 $B$ 相互独立，则事件 $A$ 与事件 $\overline{B}$ 相互独立.

> **证明：**
>
> $$
> A=A(B\cup\overline{B})=(AB)\cup(A\overline{B})
> $$
>
> 而 $(AB)(A\overline{B})=\text{\O}$，所以
>
> $$
> P(A)=P((AB)\cup(A\overline{B}))=P(AB)+P(A\overline{B})
> $$
>
> 如果 $A$ 与 $B$ 相互独立，则 $P(AB)=P(A)\,P(B)$，代入上式可得
>
> $$
> P(A)=P(A)\,P(B)+P(A\overline{B})
> $$
>
> 由此得
>
> $$
> \begin{aligned}
>    P(A\overline{B})&=P(A)-P(A)\,P(B)\\
>    &=P(A)[1-P(B)]\\
>    &=P(A)\,P(\overline{B})
> \end{aligned}
> $$
>
> 因此事件 $A$ 与事件 $\overline{B}$ 是相互独立的.

同理，如果事件 $A$ 与事件 $B$ 相互独立，则事件 $\overline{A}$ 与事件 $B$ 相互独立，事件 $\overline{A}$ 与事件 $\overline{B}$ 相互独立.

**定义 1.5**&nbsp;&nbsp;&nbsp;&nbsp;对于同一试验 $E$ 的三个事件 $A,B,C$，如果满足

$$
P(AB)=P(A)\,P(B)\\
P(BC)=P(B)\,P(C)\\
P(AC)=P(A)\,P(C)
$$

则称三个事件 $A,B,C$ 是**两两相互独立**的.

**定义 1.6**&nbsp;&nbsp;&nbsp;&nbsp;如果三个事件 $A,B,C$ 是两两相互独立的，并且有 $P(ABC)=P(A)\,P(B)\,P(C)$，则称三个事件 $A,B,C$ 是**相互独立**的.

**定义 1.7**&nbsp;&nbsp;&nbsp;&nbsp;设 $A_1,A_2,\cdots,A_n$ 是同一试验 $E$ 的 $n$ 个事件，如果对于任意正整数 $k$ 及这 $n$ 个事件中的任意 $k\,(2\leqslant k\leqslant n)$ 个事件 $A_{i_1},A_{i_2},\cdots,A_{i_k}$，都有等式

$$
P(A_{i_1}A_{i_2}\cdots A_{i_k})=P(A_{i_1})\,P(A_{i_2})\cdots P(A_{i_k})
$$

则称这 $n$ 个事件 $A_1,A_2,\cdots,A_n$ 是**相互独立**的.

## 1.6 伯努利概型

如果将试验 $E$ 重复执行 $n$ 次，在每一次试验中，事件 $A$ 或者发生，或者不发生. 假设每次试验的结果互不影响，即在每次试验中事件 $A$ 发生的概率保持不变，不受其他各次试验结果的影响，则称这 $n$ 次试验相互独立.

如果试验 $E$ 只有两个可能的对立结果 $A$ 和 $\overline{A}$，并且 $P(A)=p$，$P(\overline{A})=1-p$，其中 $0<p<1$. 将试验 $E$ 独立地重复进行 $n$ 次所构成的一个试验叫做 $n$ 重伯努利试验，简称为**伯努利试验**或**伯努利概型**.

$n$ 重伯努利试验的基本事件可记为 $\omega=\omega_1\omega_2\cdots\omega_n$，其中 $\omega_i\,(1\leqslant i\leqslant n)$ 为 $A$ 或者为 $\overline{A}$，即 $\omega$ 是从 $A$ 及 $\overline{A}$ 中每次取 1 个，独立地重复取 $n$ 次的一种排列，共有 $2^n$ 个基本事件.

如果 $\omega$ 中有 $k$ 个 $A$，则必有 $n-k$ 个 $\overline{A}$，由独立性可得这一基本事件的概率为 $p^k (1-p)^{n-k}$.

由于在 $2^n$ 个基本事件中共有 $C_n^k$ 个含 $k$ 个 $A$ 及 $n-k$ 个 $\overline{A}$，因此在 $n$ 次独立重复试验中，事件 $A$ 恰好发生 $k$ 次的概率 $P_n(k)$ 为

$$
\tag{1-5}
P_n(k)=C_n^k p^k (1-p)^{n-k} \quad k=0,1,2,\cdots,n
$$

由二项式定理可得

$$
\sum_{k=0}^n P_n(k)=\sum_{k=0}^n C_n^k p^k (1-p)^{n-k}=[p+(1-p)]^n=1
$$

由此可见，$C_n^k p^k (1-p)^{n-k}$ 是二项展开式中的一项，因此式 $(1\text{-}5)$ 又称为**二项概率公式**.

# 2 随机变量及其分布

## 2.1 随机变量的分布函数

### 2.1.1 随机变量

**定义 2.1**&nbsp;&nbsp;&nbsp;&nbsp;设随机试验 $E$ 的样本空间为 $\varOmega=\{\omega\}$. 如果对于每一个 $\omega\in\varOmega$，都有一个实数 $X(\omega)$ 与之对应，则称 $X=X(\omega)$ 为**随机变量**.

### 2.1.2 分布函数及其性质

**定义 2.2**&nbsp;&nbsp;&nbsp;&nbsp;设 $X$ 是一个随机变量，对于任意实数 $x$，令 $F(x)=P\{X\leqslant x\}$，称 $F(x)$ 为随机变量 $X$ 的**分布函数**.

**性质 1**&nbsp;&nbsp;&nbsp;&nbsp;对于任意实数 $x$，有 $0\leqslant F(x)\leqslant 1$.

**性质 2**&nbsp;&nbsp;&nbsp;&nbsp;对于任意实数 $x_1,x_2\,(x_1<x_2)$，有 $P\{x_1<X\leqslant x_2\}=F(x_2)-F(x_1)$.

**性质 3**

$$
F(-\infty)=\lim_{x\to -\infty}F(x)=0\\
F(+\infty)=\lim_{x\to +\infty}F(x)=1
$$

**性质 4**&nbsp;&nbsp;&nbsp;&nbsp;$F(x)$ 处处右连续，即 $F(x^+)=F(x)$.

**性质 5**&nbsp;&nbsp;&nbsp;&nbsp;$F(x)$ 是一个单调不减函数.

## 2.2 离散型随机变量及其概率分布

**定义 2.3**&nbsp;&nbsp;&nbsp;&nbsp;如果一个随机变量 $X$ 所有可能取到的不相同的值是有限个或可列无限多个，并且以确定的概率取这些不同的值，则称 $X$ 为**离散型随机变量**.

**定义 2.4**&nbsp;&nbsp;&nbsp;&nbsp;设离散型随机变量 $X$ 所有可能取的值为 $x_k\,(k=1,2,\cdots)$，$X$ 取各个可能值的概率，即事件 $\{X=x_k\}$ 的概率为

$$
\tag{2-1} P\{X=x_k\}=p_k
$$

并且 $p_k$ 满足以下两个条件：

1. $p_k\geqslant 0$；
2. $\displaystyle\sum_{k=1}^\infty p_k=1$，

则称式 $(2\text{-}1)$ 为离散型随机变量 $X$ 的**概率分布**或**分布律**.

概率分布也可以用如下的表格来表示：

<div align="center">
    <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%88%86%E5%B8%83%E5%BE%8B.png">
</div>

离散型随机变量 $X$ 的分布函数为

$$
F(x)=P\{X\leqslant x\}=\sum_{x_k\leqslant x}P\{X=x_k\}=\sum_{x_k\leqslant x}p_k
$$

## 2.3 连续型随机变量及其概率密度

**定义 2.5**&nbsp;&nbsp;&nbsp;&nbsp;对于随机变量 $X$ 的分布函数 $F(x)$，如果存在非负函数 $f(x)$，使得对任意的 $x$，都有 $F(x)=\displaystyle\int_{-\infty}^x f(t)\,\text{d}t$，则称随机变量 $X$ 是**连续型随机变量**，其中函数 $f(x)$ 叫做 $X$ 的**概率密度函数**，简称为**概率密度**，记作 $X\sim f(x)$.

连续型随机变量的分布函数处处连续.

**性质 1**&nbsp;&nbsp;&nbsp;&nbsp;$f(x)\geqslant 0$

**性质 2**&nbsp;&nbsp;&nbsp;&nbsp;$\displaystyle\int_{-\infty}^{+\infty}f(x)\,\text{d}x=1$

满足性质 1 与性质 2 的函数 $f(x)$ 必然是某随机变量的概率密度.

**性质 3**&nbsp;&nbsp;&nbsp;&nbsp;对于任意实数 $a,b\,(a<b)$，有

$$
P\{a<X\leqslant b\}=F(b)-F(a)=\int_a^b f(x)\,\text{d}x
$$

由以上性质可知，概率密度曲线总是位于 $x$ 轴上方，并且介于它和 $x$ 轴之间的面积等于 1；随机变量落在区间 $(a,b]$ 的概率 $P\{a<X\leqslant b\}$ 等于区间 $(a,b]$ 上曲线 $y=f(x)$ 之下的曲边梯形的面积.

**性质 4**&nbsp;&nbsp;&nbsp;&nbsp;如果 $f(x)$ 在点 $x$ 处连续，则有 $F'(x)=f(x)$.

对于 $X$ 的任意一个可取的值 $x$，设 $\Delta x>0$，由于事件 $\{X=x\}\subseteq\{x-\Delta x<X\leqslant x\}$，因此有

$$
0\leqslant P\{X=x\}\leqslant P\{x-\Delta x<X\leqslant x\}=F(x)-F(x-\Delta x)
$$

令 $\Delta x\to 0$，可得

$$
P\{X=x\}=0
$$

因此，连续型随机变量取任意指定实数的概率均为零. 据此，在计算连续型随机变量在某一区间取值的概率时，可以不区分该区间是开区间或闭区间或半开半闭区间，即有

$$
P\{x_1<X<x_2\}=P\{x_1 \leqslant X\leqslant x_2\}=\int_{x_1}^{x_2}f(x)\,\text{d}x
$$

## 2.4 几种常用的分布

### 2.4.1 几种常用的离散型随机变量

#### 2.4.1.1 （0-1）分布

**定义 2.6**&nbsp;&nbsp;&nbsp;&nbsp;如果随机变量 $X$ 只取 0 与 1 两个值，其概率分布为

$$
P\{X=0\}=1-p,\;P\{X=1\}=p,\;0<p<1
$$

或写成

$$
P\{X=k\}=p^k (1-p)^{1-k},\;k=0,1,\;0<p<1
$$

则称随机变量 $X$ 服从参数为 $p$ 的（0-1）分布或**两点分布**.

服从两点分布的随机变量 $X$ 的概率分布也可以写成

<div align="center">
    <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E4%B8%A4%E7%82%B9%E5%88%86%E5%B8%83.png">
</div>

#### 2.4.1.2 二项分布

在 $n$ 重伯努利试验中，如果以 $X$ 表示事件 $A$ 出现的次数，则 $X$ 是一个离散型随机变量，它的所有可能取值是 $0,1,2,\cdots,n$. 设 $P(A)=p\,(0<p<1)$，则由二项概率公式（式 $(1\text{-}5)$）可得

$$
P\{X=k\}=C_n^k p^k (1-p)^{n-k},\;k=0,1,\cdots,n
$$

**定义 2.7**&nbsp;&nbsp;&nbsp;&nbsp;如果随机变量 $X$ 的概率分布为

$$
P\{X=k\}=C_n^k p^k (1-p)^{n-k},\;k=0,1,\cdots,n
$$

则称随机变量 $X$ 服从参数为 $n,p$ 的**二项分布**，记作 $X\sim B(n,p)$.

由定义可得

$$
P\{X=k\}\geqslant 0\\
\sum_{k=0}^n P\{X=k\}=\sum_{k=0}^n C_n^k p^k (1-p)^{n-k}=[p+(1-p)]^n=1
$$

特别地，当 $n=1$ 时，二项分布 $B(1,p)$ 的概率分布为

$$
P\{X=k\}=p^k (1-p)^{1-k},\;k=0,1
$$

这就是（0-1）分布. 因此，（0-1）分布是二项分布的特例.

#### 2.4.1.3 泊松分布

**定义 2.8**&nbsp;&nbsp;&nbsp;&nbsp;如果随机变量 $X$ 的所有可能取值为 $0,1,2,\cdots$，并且

$$
P\{X=k\}=\dfrac{\lambda^k e^{-\lambda}}{k!},\;k=0,1,2\cdots
$$

其中 $\lambda>0$ 是常数，则称随机变量 $X$ 服从参数为 $\lambda$ 的**泊松分布**，记作 $X\sim P(\lambda)$ 或 $\pi(\lambda)$.

易知

$$
\dfrac{\lambda^k e^{-\lambda}}{k!}>0\\
\ \\
\sum_{k=0}^\infty \dfrac{\lambda^k e^{-\lambda}}{k!}=e^{-\lambda}\sum_{k=0}^\infty \dfrac{\lambda^k}{k!}=e^{-\lambda}e^{\lambda}=1
$$

**定理 2.1（泊松定理）**&nbsp;&nbsp;&nbsp;&nbsp;设 $\lambda>0$ 是常数，$n$ 为任意正整数，$np_n=\lambda$，则对任一固定的非负整数 $k$，有

$$
\lim_{n\to\infty}C_n^k p_n^k (1-p_n)^{n-k}=\dfrac{\lambda^k e^{-\lambda}}{k!}
$$

> **证明：** 因为 $np_n=\lambda$，故 $p_n=\dfrac{\lambda}{n}$，从而对于任意固定的非负整数 $k$，有
>
> $$
> \begin{aligned}
>     & C_n^k p_n^k (1-p_n)^{n-k}\\
>     =\ & \dfrac{n(n-1)\cdots(n-k+1)}{k!}\Big(\dfrac{\lambda}{n}\Big)^k \Big(1-\dfrac{\lambda}{n}\Big)^{n-k}\\
>     =\ & \dfrac{\lambda^k}{k!}\Big[1\times\Big(1-\dfrac{1}{n}\Big)\Big(1-\dfrac{2}{n}\Big)\cdots\Big(1-\dfrac{k-1}{n}\Big)\Big]\Big(1-\dfrac{\lambda}{n}\Big)^n \Big(1-\dfrac{\lambda}{n}\Big)^{-k}
> \end{aligned}
> $$
>
> 对于固定的 $k$，当 $n\to\infty$ 时，有
>
> $$
> 1\times\Big(1-\dfrac{1}{n}\Big)\Big(1-\dfrac{2}{n}\Big)\cdots\Big(1-\dfrac{k-1}{n}\Big)\to 1\\
> \ \\
> \Big(1-\dfrac{\lambda}{n}\Big)^n \to e^{-\lambda}\\
> \ \\
> \Big(1-\dfrac{\lambda}{n}\Big)^{-k}\to 1
> $$
>
> 所以
>
> $$
> \lim_{n\to\infty}C_n^k p_n^k (1-p_n)^{n-k}=\dfrac{\lambda^k e^{-\lambda}}{k!}
> $$

由于 $np_n=\lambda$，意味着当 $n$ 很大时 $p_n$ 必定很小. 因此，泊松定理表明，当 $n$ 很大而 $p$ 很小时，有下面的近似公式

$$
C_n^k p^k (1-p)^{n-k}\approx \dfrac{\lambda^k e^{-\lambda}}{k!}
$$

其中 $\lambda=np$.

也就是说，对于二项分布 $B(n,p)$，当 $n$ 很大而 $p$ 很小时，近似为泊松分布 $P(np)$.

#### 2.4.1.4 几何分布

设试验 $E$ 只有两个对立的结果 $A$ 和 $\overline{A}$，并且 $P(A)=p,\,P(\overline{A})=1-p$，其中 $0<p<1$. 将试验 $E$ 独立地重复进行下去，直到事件 $A$ 发生为止. 如果用 $X$ 表示所需要的试验次数，则 $X$ 是一个随机变量，它可能取的值是 $1,2,3,\cdots$. $X$ 的概率分布为

$$
P\{X=k\}=(1-p)^{k-1} p,\;k=1,2,\cdots
$$

称随机变量 $X$ 服从参数为 $p$ 的几何分布.

易知

$$
(1-p)^{k-1} p>0\\
\sum_{k=1}^\infty (1-p)^{k-1} p=p\sum_{i=0}^\infty (1-p)^i=p\cdot\dfrac{1}{1-(1-p)}=1
$$

### 2.4.2 均匀分布

**定义 2.9**&nbsp;&nbsp;&nbsp;&nbsp;如果连续型随机变量 $X$ 的概率密度为

$$
f(x)=\begin{cases}
    \dfrac{1}{b-a} & a<x<b\\
    0 & 其他
\end{cases}
$$

则称 $X$ 在区间 $(a,b)$ 上服从**均匀分布**，记作 $X\sim U(a,b)$.

$X$ 的分布函数为

$$
F(x)=\begin{cases}
    0 & x<a\\
    \dfrac{x-a}{b-a} & a\leqslant x<b\\
    1 & x\geqslant b
\end{cases}
$$

<div align="center" style="margin-bottom: 20px">
    <div style="float: left; width: 50%;">
        <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.1-%E5%9D%87%E5%8C%80%E5%88%86%E5%B8%83%E7%9A%84%E6%A6%82%E7%8E%87%E5%AF%86%E5%BA%A6.png">
        <br>
        图 2.1&nbsp;&nbsp;&nbsp;&nbsp;均匀分布的概率密度
    </div>
    <div style="width: 50%; margin-left: 50%; position: relative; top: 10px">
        <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.2-%E5%9D%87%E5%8C%80%E5%88%86%E5%B8%83%E7%9A%84%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0.png">
        <br>
        图 2.2&nbsp;&nbsp;&nbsp;&nbsp;均匀分布的分布函数
    </div>
</div>

对任意的两个数 $x_1,x_2\in(a,b)$，如果 $x_1<x_2$，则有

$$
P\{x_1\leqslant X\leqslant x_2\}=\int_{x_1}^{x_2}\dfrac{\text{d}x}{b-a}=\dfrac{x_2-x_1}{b-a}
$$

这说明随机变量 $X$ 位于区间 $(a,b)$ 的任一子区间 $[x_1,x_2]$ 内的概率，只依赖于子区间 $[x_1,x_2]$ 的长度，而与子区间的位置无关.

### 2.4.3 指数分布

**定义 2.10**&nbsp;&nbsp;&nbsp;&nbsp;如果连续型随机变量 $X$ 的概率密度为

$$
f(x)=\begin{cases}
    \lambda e^{-\lambda x} & x>0\\
    0 & x\leqslant 0
\end{cases}
$$

其中 $\lambda>0$ 是常数，则称 $X$ 服从参数为 $\lambda$ 的指数分布.

$X$ 的分布函数为

$$
F(x)=\begin{cases}
    0 & x\leqslant 0\\
    1-e^{-\lambda x} & x>0
\end{cases}
$$

<div align="center">
    <div style="float: left; width: 50%;">
        <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.3-%E6%8C%87%E6%95%B0%E5%88%86%E5%B8%83%E7%9A%84%E6%A6%82%E7%8E%87%E5%AF%86%E5%BA%A6.png">
        <br>
        图 2.3&nbsp;&nbsp;&nbsp;&nbsp;指数分布的概率密度
    </div>
    <div style="width: 50%; margin-left: 50%; position: relative; top: 5px">
        <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.4-%E6%8C%87%E6%95%B0%E5%88%86%E5%B8%83%E7%9A%84%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0.png">
        <br>
        图 2.4&nbsp;&nbsp;&nbsp;&nbsp;指数分布的分布函数
    </div>
</div>

### 2.4.4 正态分布

#### 2.4.4.1 正态分布及其性质

**定义 2.11**&nbsp;&nbsp;&nbsp;&nbsp;如果连续型随机变量 $X$ 的概率密度为

$$
f(x)=\dfrac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}},\;-\infty<x<+\infty
$$

其中 $\mu,\sigma\,(\sigma>0)$ 为常数，则称 $X$ 服从参数为 $\mu,\sigma$ 的**正态分布**，记作 $X\sim N(\mu,\sigma^2)$.

$X$ 的分布函数为

$$
F(x)=\dfrac{1}{\sqrt{2\pi}\sigma}\int_{-\infty}^x e^{-\frac{(t-\mu)^2}{2\sigma^2}}\,\text{d}t,\;-\infty<x<+\infty
$$

<div align="center" style="margin-bottom: 20px">
    <div style="float: left; width: 50%;">
        <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.5-%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E7%9A%84%E6%A6%82%E7%8E%87%E5%AF%86%E5%BA%A6.png">
        <br>
        图 2.5&nbsp;&nbsp;&nbsp;&nbsp;正态分布的概率密度
    </div>
    <div style="width: 50%; margin-left: 50%; position: relative; top: 8px">
        <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.6-%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E7%9A%84%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0.png">
        <br>
        图 2.6&nbsp;&nbsp;&nbsp;&nbsp;正态分布的分布函数
    </div>
</div>

概率密度曲线 $y=f(x)$ 关于直线 $x=\mu$ 对称，并在 $x=\mu$ 处取得最大值 $\dfrac{1}{\sqrt{2\pi}\sigma}$，在横坐标 $x=\mu\pm\sigma$ 处有拐点，以 $x$ 轴为水平渐近线.

如果固定 $\sigma$，改变 $\mu$ 的值，则概率密度曲线沿着 $x$ 轴平移，但形状不变，如图 2.7 所示.

<div align="center" style="margin-bottom: 10px">
    <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.7.png">
    <br>
    图 2.7
</div>

如果固定 $\mu$，改变 $\sigma$ 的值，则由 $y_{\text{max}}=\dfrac{1}{\sqrt{2\pi}\sigma}$ 可知，当 $\sigma$ 越小时概率密度曲线在 $x=\mu$ 附近越陡峭，$X$ 落在 $x=\mu$ 附近的概率越大；当 $\sigma$ 越大时概率密度曲线越平坦，如图 2.8 所示.

<div align="center">
    <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.8.png">
    <br>
    图 2.8
</div>

#### 2.4.4.2 标准正态分布

**定义 2.12**&nbsp;&nbsp;&nbsp;&nbsp;设 $X\sim N(\mu,\sigma^2)$，如果 $\mu=0,\sigma=1$，则称 $X$ 服从**标准正态分布**，记作 $X\sim N(0,1)$.

服从标准正态分布的随机变量 $X$ 的概率密度记作 $\varphi(x)$，分布函数记作 $\varPhi(x)$，即

$$
\varphi(x)=\dfrac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},\;-\infty<x<+\infty\\
\ \\
\varPhi(x)=\dfrac{1}{\sqrt{2\pi}}\int_{-\infty}^x e^{-\frac{t^2}{2}}\,\text{d}t,\;-\infty<x<+\infty
$$

<div align="center" style="margin-bottom: 14px">
    <div style="float: left; width: 50%;">
        <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.9-%E6%A0%87%E5%87%86%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E7%9A%84%E6%A6%82%E7%8E%87%E5%AF%86%E5%BA%A6.png">
        <br>
        图 2.9&nbsp;&nbsp;&nbsp;&nbsp;标准正态分布的概率密度
    </div>
    <div style="width: 50%; margin-left: 50%; position: relative; top: 4px;">
        <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.10-%E6%A0%87%E5%87%86%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E7%9A%84%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0.png">
        <br>
        图 2.10&nbsp;&nbsp;&nbsp;&nbsp;标准正态分布的分布函数
    </div>
</div>

由于 $\varphi(x)$ 是偶函数，所以有

$$
\tag{2-2}
\varPhi(-x)=1-\varPhi(x)
$$

设 $X\sim N(0,1)$，对于任意正的实数 $a$，由于

$$
P\{|X|>a\}=2P\{X>a\}=2(1-P\{X\leqslant a\})
$$

因此

$$
\tag{2-3}
P\{|X|>a\}=2[1-\varPhi(a)]
$$

因为

$$
P\{|X|\leqslant a\}=1-P\{|X|>a\}=1-2[1-\varPhi(a)]
$$

所以

$$
\tag{2-4}
P\{|X|\leqslant a\}=2\varPhi(a)-1
$$

设 $X\sim N(\mu,\sigma^2)$，其分布函数为

$$
F(x)=\dfrac{1}{\sqrt{2\pi}\sigma}\int_{-\infty}^x e^{-\frac{(t-\mu)^2}{2\sigma^2}}\,\text{d}t,\;-\infty<x<+\infty
$$

令 $u=\dfrac{t-\mu}{\sigma}$，可得

$$
F(x)=\dfrac{1}{\sqrt{2\pi}}\int_{-\infty}^{\dfrac{x-\mu}{\sigma}}e^{-\dfrac{u^2}{2}}\,\text{d}u
$$

即

$$
\tag{2-5}
F(x)=\varPhi(\dfrac{x-\mu}{\sigma})
$$

从而对于任意实数 $x_1,x_2\,(x_1<x_2)$，有

$$
\tag{2-6}
P\{x_1<X<x_2\}=F(x_2)-F(x_1)=\varPhi(\dfrac{x_2-\mu}{\sigma})-\varPhi(\dfrac{x_1-\mu}{\sigma})
$$

由式 $(2\text{-}2)$ 和式 $(2\text{-}5)$ 有

$$
\begin{aligned}
    P\{|X-\mu|<k\sigma\}&=P\{\mu-k\sigma<X\leqslant \mu+k\sigma\}\\
    &=F(\mu+k\sigma)-F(\mu-k\sigma)\\
    &=\varPhi(k)-\varPhi(-k)\\
    &=2\varPhi(k)-1
\end{aligned}
$$

所以

$$
P\{|X-\mu|<\sigma\}=2\varPhi(1)-1=0.6826\\
P\{|X-\mu|<2\sigma\}=2\varPhi(2)-1=0.9544\\
P\{|X-\mu|<3\sigma\}=2\varPhi(3)-1=0.9974
$$

$3\sigma$ 规则：正态随机变量 $X$ 以 99.74% 的概率落在以 $\mu$ 为中心、以 $3\sigma$ 为半径的区间内，而落在该区间以外的概率很小，在一次试验中，$X$ 落在该区间以外这个事件几乎不会发生.

#### 2.4.4.3 标准正态分布的上 $\alpha$ 分位点

**定义 2.13**&nbsp;&nbsp;&nbsp;&nbsp;设 $X\sim N(0,1)$. 对于给定的 $\alpha\,(0<\alpha<1)$，如果 $u_{\alpha}$ 满足条件

$$
P\{X\geqslant u_{\alpha}\}=\dfrac{1}{\sqrt{2\pi}}\int_{u_{\alpha}}^{+\infty}e^{-\frac{x^2}{2}}\,\text{d}x=\alpha
$$

则称点 $u_{\alpha}$ 为标准正态分布的**上** $\alpha$ **分位点**.

上 $\alpha$ 分位点的含义如图 2.11 所示.

<div align="center" style="margin-bottom: 10px">
    <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E5%9B%BE2.11.png">
    <br>
    图 2.11&nbsp;&nbsp;&nbsp;&nbsp;
</div>

根据对称性，上 $1-\alpha$ 分位点 $u_{1-\alpha}$ 与上 $\alpha$ 分位点 $u_{\alpha}$ 关于原点对称，即有

$$
\tag{2-7}
u_{1-\alpha}=-u_{\alpha}
$$

因为

$$
P\{X\leqslant u_{\alpha}\}=1-P\{X>u_{\alpha}\}=1-\alpha
$$

所以

$$
\tag{2-8} \varPhi(u_{\alpha})=1-\alpha
$$

## 2.5 随机变量的函数的分布

### 2.5.1 离散型随机变量的函数的分布

设离散型随机变量 $X$ 的概率分布为

$$
P\{X=x_k\}=p_k,\;k=1,2,\cdots
$$

$y=g(x)$ 是连续函数，则对于 $X$ 的函数 $Y=g(X)$，有

$$
P\{Y=g(x_k)\}=p_k,\;k=1,2,\cdots
$$

如果数值 $g(x_k)(k=1,2,\cdots)$ 中有相等的，就把 $Y$ 取这些相等的数值的概率相加，作为 $Y=g(X)$ 取该值的概率，便可得到 $Y=g(X)$ 的概率分布.

### 2.5.2 连续型随机变量的函数的分布

求随机变量 $Y=g(X)$ 的分布函数的关键一步是从 $g(X)\leqslant y$ 中解出 $X$ 应满足的不能等式.

**例 2.1**&nbsp;&nbsp;&nbsp;&nbsp;设随机变量 $X$ 服从柯西（Cauchy）分布，即 $X$ 的概率密度为

$$
f_{X}(x)=\dfrac{1}{\pi(1+x^2)},\;-\infty<x<+\infty
$$

求随机变量 $Y=\arctan X$ 的概率密度.

> **解：** $Y$ 的分布函数为
>
> $$
> F_{Y}(y)=P\{Y\leqslant y\}=P\{\arctan X\leqslant y\}
> $$
>
> 当 $|y|<\dfrac{\pi}{2}$ 时，$\{\arctan X\leqslant y\}=\{X\leqslant\tan y\}$，于是得 $Y$ 的分布函数 $F_{Y}(y)$ 与 $X$ 的分布函数 $F_{X}(x)$ 之间的关系如下：
>
> $$
> F_{Y}(y)=P\{\arctan X\leqslant y\}=P\{X\leqslant\tan y\}=F_{X}(\tan y)
> $$
>
> 因此 $Y$ 的概率密度为
>
> $$
> \begin{aligned}
>    f_{Y}(y)&=\dfrac{\text{d}}{\text{d}y}F_{Y}(y)\\
>    &=\dfrac{\text{d}}{\text{d}y}F_{X}(\tan y)\\
>    &=f_{X}(\tan y)\cdot\sec^2 y\\
>    &=\dfrac{\sec^2 y}{\pi(1+\tan^2 y)}\\
>    &=\dfrac{1}{\pi}
> \end{aligned}
> $$
>
> 当 $y\geqslant\dfrac{\pi}{2}$ 时，事件 $\{\arctan X\leqslant y\}$ 是必然事件，所以 $F_{Y}(y)=1$，从而 $f_{Y}(y)=0$.
>
> 当 $y\leqslant -\dfrac{\pi}{2}$ 时，事件 $\{\arctan X\leqslant y\}$ 是不可能事件，所以 $F_{Y}(y)=0$，从而 $f_{Y}(y)=0$.
>
> 综上所述，$Y$ 的概率密度为
>
> $$
> f_{Y}(y)=\begin{cases}
>     \dfrac{1}{\pi} & |y|<\dfrac{\pi}{2}\\
>     \ \\
>     0 & |y|\geqslant\dfrac{\pi}{2}
\end{cases}
> $$

**定理 2.2**&nbsp;&nbsp;&nbsp;&nbsp;设随机变量 $X$ 的概率密度为 $f_{X}(x),\,-\infty<x<+\infty$，函数 $g(x)$ 是处处可导的严格单调函数，则随机变量 $Y=g(X)$ 的概率密度为

$$
f_{Y}(y)=\begin{cases}
    f_{X}(h(y))|h'(y)| & \alpha<y<\beta\\
    0 & 其他
\end{cases}
$$

其中 $\alpha=\min(g(-\infty),g(+\infty)),\,\beta=\max(g(-\infty),g(+\infty))$，$h(y)$ 是 $g(x)$ 的反函数.

> **证明：** 当 $g(x)$ 处处可导且严格单调增加时，它的反函数 $h(y)$ 在区间 $(\alpha,\beta)$ 内也处处可导且严格单调增加，所以当 $y\leqslant\alpha$ 时，$F_{Y}(y)=0$；当 $y\geqslant\beta$ 时，$F_{Y}(y)=1$；当 $\alpha<y<\beta$ 时，有
>
> $$
> F_{Y}(y)=P\{Y\leqslant y\}=P\{g(X)\leqslant y\}=P\{X\leqslant h(y)\}=F_{X}(h(y))
> $$
>
> 于是 $Y=g(X)$ 的概率密度为
>
> $$
> f_{Y}(y)=F_{Y}'(y)=\begin{cases}
>     f_{X}(h(y))h'(y) & \alpha<y<\beta\\
>     0 & 其他
> \end{cases}
> $$
>
> 当 $g(x)$ 处处可导且严格单调减少时，它的反函数 $h(y)$ 在区间 $(\alpha,\beta)$ 内也处处可导且严格单调减少，所以当 $y\leqslant\alpha$ 时，$F_{Y}(y)=0$；当 $y\geqslant\beta$ 时，$F_{Y}(y)=1$；当 $\alpha<y<\beta$ 时，有
>
> $$
> \begin{aligned}
>     F_{Y}(y)&=P\{Y\leqslant y\}\\
>     &=P\{g(X)\leqslant y\}\\
>     &=P\{X\geqslant h(y)\}\\
>     &=1-P\{X<h(y)\}\\
>     &=1-F_{X}(h(y))
> \end{aligned}
> $$
>
> 于是 $Y=g(X)$ 的概率密度为
>
> $$
> f_{Y}(y)=F_{Y}'(y)=\begin{cases}
>     -f_{X}(h(y))h'(y) & \alpha<y<\beta\\
>     0 & 其他
> \end{cases}
> $$
>
> 综上所述，$Y=g(X)$ 的概率密度为
>
> $$
> f_{Y}(y)=\begin{cases}
>     f_{X}(h(y))|h'(y)| & \alpha<y<\beta\\
>     0 & 其他
> \end{cases}
> $$

结论：当 $X\sim N(\mu,\sigma^2)$ 时，$X$ 的线性函数 $Y=aX+b\,(a\not=0)$ 服从正态分布 $N(a\mu+b,a^2 \sigma^2)$.

> **证明：** 因为 $X\sim N(\mu,\sigma^2)$，所以 $X$ 的概率密度为
>
> $$
> f(x)=\dfrac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}},\;-\infty<x<+\infty
> $$
>
> 由 $y=ax+b$ 解得
>
> $$
> x=h(y)=\dfrac{y-b}{a}
> $$
>
> 且有
>
> $$
> h'(y)=\dfrac{1}{a}
> $$
>
> 由定理 2.2 得 $Y=aX+b$ 的概率密度为
>
> $$
> \begin{aligned}
>     f_{Y}(y)&=\dfrac{1}{|a|}f_{X}(\dfrac{y-b}{a})\\
>     &=\dfrac{1}{|a|} \dfrac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(\frac{y-b}{a}-\mu)^2}{2\sigma^2}}\\
>     &=\dfrac{1}{\sqrt{2\pi}|a|\sigma} e^{-\frac{[y-(a\mu+b)]^2}{2a^2 \sigma^2}}
> \end{aligned}
> $$
>
> 即 $Y=aX+b\sim N(a\mu+b,a^2 \sigma^2)$.

特别地，当 $a=\dfrac{1}{\sigma},b=-\dfrac{\mu}{\sigma}$ 时，有 $Y=\dfrac{X-\mu}{\sigma}\sim N(0,1)$.

# 3 二维随机变量及其分布

## 3.1 二维随机变量

### 3.1.1 二维随机变量及其分布函数

**定义 3.1**&nbsp;&nbsp;&nbsp;&nbsp;设随机试验 $E$ 的样本空间为 $\varOmega$，$X$ 和 $Y$ 是定义在 $\varOmega$ 上的两个随机变量，由它们构成的向量 $(X,Y)$ 称为**二维随机变量**或**二维随机向量**.

**定义 3.2**&nbsp;&nbsp;&nbsp;&nbsp;设 $(X,Y)$ 是二维随机变量. 对于任意实数 $x$ 和 $y$，记事件 $\{X\leqslant x\}$ 与 $\{Y\leqslant y\}$ 的交事件为 $\{X\leqslant x,Y\leqslant y\}$，称二元函数

$$
F(x,y)=P\{X\leqslant x,Y\leqslant y\},\;(x,y)\in\R^2
$$

为二维随机变量 $(X,Y)$ 的分布函数，或称为随机变量 $X$ 和 $Y$ 的**联合分布函数**.

如果将二维随机变量 $(X,Y)$ 看做 $xOy$ 平面上随机点的坐标，则分布函数 $F(x,y)$ 在点 $(x,y)$ 处的函数值就是随机点落在以 $(x,y)$ 为顶点且位于该点左下方的无界域内的概率.

**性质 1**&nbsp;&nbsp;&nbsp;&nbsp;$0\leqslant F(x,y)\leqslant 1$，且

$$
F(-\infty,-\infty)=\lim_{\substack{x\to -\infty\\ y\to -\infty}}F(x,y)=0\\
F(+\infty,+\infty)=\lim_{\substack{x\to +\infty\\ y\to +\infty}}F(x,y)=1
$$

对于任意固定的 $x$，有 $F(x,-\infty)=\displaystyle\lim_{y\to -\infty}F(x,y)=0$.
对于任意固定的 $y$，有 $F(-\infty,y)=\displaystyle\lim_{x\to -\infty}F(x,y)=0$.

**性质 2**&nbsp;&nbsp;&nbsp;&nbsp;$F(x,y)$ 对于每个变量都是单调不减函数. 即对于任意固定的 $y$，当 $x_1<x_2$ 时，有 $F(x_1,y)\leqslant F(x_2,y)$；对于任意固定的 $x$，当 $y_1<y_2$ 时，有 $F(x,y_1)\leqslant F(x,y_2)$.

**性质 3**&nbsp;&nbsp;&nbsp;&nbsp;$F(x,y)$ 关于 $x$ 右连续，关于 $y$ 右连续，即

$$
F(x^+,y)=F(x,y)\\
F(x,y^+)=F(x,y)
$$

**性质 4**&nbsp;&nbsp;&nbsp;&nbsp;对于任意的 $x_1<x_2,y_1<y_2$，有

$$
P\{x_1<X\leqslant x_2,y_1<Y\leqslant y_2\}=F(x_2,y_2)-F(x_1,y_2)-F(x_2,y_1)+F(x_1,y_1)
$$

### 3.1.2 边缘分布

**定义 3.3**&nbsp;&nbsp;&nbsp;&nbsp;设二维随机变量 $(X,Y)$ 的分布函数为 $F(x,y)$，记随机变量 $X$ 的分布函数为 $F_{X}(x)$，随机变量 $Y$ 的分布函数为 $F_{Y}(y)$，分别称为二维随机变量 $(X,Y)$ 关于 $X$ 和关于 $Y$ 的**边缘分布函数**.

$$
F_{X}(x)=P\{X\leqslant x\}=P\{X\leqslant x,Y<+\infty\}=F(x,+\infty)\quad x\in\R\\
F_{Y}(y)=P\{Y\leqslant y\}=P\{X<+\infty,Y\leqslant y\}=F(+\infty,y)\quad y\in\R
$$

### 3.1.3 随机变量的独立性

**定义 3.4**&nbsp;&nbsp;&nbsp;&nbsp;设二维随机变量 $(X,Y)$ 的分布函数及其关于 $X$ 和关于 $Y$ 的边缘分布函数分别为 $F(x,y),F_{X}(x),F_{Y}(y)$，如果对于任意实数 $x,y$，都有 $F(x,y)=F_{X}(x)F_{Y}(y)$，则称随机变量 $X$ 与 $Y$ 是**相互独立**的.

## 3.2 二维离散型随机变量

### 3.2.1 二维离散型随机变量及其概率分布

**定义 3.5**&nbsp;&nbsp;&nbsp;&nbsp;如果二维随机变量 $(X,Y)$ 所有可能取的值是有限对或可列无限对，则称 $(X,Y)$ 是**二维离散型随机变量**.

设 $(X,Y)$ 所有可能取的值为 $(x_i,y_j)(i,j=1,2,\cdots)$，记事件 $\{X=x_i\}$ 与 $\{Y=y_j\}$ 的交事件为 $\{X=x_i,Y=y_j\}$.

**定义 3.6**&nbsp;&nbsp;&nbsp;&nbsp;设 $(X,Y)$ 所有可能取的值为 $(x_i,y_j)(i,j=1,2,\cdots)$，如果

$$
\tag{3-1} P\{X=x_i,Y=y_j\}=p_{ij},\;i,j=1,2,\cdots
$$

且有

$$
p_{ij}\geqslant 0\\
\sum_{i=1}^\infty \sum_{j=1}^\infty p_{ij}=1
$$

则称式 $(3\text{-}1)$ 为二维离散型随机变量 $(X,Y)$ 的**概率分布**，或称为随机变量 $X$ 和随机变量 $Y$ 的**联合概率分布**或**联合分布律**.

$(X,Y)$ 的概率分布可以用如下的表格表示：

<div align="center">
    <img src="https://raw.githubusercontent.com/zzx-JLU/images_for_markdown/main/%E6%A6%82%E7%8E%87%E8%AE%BA/%E8%81%94%E5%90%88%E5%88%86%E5%B8%83%E5%BE%8B.png">
</div>

### 3.2.2 边缘概率分布

设二维离散型随机变量 $(X,Y)$ 的概率分布为

$$
P\{X=x_i,Y=y_j\}=p_{ij},\;i,j=1,2,\cdots
$$

则有

$$
P\{X=x_i\}=P\{X=x_i,\bigcup_{j=1}^\infty \{Y=y_j\}\}=P\{\bigcup_{j=1}^\infty \{X=x_i,Y=y_j\}\}
$$

由于事件 $\{X=x_i,Y=y_j\}(j=1,2,\cdots)$ 是互不相容的，因此

$$
P\{X=x_i\}=\sum_{j=1}^\infty P\{X=x_i,Y=y_j\}=\sum_{j=1}^\infty p_{ij}
$$

记 $\displaystyle\sum_{j=1}^\infty p_{ij}=p_{i\cdot}$，则有

$$
P\{X=x_i\}=p_{i\cdot},\;i=1,2,\cdots
$$

同理可得

$$
P\{Y=y_j\}=\sum_{i=1}^\infty P\{X=x_i,Y=y_j\}=\sum_{i=1}^\infty p_{ij}=p_{\cdot j},\;j=1,2,\cdots
$$

**定义 3.7**&nbsp;&nbsp;&nbsp;&nbsp;设二维离散型随机变量 $(X,Y)$ 的概率分布为

$$
P\{X=x_i,Y=y_j\}=p_{ij},\;i,j=1,2,\cdots
$$

随机变量 $X$ 和 $Y$ 的概率分布

$$
P\{X=x_i\}=p_{i\cdot},\;i=1,2,\cdots\\
P\{Y=y_j\}=p_{\cdot j},\;j=1,2,\cdots
$$

分别称为 $(X,Y)$ 关于 $X$ 和关于 $Y$ 的**边缘概率分布**或**边缘分布律**.

### 3.2.3 随机变量的独立性

设二维离散型随机变量 $(X,Y)$ 的概率分布为

$$
P\{X=x_i,Y=y_j\}=p_{ij},\;i,j=1,2,\cdots
$$

$(X,Y)$ 关于 $X$ 和关于 $Y$ 的边缘概率分布依次为

$$
P\{X=x_i\}=p_{i\cdot},\;i=1,2,\cdots\\
P\{Y=y_j\}=p_{\cdot j},\;j=1,2,\cdots
$$

则随机变量 $X$ 和 $Y$ 相互独立的充分必要条件是：对任意的 $i,j$，都有

$$
P\{X=x_i,Y=y_j\}=P\{X=x_i\}P\{Y=y_j\},\;i,j=1,2,\cdots
$$

即

$$
p_{ij}=p_{i\cdot}p_{\cdot j},\;i,j=1,2,\cdots
$$

## 3.3 二维连续型随机变量

### 3.3.1 二维连续型随机变量及其概率密度

**定义 3.8**&nbsp;&nbsp;&nbsp;&nbsp;设二维随机变量 $(X,Y)$ 的分布函数为 $F(x,y)$，如果存在非负的二元函数 $f(x,y)$，对于任意实数 $x,y$，有

$$
F(x,y)=\int_{-\infty}^x \int_{-\infty}^y f(u,v)\,\text{d}u\text{d}v
$$

则称 $(X,Y)$ 为**二维连续型随机变量**，$f(x,y)$ 称为二维连续型随机变量 $(X,Y)$ 的**概率密度**，或称为随机变量 $X$ 和 $Y$ 的**联合概率密度**.

**性质 1**&nbsp;&nbsp;&nbsp;&nbsp;$f(x,y)\geqslant 0$

**性质 2**&nbsp;&nbsp;&nbsp;&nbsp;$\displaystyle\int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} f(x,y)\,\text{d}x\text{d}y=1$

**性质 3**&nbsp;&nbsp;&nbsp;&nbsp;如果 $f(x,y)$ 在点 $(x,y)$ 处连续，则

$$
f(x,y)=\dfrac{\partial^2 F(x,y)}{\partial x\partial y}
$$

**性质 4**&nbsp;&nbsp;&nbsp;&nbsp;设 $G$ 是 $xOy$ 平面上的一个区域，则

$$
P\{(X,Y)\in G\}=\underset{G}{\iint} f(x,y)\,\text{d}x\text{d}y
$$

$z=f(x,y)$ 表示空间 $Oxyz$ 中的一张曲面. 性质 1 和性质 2 表明，曲面 $z=f(x,y)$ 位于 $xOy$ 平面上方，介于它和 $xOy$ 平面之间的体积为 1. 性质 4 表示，随机点 $(X,Y)$ 落在区域 $G$ 内的概率 $P\{(X,Y)\in G\}$ 等于以 $G$ 为底、以曲面 $z=f(x,y)$ 为顶的曲顶柱体体积的数值.

### 3.3.2 边缘概率密度

**定义 3.9**&nbsp;&nbsp;&nbsp;&nbsp;设二维连续型随机变量 $(X,Y)$ 的概率密度为 $f(x,y),(x,y)\in\R^2$，将一元函数

$$
f_{X}(x)=\int_{-\infty}^{+\infty} f(x,y)\,\text{d}y,\ x\in\R\\
\ \\
f_{Y}(y)=\int_{-\infty}^{+\infty} f(x,y)\,\text{d}x,\ y\in\R
$$

分别称为二维随机变量 $(X,Y)$ 关于 $X$ 和关于 $Y$ 的**边缘概率密度**.

### 3.3.3 随机变量的独立性

设二维连续型随机变量 $(X,Y)$ 的概率密度为 $f(x,y),(x,y)\in\R^2$，$(X,Y)$ 关于 $X$ 和关于 $Y$ 的边缘概率密度分别为 $f_{X}(x)$ 和 $f_{Y}(y)$，则随机变量 $X$ 和 $Y$ 相互独立的充分必要条件是：对任意 $x,y\in\R$，都有 $f(x,y)=f_{X}(x)\,f_{Y}(y)$.

### 3.3.4 二维均匀分布

设 $D$ 是 $xOy$ 平面上的有界区域，其面积为 $A$. 如果二维随机变量 $(X,Y)$ 具有概率密度

$$
f(x,y)=\begin{cases}
    \dfrac{1}{A} & (x,y)\in D\\
    0 & 其他
\end{cases}
$$

则称 $(X,Y)$ 在区域 $D$ 上服从均匀分布.

### 3.3.5 二维正态分布

设二维随机变量 $(X,Y)$ 的概率密度为

$$
f(x,y)=\dfrac{1}{2\pi\sigma_1 \sigma_2 \sqrt{1-\rho^2}}e^{\frac{-1}{2(1-\rho^2)}\Big[\frac{(x-\mu_1)^2}{\sigma_1^2}-2\rho\frac{(x-\mu_1)(y-\mu_2)}{\sigma_1 \sigma_2}+\frac{(y-\mu_2)^2}{\sigma_2^2}\Big]},\ (x,y)\in\R^2
$$

其中 $\mu_1,\mu_2,\sigma_1,\sigma_2,\rho$ 都是常数，且 $\sigma_1>0,\sigma_2>0,-1<\rho<1$，则称 $(X,Y)$ 服从参数为 $\mu_1,\mu_2,\sigma_1,\sigma_2,\rho$ 的**二维正态分布**，记作 $(X,Y)\sim N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$.

结论：设 $(X,Y)\sim N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$，则 $(X,Y)$ 关于 $X$ 和关于 $Y$ 的边缘概率密度分别为

$$
f_{X}(x)=\dfrac{1}{\sqrt{2\pi}\sigma_1}e^{-\frac{(x-\mu_1)^2}{2\sigma_1^2}},-\infty<x<+\infty\\
f_{Y}(y)=\dfrac{1}{\sqrt{2\pi}\sigma_2}e^{-\frac{(y-\mu_2)^2}{2\sigma_2^2}},-\infty<y<+\infty
$$

> **证明：**
>
> $$
> \begin{aligned}
>     & \frac{-1}{2(1-\rho^2)}\Big[\frac{(x-\mu_1)^2}{\sigma_1^2}-2\rho\frac{(x-\mu_1)(y-\mu_2)}{\sigma_1 \sigma_2}+\frac{(y-\mu_2)^2}{\sigma_2^2}\Big]\\
>     =& \frac{-1}{2(1-\rho^2)}\Big\{\frac{(x-\mu_1)^2}{\sigma_1^2}+\Big[\frac{(y-\mu_2)^2}{\sigma_2^2}-2\rho\frac{(x-\mu_1)(y-\mu_2)}{\sigma_1 \sigma_2}+\rho^2\frac{(x-\mu_1)^2}{\sigma_1^2}\Big]-\rho^2\frac{(x-\mu_1)^2}{\sigma_1^2}\Big\}\\
>     =&\frac{-1}{2(1-\rho^2)}\Big\{\frac{(1-\rho^2)(x-\mu_1)^2}{\sigma_1^2}+\Big(\dfrac{y-\mu_2}{\sigma_2}-\rho\dfrac{x-\mu_1}{\sigma_1}\Big)^2\Big\}\\
>     =& -\frac{(x-\mu_1)^2}{2\sigma_1^2}-\dfrac{1}{2(1-\rho^2)}\Big(\dfrac{y-\mu_2}{\sigma_2}-\rho\dfrac{x-\mu_1}{\sigma_1}\Big)^2
\end{aligned}
> $$
>
> 因此
>
> $$
> \begin{aligned}
>     f_{X}(x)&=\int_{-\infty}^{+\infty} f(x,y)\,\text{d}y\\
>     &=\dfrac{1}{2\pi\sigma_1 \sigma_2 \sqrt{1-\rho^2}}e^{-\frac{(x-\mu_1)^2}{2\sigma_1^2}}\int_{-\infty}^{+\infty} e^{\frac{-1}{2(1-\rho^2)}\big(\frac{y-\mu_2}{\sigma_2}-\rho\frac{x-\mu_1}{\sigma_1}\big)^2}\,\text{d}y
> \end{aligned}
> $$
>
> 对于任意给定的实数 $x$，令 $t=\dfrac{1}{\sqrt{1-\rho^2}}\Big(\dfrac{y-\mu_2}{\sigma_2}-\rho\dfrac{x-\mu_1}{\sigma_1}\Big)$，则
>
> $$
> \text{d}t=\dfrac{1}{\sigma_2\sqrt{1-\rho^2}}\text{d}y
> $$
>
> 因此
>
> $$
> \begin{aligned}
>     f_{X}(x)&=\dfrac{1}{2\pi\sigma_1}e^{-\frac{(x-\mu_1)^2}{2\sigma_1^2}}\int_{-\infty}^{+\infty} e^{-\frac{t^2}{2}}\dfrac{1}{\sigma_2 \sqrt{1-\rho^2}}\text{d}y\\
>     &=\dfrac{1}{\sqrt{2\pi}\sigma_1}e^{-\frac{(x-\mu_1)^2}{2\sigma_1^2}}\int_{-\infty}^{+\infty} \dfrac{1}{\sqrt{2\pi}}e^{-\frac{t^2}{2}}\,\text{d}t
> \end{aligned}
> $$
>
> 因为
>
> $$
> \int_{-\infty}^{+\infty} \dfrac{1}{\sqrt{2\pi}}e^{-\frac{t^2}{2}}\,\text{d}t=1
> $$
>
> 所以
>
> $$
> f_{X}(x)=\dfrac{1}{\sqrt{2\pi}\sigma_1}e^{-\frac{(x-\mu_1)^2}{2\sigma_1^2}}
> $$
>
> 同理可得
>
> $$
> f_{Y}(y)=\dfrac{1}{\sqrt{2\pi}\sigma_2}e^{-\frac{(y-\mu_2)^2}{2\sigma_2^2}}
> $$

由此可知，若 $(X,Y)\sim N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$，则 $(X,Y)$ 关于 $X$ 和关于 $Y$ 的边缘分布都是一维正态分布，且有 $X\sim N(\mu_1,\sigma_1^2)$，$Y\sim N(\mu_2,\sigma_2^2)$. $(X,Y)$ 的分布与参数 $\rho$ 有关，对于不同的 $\rho$，有不同的二维正态分布，但 $(X,Y)$ 关于 $X$ 和关于 $Y$ 的边缘分布都与 $\rho$ 无关.

上述结论还表明，仅仅根据关于 $X$ 和关于 $Y$ 的边缘分布，一般是不能确定随机变量 $X$ 和 $Y$ 的联合分布的.

结论：设 $(X,Y)\sim N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$，则 $X$ 与 $Y$ 相互独立的充分必要条件是 $\rho=0$.

> **证明：**
>
> $$
> f_{X}(x)\,f_{Y}(y)=\dfrac{1}{2\pi\sigma_1 \sigma_2}e^{-\frac{1}{2}\Big[\frac{(x-\mu_1)^2}{2\sigma_1^2}+\frac{(y-\mu_2)^2}{2\sigma_2^2}\Big]}
> $$
>
> 先证充分性. 如果 $\rho=0$，则对于任意实数 $x$ 和 $y$，都有 $f(x,y)=f_{X}(x)\,f_{Y}(y)$，因此 $X$ 和 $Y$ 相互独立.
>
> 再证必要性. 如果 $X$ 和 $Y$ 相互独立，由于 $f(x,y),f_{X}(x),f_{Y}(y)$ 都是连续函数，因此对于任意实数 $x$ 和 $y$，都有 $f(x,y)=f_{X}(x)\,f_{Y}(y)$. 如果取 $x=\mu_1,y=\mu_2$，则有
>
> $$
> \dfrac{1}{2\pi\sigma_1 \sigma_2 \sqrt{1-\rho^2}}=\dfrac{1}{2\pi\sigma_1 \sigma_2}
> $$
>
> 从而 $\rho=0$.

## 3.4 条件分布

### 3.4.1 离散型随机变量的条件分布

**定义 3.10**&nbsp;&nbsp;&nbsp;&nbsp;设 $(X,Y)$ 是二维离散型随机变量，对于固定的 $j$，如果 $P\{Y=y_j\}=p_{\cdot j}>0$，则称

$$
P\{X=x_i|Y=y_j\}=\dfrac{P\{X=x_i,Y=y_j\}}{P\{Y=y_j\}}=\dfrac{p_{ij}}{p_{\cdot j}},\ i=1,2,\cdots
$$

为在条件 $Y=y_j$ 下随机变量 $X$ 的**条件概率分布**. 对于固定的 $i$，如果 $P\{X=x_i\}=p_{i\cdot}>0$，则称

$$
P\{Y=y_j|X=x_i\}=\dfrac{P\{X=x_i,Y=y_j\}}{P\{X=x_i\}}=\dfrac{p_{ij}}{p_{i\cdot}},\ j=1,2,\cdots
$$

为在条件 $X=x_i$ 下随机变量 $Y$ 的**条件概率分布**.

### 3.4.2 连续型随机变量的条件分布

**定义 3.11**&nbsp;&nbsp;&nbsp;&nbsp;设 $(X,Y)$ 是二维连续型随机变量，对于给定的实数 $y$ 及任意给定的正数 $\varepsilon$，都有 $P\{y-\varepsilon<Y\leqslant y+\varepsilon\}>0$. 如果对于任意实数 $x$，极限

$$
\lim_{\varepsilon\to 0^+} P\{X\leqslant x\;|\;y-\varepsilon<Y\leqslant y+\varepsilon\}=\lim_{\varepsilon\to 0^+} \dfrac{P\{X\leqslant x,y-\varepsilon<Y\leqslant y+\varepsilon\}}{P\{y-\varepsilon<Y\leqslant y+\varepsilon\}}
$$

存在，则称此极限值为在条件 $Y=y$ 下 $X$ 的**条件分布函数**，记作 $F_{X|Y}(x|y)$. 如果非负函数 $f_{X|Y}(x|y)$ 使得

$$
F_{X|Y}(x|y)=\int_{-\infty}^x f_{X|Y}(u|y)\,\text{d}u,\ x\in\R
$$

成立，则称 $f_{X|Y}(x|y)$ 为在条件 $Y=y$ 下 $X$ 的**条件概率密度**.

设二维连续型随机变量 $(X,Y)$ 的分布函数为 $F(x,y)$，概率密度为 $f(x,y)$. 如果在点 $(x,y)$ 处 $f(x,y)$ 连续，$(X,Y)$ 关于 $Y$ 的边缘概率密度 $f_{Y}(y)$ 连续，且 $f_{Y}(y)>0$，$Y$ 的分布函数为 $F_{Y}(y)$，则有

$$
\begin{aligned}
    F_{X|Y}(x|y)&=\lim_{\varepsilon\to 0^+} \dfrac{P\{X\leqslant x,y-\varepsilon<Y\leqslant y+\varepsilon\}}{P\{y-\varepsilon<Y\leqslant y+\varepsilon\}}\\
    &=\lim_{\varepsilon\to 0^+} \dfrac{F(x,y+\varepsilon)-F(x,y-\varepsilon)}{F_{Y}(y+\varepsilon)-F_{Y}(y-\varepsilon)}\\
    &=\lim_{\varepsilon\to 0^+} \dfrac{\dfrac{F(x,y+\varepsilon)-F(x,y)}{\varepsilon}+\dfrac{F(x,y-\varepsilon)-F(x,y)}{-\varepsilon}}{\dfrac{F_{Y}(y+\varepsilon)-F_{Y}(y)}{\varepsilon}+\dfrac{F_{Y}(y-\varepsilon)-F_{Y}(y)}{-\varepsilon}}\\
    &=\dfrac{\dfrac{\partial F(x,y)}{\partial y}}{\dfrac{\text{d}}{\text{d}y}F_{Y}(y)}\\
    &=\dfrac{\displaystyle\int_{-\infty}^x f(u,y)\,\text{d}u}{f_{Y}(y)}\\
    &=\int_{-\infty}^x \dfrac{f(u,y)}{f_{Y}(y)}\text{d}u
\end{aligned}
$$

由此可得在条件 $Y=y$ 下 $X$ 的条件概率密度为

$$
f_{X|Y}(x|y)=\dfrac{f(x,y)}{f_{Y}(y)},\ x\in\R
$$

类似地，可以定义在条件 $X=x$ 下 $Y$ 的条件分布函数 $F_{Y|X}(y|x)$ 和在条件 $X=x$ 下 $Y$ 的条件概率密度 $f_{Y|X}(y|x)=\dfrac{f(x,y)}{f_{X}(x)},\ y\in\R$.

## 3.5 二维随机变量的函数的分布

设 $(X,Y)$ 为二维随机变量，$g(x,y)$ 为二元函数，则一维随机变量 $Z=g(X,Y)$ 是二维随机变量 $(X,Y)$ 的函数.
